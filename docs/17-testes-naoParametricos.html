<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="pt" xml:lang="pt"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.42">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>17&nbsp; Métodos não paramétricos – Bioestatística Usando o R</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./18-epidemiologia.html" rel="next">
<link href="./16-dadosCategoricos.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-2f5df379a58b258e96c21c0638c20c03.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-8da5b4427184b79ecddefad3d342027e.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "Nenhum resultado",
    "search-matching-documents-text": "documentos correspondentes",
    "search-copy-link-title": "Copiar link para a busca",
    "search-hide-matches-text": "Esconder correspondências adicionais",
    "search-more-match-text": "mais correspondência neste documento",
    "search-more-matches-text": "mais correspondências neste documento",
    "search-clear-button-title": "Limpar",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancelar",
    "search-submit-button-title": "Enviar",
    "search-label": "Procurar"
  }
}</script>
<link href="site_libs/tabwid-1.1.3/tabwid.css" rel="stylesheet">

<script src="site_libs/tabwid-1.1.3/tabwid.js"></script>


  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="style.css">
</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Alternar barra lateral" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./17-testes-naoParametricos.html"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Métodos não paramétricos</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Alternar barra lateral" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Procurar" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Bioestatística Usando o R</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Procurar"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Prefácio</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introdução</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02-dados.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Natureza dos Dados</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./03-producaoDados.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Produção dos Dados</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./04-ambienteR.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Ambiente do <em>R</em></span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./05-manipulandoDados.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Manipulando os dados no <em>RStudio</em></span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./06-descrevendoDados.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Descrevendo os dados</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./07-probabilidades.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Introdução à Teoria das Probabilidades</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./08-assimetria_curtose.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Assimetria e Curtose</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./09-distAmostrais.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Distribuições Amostrais</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./10-estimacao.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Estimação</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./11-testeHipoteses.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Teste de Hipóteses</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./12-teste-t.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Comparação entre duas médias</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./13-anova.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Análise de Variância</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./14-anovaRep.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">ANOVA de medidas repetidas</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./15-correlacao-regressao.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Correlação e Regressão</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./16-dadosCategoricos.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Análise de Dados Categóricos</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./17-testes-naoParametricos.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Métodos não paramétricos</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./18-epidemiologia.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Estatística em Epidemiologia</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Índice</h2>
   
  <ul>
  <li><a href="#pacotes-necessários-neste-capítulo" id="toc-pacotes-necessários-neste-capítulo" class="nav-link active" data-scroll-target="#pacotes-necessários-neste-capítulo"><span class="header-section-number">17.1</span> Pacotes necessários neste capítulo</a></li>
  <li><a href="#sec-distlivre" id="toc-sec-distlivre" class="nav-link" data-scroll-target="#sec-distlivre"><span class="header-section-number">17.2</span> Distribuição livre</a></li>
  <li><a href="#sec-postos" id="toc-sec-postos" class="nav-link" data-scroll-target="#sec-postos"><span class="header-section-number">17.3</span> Postos</a></li>
  <li><a href="#teste-de-mann-whitney" id="toc-teste-de-mann-whitney" class="nav-link" data-scroll-target="#teste-de-mann-whitney"><span class="header-section-number">17.4</span> Teste de Mann-Whitney</a>
  <ul class="collapse">
  <li><a href="#dados-usados-nesta-seção" id="toc-dados-usados-nesta-seção" class="nav-link" data-scroll-target="#dados-usados-nesta-seção"><span class="header-section-number">17.4.1</span> Dados usados nesta seção</a></li>
  <li><a href="#hipóteses-estatísticas" id="toc-hipóteses-estatísticas" class="nav-link" data-scroll-target="#hipóteses-estatísticas"><span class="header-section-number">17.4.2</span> Hipóteses estatísticas</a></li>
  <li><a href="#pressupostos-do-teste-de-mann_whitney" id="toc-pressupostos-do-teste-de-mann_whitney" class="nav-link" data-scroll-target="#pressupostos-do-teste-de-mann_whitney"><span class="header-section-number">17.4.3</span> Pressupostos do teste de Mann_Whitney</a></li>
  <li><a href="#cálculo-da-estatística-de-teste" id="toc-cálculo-da-estatística-de-teste" class="nav-link" data-scroll-target="#cálculo-da-estatística-de-teste"><span class="header-section-number">17.4.4</span> Cálculo da estatística de teste</a></li>
  <li><a href="#sec-tefMW" id="toc-sec-tefMW" class="nav-link" data-scroll-target="#sec-tefMW"><span class="header-section-number">17.4.5</span> Tamanho do efeito</a></li>
  <li><a href="#conclusão" id="toc-conclusão" class="nav-link" data-scroll-target="#conclusão"><span class="header-section-number">17.4.6</span> Conclusão</a></li>
  </ul></li>
  <li><a href="#teste-de-wilcoxon" id="toc-teste-de-wilcoxon" class="nav-link" data-scroll-target="#teste-de-wilcoxon"><span class="header-section-number">17.5</span> Teste de Wilcoxon</a>
  <ul class="collapse">
  <li><a href="#dados-usados-nesta-seção-1" id="toc-dados-usados-nesta-seção-1" class="nav-link" data-scroll-target="#dados-usados-nesta-seção-1"><span class="header-section-number">17.5.1</span> Dados usados nesta seção</a></li>
  <li><a href="#definição-das-hipóteses-estatísticas" id="toc-definição-das-hipóteses-estatísticas" class="nav-link" data-scroll-target="#definição-das-hipóteses-estatísticas"><span class="header-section-number">17.5.2</span> Definição das hipóteses estatísticas</a></li>
  <li><a href="#execução-do-teste-estatístico" id="toc-execução-do-teste-estatístico" class="nav-link" data-scroll-target="#execução-do-teste-estatístico"><span class="header-section-number">17.5.3</span> Execução do teste estatístico</a></li>
  <li><a href="#tamanho-do-efeito" id="toc-tamanho-do-efeito" class="nav-link" data-scroll-target="#tamanho-do-efeito"><span class="header-section-number">17.5.4</span> Tamanho do efeito</a></li>
  <li><a href="#conclusão-1" id="toc-conclusão-1" class="nav-link" data-scroll-target="#conclusão-1"><span class="header-section-number">17.5.5</span> Conclusão</a></li>
  </ul></li>
  <li><a href="#sec-kuskalwallis" id="toc-sec-kuskalwallis" class="nav-link" data-scroll-target="#sec-kuskalwallis"><span class="header-section-number">17.6</span> Teste de Kruskal-Wallis</a>
  <ul class="collapse">
  <li><a href="#dados-usados-nesta-seção-2" id="toc-dados-usados-nesta-seção-2" class="nav-link" data-scroll-target="#dados-usados-nesta-seção-2"><span class="header-section-number">17.6.1</span> Dados usados nesta seção</a></li>
  <li><a href="#hipóteses-estatísticas-1" id="toc-hipóteses-estatísticas-1" class="nav-link" data-scroll-target="#hipóteses-estatísticas-1"><span class="header-section-number">17.6.2</span> Hipóteses estatísticas</a></li>
  <li><a href="#pressupostos-do-teste" id="toc-pressupostos-do-teste" class="nav-link" data-scroll-target="#pressupostos-do-teste"><span class="header-section-number">17.6.3</span> Pressupostos do teste</a></li>
  <li><a href="#execução-do-teste-estatístico-1" id="toc-execução-do-teste-estatístico-1" class="nav-link" data-scroll-target="#execução-do-teste-estatístico-1"><span class="header-section-number">17.6.4</span> Execução do teste estatístico</a></li>
  <li><a href="#tamanho-do-efeito-1" id="toc-tamanho-do-efeito-1" class="nav-link" data-scroll-target="#tamanho-do-efeito-1"><span class="header-section-number">17.6.5</span> Tamanho do efeito</a></li>
  <li><a href="#testes-post-hoc" id="toc-testes-post-hoc" class="nav-link" data-scroll-target="#testes-post-hoc"><span class="header-section-number">17.6.6</span> Testes post hoc</a></li>
  <li><a href="#conclusão-2" id="toc-conclusão-2" class="nav-link" data-scroll-target="#conclusão-2"><span class="header-section-number">17.6.7</span> Conclusão</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Métodos não paramétricos</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="pacotes-necessários-neste-capítulo" class="level2" data-number="17.1">
<h2 data-number="17.1" class="anchored" data-anchor-id="pacotes-necessários-neste-capítulo"><span class="header-section-number">17.1</span> Pacotes necessários neste capítulo</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>pacman<span class="sc">::</span><span class="fu">p_load</span> (coin,</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>                confintr,</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>                flextable,</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>                ggpubr,</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>                ggsci,</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>                kableExtra,</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>                knitr,</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>                readxl,</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>                rstatix,</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>                tidyverse)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="sec-distlivre" class="level2" data-number="17.2">
<h2 data-number="17.2" class="anchored" data-anchor-id="sec-distlivre"><span class="header-section-number">17.2</span> Distribuição livre</h2>
<p>A maioria dos testes estatísticos, discutidos neste livro, são testes paramétricos. Nestes, o interesse estava focado em estimar ou testar uma hipótese sobre um ou mais parâmetros populacionais e ,por isso, são denominados de paramétricos. Além disso, o aspecto central desses procedimentos era o conhecimento da forma funcional da população da qual foram retiradas as amostras que forneceram a base para a inferência. Por exemplo, o teste <em>t</em> de Student para amostras independentes e a ANOVA são baseados no pressuposto de que os dados foram amostrados de populações que têm distribuição normal.</p>
<p>Os <strong>testes não paramétricos</strong> não fazem suposições em relação à distribuição da população. Não têm, portanto, os pressupostos restritivos, comuns nos testes paramétricos. Têm <em>distribuição livre</em>. São baseados em uma ideia simples de ordenação por postos, do valor mais baixo ao mais alto. Analisam somente os postos, ignorando os valores. Podem ser usados tanto com variáveis ordinais como quantitativas numéricas.</p>
</section>
<section id="sec-postos" class="level2" data-number="17.3">
<h2 data-number="17.3" class="anchored" data-anchor-id="sec-postos"><span class="header-section-number">17.3</span> Postos</h2>
<p>Os métodos estatísticos não paramétricos não lidam diretamente com os valores observados. Em função disso, para poder usar a informação fornecida pelas observações, sem trabalhar diretamente com os valores observados, utiliza-se os postos das observações. Posto (<em>rank</em>) de uma observação é a sua posição em relação aos demais valores.</p>
<p>A atribuição dos postos de uma variável é realizada da seguinte maneira:</p>
<ol type="1">
<li>Colocam-se as observações em ordem crescente;</li>
<li>Associam-se valores, correspondendo às suas posições relativas na amostra. O primeiro elemento recebe o valor 1, o segundo o valor 2 e, assim por diante, até que a maior observação receba o valor <em>n</em>;</li>
<li>Se todas as observações são distintas, os postos são iguais aos valores associados às observações no passo anterior.</li>
<li>Para observações iguais (empates), associam-se postos iguais à média das suas posições relativas na amostra.</li>
</ol>
<p>Por exemplo, suponha uma amostra contendo os escores de Apgar no primeiro minuto de 10 recém-nascidos a termo (<a href="#tbl-apgar1" class="quarto-xref">Tabela&nbsp;<span>17.1</span></a>)). Em primeiro lugar, os valores são colocados em ordem crescente e, após, atribui-se postos aos valores. Observe que os postos atribuídos aos valores das posições 4, 5 e 6 são iguais e correspondentes a média de 4, 5 e 6, que é igual a 5. O mesmo ocorreu com os outros valores onde houve empate. A soma dos postos, no exemplo, é igual a 55. Para verificar a correção do cálculo, haja ou não empates, a soma dos postos será sempre <span class="math inline">\(\frac {n\ \times \ (n+1)}{2}\)</span>. No exemplo, <em>n</em> = 10, logo <span class="math inline">\(\frac {10\ \times \ (10+1)}{2}=55\)</span>.</p>
<div class="cell">
<div id="tbl-apgar1" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-apgar1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Tabela&nbsp;17.1: Construção dos postos
</figcaption>
<div aria-describedby="tbl-apgar1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<div class="tabwid"><style>.cl-f81828b0{}.cl-f8094dfe{font-family:'Arial';font-size:11pt;font-weight:bold;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-f8094e1c{font-family:'Arial';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-f8108308{margin:0;text-align:center;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-f810c354{width:0.761in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-f810c368{width:0.718in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-f810c369{width:0.659in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-f810c372{width:0.761in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-f810c373{width:0.718in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-f810c37c{width:0.659in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-f810c37d{width:0.761in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-f810c386{width:0.718in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-f810c390{width:0.659in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-f810c391{width:0.761in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-f810c39a{width:0.718in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-f810c3a4{width:0.659in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table data-quarto-disable-processing="true" class="cl-f81828b0"><thead><tr style="overflow-wrap:break-word;"><th class="cl-f810c354"><p class="cl-f8108308"><span class="cl-f8094dfe">apgar1</span></p></th><th class="cl-f810c368"><p class="cl-f8108308"><span class="cl-f8094dfe">ordem</span></p></th><th class="cl-f810c369"><p class="cl-f8108308"><span class="cl-f8094dfe">posto</span></p></th></tr></thead><tbody><tr style="overflow-wrap:break-word;"><td class="cl-f810c372"><p class="cl-f8108308"><span class="cl-f8094e1c">4</span></p></td><td class="cl-f810c373"><p class="cl-f8108308"><span class="cl-f8094e1c">1</span></p></td><td class="cl-f810c37c"><p class="cl-f8108308"><span class="cl-f8094e1c">1.0</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-f810c372"><p class="cl-f8108308"><span class="cl-f8094e1c">5</span></p></td><td class="cl-f810c373"><p class="cl-f8108308"><span class="cl-f8094e1c">2</span></p></td><td class="cl-f810c37c"><p class="cl-f8108308"><span class="cl-f8094e1c">2.0</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-f810c37d"><p class="cl-f8108308"><span class="cl-f8094e1c">7</span></p></td><td class="cl-f810c386"><p class="cl-f8108308"><span class="cl-f8094e1c">3</span></p></td><td class="cl-f810c390"><p class="cl-f8108308"><span class="cl-f8094e1c">3.0</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-f810c372"><p class="cl-f8108308"><span class="cl-f8094e1c">8</span></p></td><td class="cl-f810c373"><p class="cl-f8108308"><span class="cl-f8094e1c">4</span></p></td><td class="cl-f810c37c"><p class="cl-f8108308"><span class="cl-f8094e1c">5.0</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-f810c372"><p class="cl-f8108308"><span class="cl-f8094e1c">8</span></p></td><td class="cl-f810c373"><p class="cl-f8108308"><span class="cl-f8094e1c">5</span></p></td><td class="cl-f810c37c"><p class="cl-f8108308"><span class="cl-f8094e1c">5.0</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-f810c372"><p class="cl-f8108308"><span class="cl-f8094e1c">8</span></p></td><td class="cl-f810c373"><p class="cl-f8108308"><span class="cl-f8094e1c">6</span></p></td><td class="cl-f810c37c"><p class="cl-f8108308"><span class="cl-f8094e1c">5.0</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-f810c372"><p class="cl-f8108308"><span class="cl-f8094e1c">9</span></p></td><td class="cl-f810c373"><p class="cl-f8108308"><span class="cl-f8094e1c">7</span></p></td><td class="cl-f810c37c"><p class="cl-f8108308"><span class="cl-f8094e1c">8.0</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-f810c372"><p class="cl-f8108308"><span class="cl-f8094e1c">9</span></p></td><td class="cl-f810c373"><p class="cl-f8108308"><span class="cl-f8094e1c">8</span></p></td><td class="cl-f810c37c"><p class="cl-f8108308"><span class="cl-f8094e1c">8.0</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-f810c372"><p class="cl-f8108308"><span class="cl-f8094e1c">10</span></p></td><td class="cl-f810c373"><p class="cl-f8108308"><span class="cl-f8094e1c">9</span></p></td><td class="cl-f810c37c"><p class="cl-f8108308"><span class="cl-f8094e1c">9.5</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-f810c391"><p class="cl-f8108308"><span class="cl-f8094e1c">10</span></p></td><td class="cl-f810c39a"><p class="cl-f8108308"><span class="cl-f8094e1c">10</span></p></td><td class="cl-f810c3a4"><p class="cl-f8108308"><span class="cl-f8094e1c">9.5</span></p></td></tr></tbody></table></div>
</div>
</div>
</figure>
</div>
</div>
</section>
<section id="teste-de-mann-whitney" class="level2" data-number="17.4">
<h2 data-number="17.4" class="anchored" data-anchor-id="teste-de-mann-whitney"><span class="header-section-number">17.4</span> Teste de Mann-Whitney</h2>
<p>O <em>teste de Mann-Whitney</em> é usado para analisar a diferença na variável dependente (desfecho) para dois grupos independentes. O teste classifica todos os valores dependentes, ou seja, o valor mais baixo obtém o posto um e, em seguida, usa a soma dos postos de cada grupo no cálculo da estatística de teste.</p>
<p>É o substituto do teste <em>t</em> para amostras independentes quando os pressupostos deste teste são violados. Para a aplicação do teste de Mann-Whitney a variável de interesse deve ser ordinal ou numérica. Este teste é equivalente ao desenvolvido por Frank Wilcoxon (1892 – 1965), assim algumas vezes é denominado de <em>Wilcoxon Rank Sum Test</em> ou teste de Wilcoxon-Mann-Whitney. O <em>R</em> usa esta denominação e é importante não confundir com o teste não paramétrico para amostra pareadas, discutido mais adiante.</p>
<section id="dados-usados-nesta-seção" class="level3" data-number="17.4.1">
<h3 data-number="17.4.1" class="anchored" data-anchor-id="dados-usados-nesta-seção"><span class="header-section-number">17.4.1</span> Dados usados nesta seção</h3>
<p>O arquivo <code>dadosCirurgia.xlsx</code>, já usado na Seção <a href="16-dadosCategoricos.html#sec-dadosCirurgia" class="quarto-xref"><span>Seção 16.2.5.1</span></a>, fornecerá os dados para esta seção. Ele contém 144 recém-nascidos que foram submetidos a diferentes procedimentos cirúrgicos. A questão de pesquisa a ser respondida é:</p>
<blockquote class="blockquote">
<p>Existe diferença no tempo de hospitalização (<code>tempohosp</code>) dos recém-nascidos de acordo com a presença ou não de infecção (<code>infec</code>)?</p>
</blockquote>
<p>Essa pergunta foi respondida de outra maneira, na Seção <a href="16-dadosCategoricos.html#sec-tabextensas" class="quarto-xref"><span>Seção 16.2.5</span></a>. Agora, será usado o teste de Mann-Whitney.</p>
<section id="leitura-exploração-e-visualização-dos-dados" class="level4" data-number="17.4.1.1">
<h4 data-number="17.4.1.1" class="anchored" data-anchor-id="leitura-exploração-e-visualização-dos-dados"><span class="header-section-number">17.4.1.1</span> Leitura, exploração e visualização dos dados</h4>
<p>Os dados serão lidos com a função <code>read_excel()</code> do pacote <code>readxl</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>cirurgia <span class="ot">&lt;-</span> readxl<span class="sc">::</span><span class="fu">read_excel</span> (<span class="st">"dados/dadosCirurgia.xlsx"</span>)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(cirurgia)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>tibble [144 × 7] (S3: tbl_df/tbl/data.frame)
 $ id       : num [1:144] 1 2 3 4 5 6 7 8 9 10 ...
 $ sexo     : chr [1:144] "masc" "masc" "masc" "masc" ...
 $ peso     : num [1:144] 2020 1850 2540 1150 2900 ...
 $ ig       : num [1:144] 36 30 38 31 36 37 38 39 38 39 ...
 $ tempohosp: num [1:144] 37 37 37 46 37 36 30 18 25 14 ...
 $ infec    : chr [1:144] "não" "não" "sim" "sim" ...
 $ cirurgia : chr [1:144] "abdominal" "abdominal" "abdominal" "outra" ...</code></pre>
</div>
</div>
<p>A variável <code>infec</code> aparece como caractere e será transformada como fator:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>cirurgia<span class="sc">$</span>infec <span class="ot">&lt;-</span> <span class="fu">factor</span>(cirurgia<span class="sc">$</span>infec, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"sim"</span>, <span class="st">"não"</span>))</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Os boxplots (<a href="#fig-bpapgar1" class="quarto-xref">Figura&nbsp;<span>17.1</span></a>), construídos com a função <code>ggboxplot()</code> do pacote <code>ggpubr</code> com as cores da paleta do <em>New England Journal of Medicine (NEJM)</em>, são uma boa maneira de visualizar os dados:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>ggpubr<span class="sc">::</span><span class="fu">ggboxplot</span>(cirurgia,</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>                  <span class="at">x =</span> <span class="st">"infec"</span>,</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>                  <span class="at">y =</span> <span class="st">"tempohosp"</span>,</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>                  <span class="at">bxp.errorbar =</span> <span class="cn">TRUE</span>,</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>                  <span class="at">bxp.errorbar.width =</span> <span class="fl">0.1</span>,</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>                  <span class="at">fill =</span> <span class="st">"infec"</span>,</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>                  <span class="at">palette =</span> <span class="st">"nejm"</span>,</span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>                  <span class="at">legend =</span> <span class="st">"none"</span>,</span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>                  <span class="at">ggtheme =</span> <span class="fu">theme_bw</span>(),</span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>                  <span class="at">xlab =</span> <span class="st">"Presença de infecção"</span> ,</span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>                  <span class="at">ylab =</span> <span class="st">"Tempo de hospitalização (dias)"</span>)   </span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-bpapgar1" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-bpapgar1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="17-testes-naoParametricos_files/figure-html/fig-bpapgar1-1.png" class="quarto-figure quarto-figure-center figure-img" style="width:70.0%;height:70.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-bpapgar1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figura&nbsp;17.1: Impacto da infecção no tempo de hopsitalização.
</figcaption>
</figure>
</div>
</div>
</div>
<p>Os boxplots exibem uma série de valores atípicos, indicando que existe uma assimetria em ambos os grupos. Essa assimetria também pode ser verificada usando o teste de Shapiro-Wilk, que mostrando valores <em>P</em> &lt; 0,05, confirma que os dados não seguem a distribuição normal. Este teste não é pré-requisito para o teste. Foi realizado como uma demonstração.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>cirurgia <span class="sc">%&gt;%</span> </span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">group_by</span>(infec) <span class="sc">%&gt;%</span> </span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>  rstatix<span class="sc">::</span><span class="fu">shapiro_test</span>(tempohosp)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 4
  infec variable  statistic        p
  &lt;fct&gt; &lt;chr&gt;         &lt;dbl&gt;    &lt;dbl&gt;
1 sim   tempohosp     0.692 1.47e- 9
2 não   tempohosp     0.565 9.87e-15</code></pre>
</div>
</div>
</section>
<section id="sumarização-dos-dados" class="level4" data-number="17.4.1.2">
<h4 data-number="17.4.1.2" class="anchored" data-anchor-id="sumarização-dos-dados"><span class="header-section-number">17.4.1.2</span> Sumarização dos dados</h4>
<p>Como a variável <code>tempohosp</code> é assimétrica conforme mostrado acima, onde ambos os valores <em>P</em> são menores do que 0,05, será realizado um sumário numérico com a obtenção da mediana e IIQ. Isto será feito através da função <code>group_by()</code> e <code>summarise()</code>, incluídas no pacote <code>dplyr</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>resumo <span class="ot">&lt;-</span> cirurgia <span class="sc">%&gt;%</span> </span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">group_by</span>(infec) <span class="sc">%&gt;%</span> </span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">summarise</span>(<span class="at">n =</span> <span class="fu">n</span>(),</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>                   <span class="at">mediana =</span> <span class="fu">median</span> (tempohosp, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>                   <span class="at">p25=</span><span class="fu">quantile</span>(tempohosp, <span class="at">probs =</span> <span class="fl">0.25</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>                   <span class="at">p75=</span><span class="fu">quantile</span>(tempohosp, <span class="at">probs =</span> <span class="fl">0.75</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>resumo</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 5
  infec     n mediana   p25   p75
  &lt;fct&gt; &lt;int&gt;   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
1 sim      56      37  22.8    49
2 não      88      23  18      37</code></pre>
</div>
</div>
<p>Os dados mostram que a mediana de tempo de internação dos neonatos infectados é bem maior do que a mediana dos não infectados.</p>
</section>
</section>
<section id="hipóteses-estatísticas" class="level3" data-number="17.4.2">
<h3 data-number="17.4.2" class="anchored" data-anchor-id="hipóteses-estatísticas"><span class="header-section-number">17.4.2</span> Hipóteses estatísticas</h3>
<p>Da mesma maneira que o teste <em>t</em>, as hipóteses estabelecidas comparam dois grupos independentes. Se não houver diferença entre os grupos, ou seja, os grupos são provenientes de uma mesma população, as somas dos postos em cada grupo devem ficar próximas. Desta forma,</p>
<blockquote class="blockquote">
<p><span class="math inline">\(H_{0}\)</span>: As duas populações são iguais.</p>
</blockquote>
<blockquote class="blockquote">
<p><span class="math inline">\(H_{1}\)</span>: As duas populações não são iguais.</p>
</blockquote>
<p>Não foi escrita a hipótese nula como sendo que as médias (ou as medianas) são iguais, pois o teste não usa as medidas de posição tradicionais e sim os postos.</p>
</section>
<section id="pressupostos-do-teste-de-mann_whitney" class="level3" data-number="17.4.3">
<h3 data-number="17.4.3" class="anchored" data-anchor-id="pressupostos-do-teste-de-mann_whitney"><span class="header-section-number">17.4.3</span> Pressupostos do teste de Mann_Whitney</h3>
<p>O teste de Mann-Whitney é baseado nos seguintes pressupostos:</p>
<ol type="1">
<li>Os dados são aleatórios;</li>
<li>As amostras são de dois grupos independentes;</li>
<li>Um dos grupos é denominado de 1 e o outro de 2;</li>
<li>A variável a ser comparada nos grupos deve ser ordenável;</li>
<li>O grupo 1 será o grupo de menor tamanho e, se tiverem o mesmo tamanho, o grupo 1 é aquele cuja soma dos postos é a menor.</li>
</ol>
</section>
<section id="cálculo-da-estatística-de-teste" class="level3" data-number="17.4.4">
<h3 data-number="17.4.4" class="anchored" data-anchor-id="cálculo-da-estatística-de-teste"><span class="header-section-number">17.4.4</span> Cálculo da estatística de teste</h3>
<section id="lógica-do-teste-u-de-mann-whitney" class="level4" data-number="17.4.4.1">
<h4 data-number="17.4.4.1" class="anchored" data-anchor-id="lógica-do-teste-u-de-mann-whitney"><span class="header-section-number">17.4.4.1</span> Lógica do teste U de Mann-Whitney</h4>
<p>De acordo com as hipóteses estabelecidas, o teste é bicaudal. Se as observações nos dois grupos forem provenientes da mesma população, a soma dos postos em cada grupo devem ficar próximas.</p>
<p>Para calcular o teste, procede-se da seguinte maneira:</p>
<ol type="1">
<li><p>Deve haver uma variável que identifique o grupo a que pertence cada uma das observações. No exemplo proposto, a variável desfecho é <code>tempohosp</code> e a variável agrupadora é <code>infec</code>, categorizada como <code>sim</code> e <code>não</code>.</p></li>
<li><p>Ordenar de forma crescente todos os valores da variável <code>tempohosp</code>, sem levar em consideração a que grupo pertence. Para realizar este procedimento, será usada a função <code>rank()</code> do R base com o método para empates igual à média dos valores empatados (<code>ties.method="average</code>). Ao executar a função, será criada uma nova variável, denotada <code>postos</code>.</p></li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>cirurgia<span class="sc">$</span>postos <span class="ot">&lt;-</span> <span class="fu">rank</span>(cirurgia<span class="sc">$</span>tempohosp, <span class="at">ties.method =</span> <span class="st">"average"</span>) </span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(cirurgia)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 8
     id sexo   peso    ig tempohosp infec cirurgia  postos
  &lt;dbl&gt; &lt;chr&gt; &lt;dbl&gt; &lt;dbl&gt;     &lt;dbl&gt; &lt;fct&gt; &lt;chr&gt;      &lt;dbl&gt;
1     1 masc   2020    36        37 não   abdominal   94.5
2     2 masc   1850    30        37 não   abdominal   94.5
3     3 masc   2540    38        37 sim   abdominal   94.5
4     4 masc   1150    31        46 sim   outra      120  
5     5 masc   2900    36        37 não   abdominal   94.5
6     6 fem    2480    37        36 sim   abdominal   91  </code></pre>
</div>
</div>
<ol start="3" type="1">
<li>Verificar o tamanho (<em>n</em>) de cada grupo (presença ou não de infecção) e somar os postos em cada um dos grupos, usando a função <code>group_by()</code> junto com a função <code>summarise()</code>,</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>resumo <span class="ot">&lt;-</span> cirurgia <span class="sc">%&gt;%</span> </span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">group_by</span>(infec) <span class="sc">%&gt;%</span> </span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">summarise</span>(<span class="at">n =</span> <span class="fu">n</span>(),</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>                   <span class="at">soma =</span> <span class="fu">sum</span>(postos))</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>resumo</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 3
  infec     n  soma
  &lt;fct&gt; &lt;int&gt; &lt;dbl&gt;
1 sim      56 4876.
2 não      88 5564.</code></pre>
</div>
</div>
<ol start="4" type="1">
<li>Denominar de <em>grupo_1</em> o grupo com menor soma:</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>grupo_1 <span class="ot">&lt;-</span> <span class="fu">min</span>(resumo<span class="sc">$</span>soma)</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>grupo_1</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 4875.5</code></pre>
</div>
</div>
<ol start="5" type="1">
<li>Denotar o <em>grupo_1</em> como T</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>T <span class="ot">&lt;-</span> grupo_1</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Consequentemente,</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>n1 <span class="ot">&lt;-</span> resumo<span class="sc">$</span>n[<span class="dv">1</span>]</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>n1</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 56</code></pre>
</div>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>n2 <span class="ot">&lt;-</span> resumo<span class="sc">$</span>n[<span class="dv">2</span>]</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>n2</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 88</code></pre>
</div>
</div>
<ol start="6" type="1">
<li>Calcular a estística do teste, usando a fórmula preconizada por Altman <span class="citation" data-cites="altman1991mannwhitney">(<a href="references.html#ref-altman1991mannwhitney" role="doc-biblioref">1</a>)</span>:</li>
</ol>
<p><span class="math display">\[
U =n_{1} \times n_{2} \ +\left [\frac{n_{1} \times \left (n_{1} + 1  \right )}{2}  \right ] - T
\]</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>U <span class="ot">&lt;-</span> (n1<span class="sc">*</span>n2 <span class="sc">+</span> ((n1<span class="sc">*</span>(n1 <span class="sc">+</span> <span class="dv">1</span>))<span class="sc">/</span><span class="dv">2</span>)) <span class="sc">-</span> T</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>U</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1648.5</code></pre>
</div>
</div>
<p><strong>Obs</strong>.: O U de Mann-Whitney aparece no teste de Wilcoxon como W, eles são iguais</p>
<ol start="7" type="1">
<li>Se <span class="math inline">\(n_{1}\)</span>, <span class="math inline">\(n_{2}\)</span> <span class="math inline">\(\ge\)</span> 10, a distribuição da estatística do teste pode ser aproximada por uma distribuição normal com média igual a</li>
</ol>
<p><span class="math display">\[
\mu_{U} =\left [\frac{n_{S} \times \left (n_{L} + 1  \right )}{2}  \right ]
\]</span></p>
<p>onde <span class="math inline">\(n_{S}\)</span> e <span class="math inline">\(n_{L}\)</span>, são, respectivamente, o grupo de menor e maior tamanho. No exemplo, <span class="math inline">\(n_{1}\)</span> e <span class="math inline">\(n_{2}\)</span>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>m_U <span class="ot">&lt;-</span> (n1<span class="sc">*</span>(n1<span class="sc">+</span>n2<span class="sc">+</span><span class="dv">1</span>))<span class="sc">/</span><span class="dv">2</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>m_U</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 4060</code></pre>
</div>
</div>
<p>E desvio padrão igual a</p>
<p><span class="math display">\[
\sigma_{U}= \sqrt {\frac{n_{L}\times \sigma_{U}}{6}}
\]</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>dp_U <span class="ot">&lt;-</span> <span class="fu">sqrt</span>((n2<span class="sc">*</span>m_U)<span class="sc">/</span><span class="dv">6</span>)</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>dp_U</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 244.0219</code></pre>
</div>
</div>
<p>Os resultados fornecem os dados para calcular a estatística <span class="math inline">\(Z_{U}\)</span> com correção de continuidade e, a partir dela, calcular o valor <em>P</em>.</p>
<p><span class="math display">\[
Z_{U}= \frac{(T -0,5) - \mu_{U}}{\sigma_{U}}
\]</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>Z_U <span class="ot">&lt;-</span> ((T <span class="sc">-</span> <span class="fl">0.5</span>) <span class="sc">-</span> m_U)<span class="sc">/</span>dp_U</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(Z_U, <span class="dv">2</span>)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 3.34</code></pre>
</div>
</div>
<ol start="8" type="1">
<li>Finalmente, calcula-se o valor <em>P</em>, usando a função <code>pnorm()</code>, multiplicada por 2, pois o teste é bicaudal.</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>P <span class="ot">&lt;-</span> <span class="fu">pnorm</span>(Z_U, <span class="at">lower.tail =</span> <span class="cn">FALSE</span>) <span class="sc">*</span> <span class="dv">2</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(P, <span class="dv">4</span>)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 8e-04</code></pre>
</div>
</div>
<p>Na prática, não há necessidade de fazer todos esses cálculos, pois o <em>R</em> calcula facilmente o teste. Os cálculos foram mostrados para melhorar o entendimento de como o teste de Mann-Whitney funciona.</p>
</section>
<section id="cálculo-do-u-de-mann-whitney-no-r" class="level4" data-number="17.4.4.2">
<h4 data-number="17.4.4.2" class="anchored" data-anchor-id="cálculo-do-u-de-mann-whitney-no-r"><span class="header-section-number">17.4.4.2</span> Cálculo do U de Mann-Whitney no R</h4>
<p>O teste pode ser realizado com a função <code>wilcox_test()</code> <a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a> do pacote <code>rstatix</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>teste <span class="ot">&lt;-</span> rstatix<span class="sc">::</span><span class="fu">wilcox_test</span>(<span class="at">formula =</span> tempohosp <span class="sc">~</span> infec, <span class="at">data =</span> cirurgia)</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>teste</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 7
  .y.       group1 group2    n1    n2 statistic       p
* &lt;chr&gt;     &lt;chr&gt;  &lt;chr&gt;  &lt;int&gt; &lt;int&gt;     &lt;dbl&gt;   &lt;dbl&gt;
1 tempohosp sim    não       56    88     3280. 0.00083</code></pre>
</div>
</div>
<p>Assim como no cálculo manual, o teste com a função do <code>rstatix</code>, mostra uma diferença estatisticamente significativa (<em>P</em> &lt; 0,001) entre os tempos de hospitalização dos recém-nascidos que realizaram cirurgia no período neonatal que se infectaram ou não.</p>
</section>
</section>
<section id="sec-tefMW" class="level3" data-number="17.4.5">
<h3 data-number="17.4.5" class="anchored" data-anchor-id="sec-tefMW"><span class="header-section-number">17.4.5</span> Tamanho do efeito</h3>
<p>É interessante calcular o tamanho do efeito, a magnitude do efeito. O tamanho do efeito <em>r</em> é calculado como a estatística <span class="math inline">\(Z_{U}\)</span> dividida pela raiz quadrada do tamanho da amostra (<span class="math inline">\(n = n_{1} + n_{2}\)</span>).</p>
<p><span class="math display">\[
r = \frac {Z_{U}}{\sqrt{n}}
\]</span></p>
<p>O valor de <span class="math inline">\(Z_{U}\)</span> é igual a 3.3398648, logo</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>r <span class="ot">&lt;-</span> Z_U<span class="sc">/</span><span class="fu">sqrt</span>(n1<span class="sc">+</span>n2)</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(r,<span class="dv">3</span>)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.278</code></pre>
</div>
</div>
<p>O <em>R</em> possui a função <code>wilcox_effsize()</code> incluída no pacote <code>rstatix</code>. Necessita também do pacote <code>coin</code> <span class="citation" data-cites="hothorn2006lego">(<a href="references.html#ref-hothorn2006lego" role="doc-biblioref">2</a>)</span> instalado para calcular a estatística <em>r</em>.<a href="#fn2" class="footnote-ref" id="fnref2" role="doc-noteref"><sup>2</sup></a> A saída exibirá junto a magnitude o efeito, que no caso é pequena (veja <a href="#tbl-wilcoxef" class="quarto-xref">Tabela&nbsp;<span>17.2</span></a>).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="fu">wilcox_effsize</span>(cirurgia, tempohosp<span class="sc">~</span>infec)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 7
  .y.       group1 group2 effsize    n1    n2 magnitude
* &lt;chr&gt;     &lt;chr&gt;  &lt;chr&gt;    &lt;dbl&gt; &lt;int&gt; &lt;int&gt; &lt;ord&gt;    
1 tempohosp sim    não      0.279    56    88 small    </code></pre>
</div>
</div>
<div class="cell">
<div id="tbl-wilcoxef" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-wilcoxef-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Tabela&nbsp;17.2: Interpretação do valor r
</figcaption>
<div aria-describedby="tbl-wilcoxef-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<div class="tabwid"><style>.cl-f9af65da{}.cl-f9a24616{font-family:'Arial';font-size:11pt;font-weight:bold;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-f9a2462a{font-family:'Arial';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-f9a24634{font-family:'Arial';font-size:9pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-f9a7c6fe{margin:0;text-align:center;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-f9a7c712{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-f9a8007e{width:1.5in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-f9a80092{width:1.5in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-f9a80093{width:1.5in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-f9a8009c{width:1.5in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table data-quarto-disable-processing="true" class="cl-f9af65da"><thead><tr style="overflow-wrap:break-word;"><th class="cl-f9a8007e"><p class="cl-f9a7c6fe"><span class="cl-f9a24616">r</span></p></th><th class="cl-f9a8007e"><p class="cl-f9a7c6fe"><span class="cl-f9a24616">magnitude</span></p></th></tr></thead><tbody><tr style="overflow-wrap:break-word;"><td class="cl-f9a80092"><p class="cl-f9a7c6fe"><span class="cl-f9a2462a">0,10 &lt; 0,30</span></p></td><td class="cl-f9a80092"><p class="cl-f9a7c6fe"><span class="cl-f9a2462a">pequeno</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-f9a80092"><p class="cl-f9a7c6fe"><span class="cl-f9a2462a">0,30 &lt; 0,50</span></p></td><td class="cl-f9a80092"><p class="cl-f9a7c6fe"><span class="cl-f9a2462a">médio</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-f9a80093"><p class="cl-f9a7c6fe"><span class="cl-f9a2462a">&gt;= 0,50</span></p></td><td class="cl-f9a80093"><p class="cl-f9a7c6fe"><span class="cl-f9a2462a">grande</span></p></td></tr></tbody><tfoot><tr style="overflow-wrap:break-word;"><td colspan="2" class="cl-f9a8009c"><p class="cl-f9a7c712"><span class="cl-f9a24634">Sem considerar o sinal</span></p></td></tr></tfoot></table></div>
</div>
</div>
</figure>
</div>
</div>
</section>
<section id="conclusão" class="level3" data-number="17.4.6">
<h3 data-number="17.4.6" class="anchored" data-anchor-id="conclusão"><span class="header-section-number">17.4.6</span> Conclusão</h3>
<p>O valor <span class="math inline">\(P&lt;0,0001\)</span> está bem abaixo do nível de significância estabelecido (<span class="math inline">\(\alpha = 0,05)\)</span>. Pode-se concluir que o tempo de hospitalização nos dois grupos é estatisticamente diferente. Entretanto, a magnitude dessa diferença é pequena.</p>
<p>Isto pode ser visualizado no gráfico (<a href="#fig-bpres" class="quarto-xref">Figura&nbsp;<span>17.2</span></a>):</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>ggpubr<span class="sc">::</span><span class="fu">ggboxplot</span>(cirurgia,</span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>                   <span class="at">x =</span> <span class="st">"infec"</span>,</span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>                   <span class="at">y =</span> <span class="st">"tempohosp"</span>,</span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a>                   <span class="at">bxp.errorbar =</span> <span class="cn">TRUE</span>,</span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a>                   <span class="at">bxp.errorbar.width =</span> <span class="fl">0.1</span>,</span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a>                   <span class="at">fill =</span> <span class="st">"infec"</span>,</span>
<span id="cb37-7"><a href="#cb37-7" aria-hidden="true" tabindex="-1"></a>                   <span class="at">palette =</span> <span class="st">"nejm"</span>,</span>
<span id="cb37-8"><a href="#cb37-8" aria-hidden="true" tabindex="-1"></a>                   <span class="at">legend =</span> <span class="st">"none"</span>,</span>
<span id="cb37-9"><a href="#cb37-9" aria-hidden="true" tabindex="-1"></a>                   <span class="at">ggtheme =</span> <span class="fu">theme_bw</span>(),</span>
<span id="cb37-10"><a href="#cb37-10" aria-hidden="true" tabindex="-1"></a>                   <span class="at">xlab =</span> <span class="st">"Presença de infecção"</span> ,</span>
<span id="cb37-11"><a href="#cb37-11" aria-hidden="true" tabindex="-1"></a>                   <span class="at">ylab =</span> <span class="st">"Tempo de hospitalização (dias)"</span>) <span class="sc">+</span></span>
<span id="cb37-12"><a href="#cb37-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">subtitle =</span> rstatix<span class="sc">::</span><span class="fu">get_test_label</span>(teste, <span class="at">detailed =</span> <span class="cn">TRUE</span>))</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-bpres" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-bpres-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="17-testes-naoParametricos_files/figure-html/fig-bpres-1.png" class="quarto-figure quarto-figure-center figure-img" style="width:70.0%;height:70.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-bpres-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figura&nbsp;17.2: Impacto da infecção no tempo de hopsitalização.
</figcaption>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="teste-de-wilcoxon" class="level2" data-number="17.5">
<h2 data-number="17.5" class="anchored" data-anchor-id="teste-de-wilcoxon"><span class="header-section-number">17.5</span> Teste de Wilcoxon</h2>
<p>O <em>teste de Wilcoxon</em>, também conhecido como teste dos postos com sinais de Wilcoxon (<em>Wilcoxon Signed-Rank Test</em>), é um teste não paramétrico utilizado em situações em que existem dois conjuntos de dados emparelhados, ou seja, dados provenientes do mesmo participante. O teste não examina os dois grupos individualmente; em vez disso, ele se concentra na diferença existente entre cada par de observações. É um equivalente não paramétrico do teste <em>t</em> pareado.</p>
<section id="dados-usados-nesta-seção-1" class="level3" data-number="17.5.1">
<h3 data-number="17.5.1" class="anchored" data-anchor-id="dados-usados-nesta-seção-1"><span class="header-section-number">17.5.1</span> Dados usados nesta seção</h3>
<p>Pata verificar se a realização de exercícios aeróbicos modifica a função respiratória de 10 escolares asmáticos, foi medido o Pico de Fluxo Expiratório Máximo (<em>Peak Flow Meter</em>) no início e no final do programa, após 120 dias. O Pico de Fluxo Expiratório Máximo (PFE) serve como uma forma simples de avaliar a força e a velocidade de saída do ar de dentro dos pulmões. É medido em L/min. Os resultados do estudo tem apenas três variáveis, <code>id</code>, <code>basal</code> e <code>final</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>id <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>)</span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>basal <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">120</span>, <span class="dv">200</span>, <span class="dv">140</span>, <span class="dv">200</span>, <span class="dv">110</span>, <span class="dv">240</span>, <span class="dv">150</span>, <span class="dv">120</span>, <span class="dv">250</span>, <span class="dv">190</span>)</span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>final <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">220</span>, <span class="dv">300</span>, <span class="dv">230</span>, <span class="dv">180</span>, <span class="dv">300</span>, <span class="dv">330</span>, <span class="dv">230</span>, <span class="dv">250</span>, <span class="dv">300</span>, <span class="dv">200</span>)</span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a>dados <span class="ot">&lt;-</span> <span class="fu">tibble</span>(id, basal, final)</span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-7"><a href="#cb38-7" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span> (dados)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 3
     id basal final
  &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt;
1     1   120   220
2     2   200   300
3     3   140   230
4     4   200   180
5     5   110   300
6     6   240   330</code></pre>
</div>
</div>
<p>A questão de pesquisa a ser respondida, portanto, é:</p>
<blockquote class="blockquote">
<p>Existe diferença entre as medidas iniciais e finais do PFE dos escolares asmáticos que entraram em um programa de exercícios aeróbicos?</p>
</blockquote>
<section id="exploração-e-transformação-dos-dados" class="level4" data-number="17.5.1.1">
<h4 data-number="17.5.1.1" class="anchored" data-anchor-id="exploração-e-transformação-dos-dados"><span class="header-section-number">17.5.1.1</span> Exploração e transformação dos dados</h4>
<p>Os dados estão no formato amplo com as variáveis basal e final classificadas como númericas. Será transformado para o formato longo, usando a função <code>pivot_longer()</code> do pacote <code>tidyr</code>. Este processo é opcional, mas, como foi feito com o teste <em>t</em> pareado, será repetido aqui como treinamento:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>dadosL <span class="ot">&lt;-</span> dados <span class="sc">%&gt;%</span> </span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>  tidyr<span class="sc">::</span><span class="fu">pivot_longer</span>(<span class="fu">c</span>(basal, final), </span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>                      <span class="at">names_to =</span> <span class="st">"momento"</span>, </span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a>                      <span class="at">values_to =</span> <span class="st">"medidas"</span>)</span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(dadosL)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>tibble [20 × 3] (S3: tbl_df/tbl/data.frame)
 $ id     : int [1:20] 1 1 2 2 3 3 4 4 5 5 ...
 $ momento: chr [1:20] "basal" "final" "basal" "final" ...
 $ medidas: num [1:20] 120 220 200 300 140 230 200 180 110 300 ...</code></pre>
</div>
</div>
</section>
<section id="medidas-resumidoras" class="level4" data-number="17.5.1.2">
<h4 data-number="17.5.1.2" class="anchored" data-anchor-id="medidas-resumidoras"><span class="header-section-number">17.5.1.2</span> Medidas resumidoras</h4>
<p>Como o número de participantes é de apenas 10, a medida de posição mais adequada para resumir os dados é mediana e a medida de dispersão é o intervalo interquartil (IIQ). Para isso, se fará uso das funções <code>group_by()</code> e <code>summarise()</code> do pacote <code>dplyr</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>resumo <span class="ot">&lt;-</span> dadosL <span class="sc">%&gt;%</span> </span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">group_by</span>(momento) <span class="sc">%&gt;%</span> </span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">summarise</span>(<span class="at">n =</span> <span class="fu">n</span>(),</span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a>                   <span class="at">mediana =</span> <span class="fu">median</span> (medidas, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a>                   <span class="at">p25=</span><span class="fu">quantile</span>(medidas, <span class="at">probs =</span> <span class="fl">0.25</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb42-6"><a href="#cb42-6" aria-hidden="true" tabindex="-1"></a>                   <span class="at">p75=</span><span class="fu">quantile</span>(medidas, <span class="at">probs =</span> <span class="fl">0.75</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb42-7"><a href="#cb42-7" aria-hidden="true" tabindex="-1"></a>                   <span class="at">media =</span> <span class="fu">mean</span> (medidas, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb42-8"><a href="#cb42-8" aria-hidden="true" tabindex="-1"></a>                   <span class="at">dp =</span> <span class="fu">sd</span> (medidas, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb42-9"><a href="#cb42-9" aria-hidden="true" tabindex="-1"></a>                   <span class="at">ep =</span> dp<span class="sc">/</span><span class="fu">sqrt</span>(n),</span>
<span id="cb42-10"><a href="#cb42-10" aria-hidden="true" tabindex="-1"></a>                   <span class="at">me =</span> ep <span class="sc">*</span> <span class="fu">qt</span>(<span class="dv">1</span> <span class="sc">-</span> (<span class="fl">0.05</span><span class="sc">/</span><span class="dv">2</span>), n <span class="sc">-</span> <span class="dv">1</span>))</span>
<span id="cb42-11"><a href="#cb42-11" aria-hidden="true" tabindex="-1"></a>resumo</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 9
  momento     n mediana   p25   p75 media    dp    ep    me
  &lt;chr&gt;   &lt;int&gt;   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
1 basal      10     170  125    200   172  50.9  16.1  36.4
2 final      10     240  222.   300   254  50.4  15.9  36.0</code></pre>
</div>
</div>
</section>
<section id="visualização-dos-dados" class="level4" data-number="17.5.1.3">
<h4 data-number="17.5.1.3" class="anchored" data-anchor-id="visualização-dos-dados"><span class="header-section-number">17.5.1.3</span> Visualização dos dados</h4>
<p>Pode-se fazer visualização gráfica dos dados usando um boxplot (<a href="#fig-aero" class="quarto-xref">Figura&nbsp;<span>17.3</span></a>) ou um gráfico de linha (<a href="#fig-aero1" class="quarto-xref">Figura&nbsp;<span>17.4</span></a>).</p>
<p><u>Boxplot</u></p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>ggpubr<span class="sc">::</span><span class="fu">ggboxplot</span>(dadosL,</span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>                  <span class="at">x =</span> <span class="st">"momento"</span>,</span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a>                  <span class="at">y =</span> <span class="st">"medidas"</span>,</span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a>                  <span class="at">bxp.errorbar =</span> <span class="cn">TRUE</span>,</span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a>                  <span class="at">bxp.errorbar.width =</span> <span class="fl">0.1</span>,</span>
<span id="cb44-6"><a href="#cb44-6" aria-hidden="true" tabindex="-1"></a>                  <span class="at">fill =</span> <span class="st">"momento"</span>,</span>
<span id="cb44-7"><a href="#cb44-7" aria-hidden="true" tabindex="-1"></a>                  <span class="at">palette =</span> <span class="fu">c</span>(<span class="st">"cyan4"</span>, <span class="st">"cyan3"</span>),</span>
<span id="cb44-8"><a href="#cb44-8" aria-hidden="true" tabindex="-1"></a>                  <span class="at">legend =</span> <span class="st">"none"</span>,</span>
<span id="cb44-9"><a href="#cb44-9" aria-hidden="true" tabindex="-1"></a>                  <span class="at">ggtheme =</span> <span class="fu">theme_bw</span>(),</span>
<span id="cb44-10"><a href="#cb44-10" aria-hidden="true" tabindex="-1"></a>                  <span class="at">xlab =</span> <span class="st">"Momento"</span> ,</span>
<span id="cb44-11"><a href="#cb44-11" aria-hidden="true" tabindex="-1"></a>                  <span class="at">ylab =</span> <span class="st">"PEF (L/min) "</span>)<span class="sc">+</span></span>
<span id="cb44-12"><a href="#cb44-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span> (<span class="at">text =</span> <span class="fu">element_text</span> (<span class="at">size =</span> <span class="dv">13</span>),</span>
<span id="cb44-13"><a href="#cb44-13" aria-hidden="true" tabindex="-1"></a>         <span class="at">axis.text.x=</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>)) </span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-aero" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-aero-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="17-testes-naoParametricos_files/figure-html/fig-aero-1.png" class="quarto-figure quarto-figure-center figure-img" style="width:70.0%;height:70.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-aero-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figura&nbsp;17.3: Impacto de exercícios aeróbicos na função respiratória de 10 escolares asmáticos.
</figcaption>
</figure>
</div>
</div>
</div>
<p><u>Gráfico de linha</u></p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>ggpubr<span class="sc">::</span><span class="fu">ggline</span>(dadosL,</span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>               <span class="at">x =</span> <span class="st">"momento"</span>,</span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a>               <span class="at">y =</span> <span class="st">"medidas"</span>,</span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a>               <span class="at">color =</span> <span class="st">"cyan4"</span>,</span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a>               <span class="at">linetype =</span> <span class="st">"dashed"</span>,</span>
<span id="cb45-6"><a href="#cb45-6" aria-hidden="true" tabindex="-1"></a>               <span class="at">size =</span> <span class="fl">0.7</span>,</span>
<span id="cb45-7"><a href="#cb45-7" aria-hidden="true" tabindex="-1"></a>               <span class="at">add =</span> <span class="st">"mean_ci"</span>,</span>
<span id="cb45-8"><a href="#cb45-8" aria-hidden="true" tabindex="-1"></a>               <span class="at">point.size =</span> <span class="dv">2</span>,</span>
<span id="cb45-9"><a href="#cb45-9" aria-hidden="true" tabindex="-1"></a>               <span class="at">xlab =</span> <span class="st">"Momento"</span> ,</span>
<span id="cb45-10"><a href="#cb45-10" aria-hidden="true" tabindex="-1"></a>               <span class="at">ylab =</span> <span class="st">"PEF (L/min) "</span>,</span>
<span id="cb45-11"><a href="#cb45-11" aria-hidden="true" tabindex="-1"></a>               <span class="at">ggtheme =</span> <span class="fu">theme_bw</span>()) <span class="sc">+</span></span>
<span id="cb45-12"><a href="#cb45-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span> (<span class="at">text =</span> <span class="fu">element_text</span> (<span class="at">size =</span> <span class="dv">13</span>),</span>
<span id="cb45-13"><a href="#cb45-13" aria-hidden="true" tabindex="-1"></a>         <span class="at">axis.text.x=</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>))</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-aero1" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-aero1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="17-testes-naoParametricos_files/figure-html/fig-aero1-1.png" class="quarto-figure quarto-figure-center figure-img" style="width:70.0%;height:70.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-aero1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figura&nbsp;17.4: Impacto de exercícios aeróbicos na função respiratória de 10 escolares asmáticos.
</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="criação-de-uma-variável-que-represente-a-diferença-entre-os-momentos" class="level4" data-number="17.5.1.4">
<h4 data-number="17.5.1.4" class="anchored" data-anchor-id="criação-de-uma-variável-que-represente-a-diferença-entre-os-momentos"><span class="header-section-number">17.5.1.4</span> Criação de uma variável que represente a diferença entre os momentos</h4>
<p>A diferença entre as média basal e final será atribuída ao nome <code>D</code>. Esta ação será realizada, utilizando o banco de dados amplo (<code>dados</code>):</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>dados<span class="sc">$</span>D <span class="ot">&lt;-</span> dados<span class="sc">$</span>basal <span class="sc">-</span> dados<span class="sc">$</span>final</span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span> (dados)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 4
     id basal final     D
  &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
1     1   120   220  -100
2     2   200   300  -100
3     3   140   230   -90
4     4   200   180    20
5     5   110   300  -190
6     6   240   330   -90</code></pre>
</div>
</div>
<p><u>Resumo da variável D</u></p>
<p>Ao resumo será atribuído ao nome <code>resumo2</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a>resumo2 <span class="ot">&lt;-</span> dados <span class="sc">%&gt;%</span> </span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">summarise</span>(<span class="at">n =</span> <span class="fu">n</span> (),</span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a>                   <span class="at">mediana =</span> <span class="fu">median</span> (D, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a>                   <span class="at">p25=</span><span class="fu">quantile</span>(D, <span class="at">probs =</span> <span class="fl">0.25</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a>                   <span class="at">p75=</span><span class="fu">quantile</span>(D, <span class="at">probs =</span> <span class="fl">0.75</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span>
<span id="cb48-6"><a href="#cb48-6" aria-hidden="true" tabindex="-1"></a>resumo2</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 4
      n mediana   p25   p75
  &lt;int&gt;   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
1    10     -90  -100 -57.5</code></pre>
</div>
</div>
<p>O sinal negativo demonstra que houve um aumento do PFM do momento basal para o final.</p>
</section>
</section>
<section id="definição-das-hipóteses-estatísticas" class="level3" data-number="17.5.2">
<h3 data-number="17.5.2" class="anchored" data-anchor-id="definição-das-hipóteses-estatísticas"><span class="header-section-number">17.5.2</span> Definição das hipóteses estatísticas</h3>
<p>Da mesma maneira que o teste <em>t</em> pareado, as hipóteses estabelecidas comparam dois grupos dependentes. O teste de Wilcoxon é usado para avaliar a hipótese nula de que a distribuição das diferenças entre os grupos tem uma diferença mediana igual a 0.</p>
<blockquote class="blockquote">
<p><span class="math inline">\(H_{0}: D_{i} = 0\)</span></p>
</blockquote>
<blockquote class="blockquote">
<p><span class="math inline">\(H_{A}: D_{i} \ne 0\)</span></p>
</blockquote>
<p>Note que a <span class="math inline">\(H_{A}\)</span> estabelece que a diferença pode aumentar ou diminuir. Logo, o teste é bicaudal.</p>
</section>
<section id="execução-do-teste-estatístico" class="level3" data-number="17.5.3">
<h3 data-number="17.5.3" class="anchored" data-anchor-id="execução-do-teste-estatístico"><span class="header-section-number">17.5.3</span> Execução do teste estatístico</h3>
<section id="lógica-do-teste-de-wilcoxon" class="level4" data-number="17.5.3.1">
<h4 data-number="17.5.3.1" class="anchored" data-anchor-id="lógica-do-teste-de-wilcoxon"><span class="header-section-number">17.5.3.1</span> Lógica do teste de Wilcoxon</h4>
<ol type="1">
<li>A ideia do teste é verificar se as diferenças positivas são maiores ou menores, em grandeza absoluta, que as diferenças negativas. Para isso, foi criada, anteriormente, a variável <code>D</code>. Agora, será criada outra variável, iguala a variável <code>D</code>, apenas ignorando o sinal, denominada <code>D_abs</code>, diferença absoluta entre as variáveis <code>final</code> e <code>basal</code>.</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a>dados<span class="sc">$</span>D_abs <span class="ot">&lt;-</span> <span class="fu">abs</span>(dados<span class="sc">$</span>basal <span class="sc">-</span> dados<span class="sc">$</span>final)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ol start="2" type="1">
<li>Excluir os casos com diferença igual a 0 (zero). Para isso, uma maneira possível é extrair um subconjunto de dados do conjunto principal (<code>dados</code>), criando um conjunto de dados com a função <code>filter()</code> do pacote <code>dplyr</code>, que receberá o nome de <code>dados1</code>. O argumento <code>D_absbs != 0</code> significa todas as diferenças absolutas diferentes de 0:</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a>dados1 <span class="ot">&lt;-</span> dados <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">filter</span>(D_abs <span class="sc">!=</span> <span class="dv">0</span>)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Observe que como não há diferenças zeradas. Ou seja, o novo conjunto de dados continua o mesmo. O que pode ser confirmado, executando a função <code>str()</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span> (dados1)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>tibble [10 × 5] (S3: tbl_df/tbl/data.frame)
 $ id   : int [1:10] 1 2 3 4 5 6 7 8 9 10
 $ basal: num [1:10] 120 200 140 200 110 240 150 120 250 190
 $ final: num [1:10] 220 300 230 180 300 330 230 250 300 200
 $ D    : num [1:10] -100 -100 -90 20 -190 -90 -80 -130 -50 -10
 $ D_abs: num [1:10] 100 100 90 20 190 90 80 130 50 10</code></pre>
</div>
</div>
<ol start="3" type="1">
<li>Ordenar de forma crescente todos os valores da variável <code>D_abs</code> do banco de dados <code>dados1</code>, usando a função <code>arrange()</code> do pacote <code>dplyr</code>:</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a>dados1 <span class="ot">&lt;-</span> dados1 <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">arrange</span>(dados1<span class="sc">$</span>D_abs)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ol start="4" type="1">
<li>Estabelecer postos para os valores ordenados da variável <code>D_abs</code>, do conjunto de dados <code>dados1</code>, fazendo a média das ordens quando houver empate. A execução deste comando cria uma nova variável, chamada <code>postos</code>:</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a>dados1<span class="sc">$</span>postos <span class="ot">&lt;-</span> <span class="fu">rank</span>(dados1<span class="sc">$</span>D_abs)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ol start="5" type="1">
<li>Estabelecer sinais para os postos, criando dois subconjuntos de dados do conjuntos dados1, um com os escolares com postos positivos (<code>pos</code>) e outros com postos negativos(<code>neg</code>):</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a>neg <span class="ot">&lt;-</span> dados1 <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">filter</span>(D <span class="sc">&lt;</span> <span class="dv">0</span>)</span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a>pos <span class="ot">&lt;-</span> dados1 <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">filter</span>(D <span class="sc">&gt;</span> <span class="dv">0</span>)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ol start="6" type="1">
<li>Somar todos os postos (variável <code>posto</code>) em cada um dos subconjuntos criados (<code>neg</code> e <code>pos</code>):</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a>soma_neg <span class="ot">&lt;-</span> <span class="fu">sum</span>(neg<span class="sc">$</span>postos)</span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a>soma_pos <span class="ot">&lt;-</span> <span class="fu">sum</span>(pos<span class="sc">$</span>postos)</span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span> (<span class="fu">c</span>(soma_neg, soma_pos))</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 53  2</code></pre>
</div>
</div>
<ol start="7" type="1">
<li>Atribuir a menor soma à estatística do teste, denotada <em>T</em>:</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a>T <span class="ot">&lt;-</span> <span class="fu">min</span> (soma_neg <span class="sc">:</span> soma_pos)</span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a>T</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 2</code></pre>
</div>
</div>
<ol start="8" type="1">
<li>Para dados com tamanhos grandes (&gt; 20 pares), a significância de <em>T</em> pode ser determinada <span class="citation" data-cites="zar2014wilcoxon">(<a href="references.html#ref-zar2014wilcoxon" role="doc-biblioref">3</a>)</span>, considerando que a distribuição de <em>T</em> tem aproximadamente distribuição normal com média igual a</li>
</ol>
<p><span class="math display">\[
\mu_{T} =\frac{n \times \left (n + 1  \right )}{4}
\]</span></p>
<p>onde <em>n</em> é o tamanho da amostra.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">length</span>(dados<span class="sc">$</span>D)</span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a>mu_T <span class="ot">&lt;-</span> (n <span class="sc">*</span> (n <span class="sc">+</span> <span class="dv">1</span>))<span class="sc">/</span><span class="dv">4</span></span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a>mu_T</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 27.5</code></pre>
</div>
</div>
<p>E desvio padrão igual a:</p>
<p><span class="math display">\[
\sigma_{T}= \sqrt {\frac{n\left (n + 1  \right )\times \left (2n + 1  \right )}{24}}
\]</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a>dp_T <span class="ot">&lt;-</span> <span class="fu">sqrt</span> ((n<span class="sc">*</span>(n <span class="sc">+</span> <span class="dv">1</span>)) <span class="sc">*</span> (<span class="dv">2</span> <span class="sc">*</span> n <span class="sc">+</span> <span class="dv">1</span>) <span class="sc">/</span><span class="dv">24</span>) </span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a>dp_T</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 9.810708</code></pre>
</div>
</div>
<p>Os resultados da execução das equações fornecem os dados para calcular a estatística Z_T com correção de continuidade e, a partir dela, calcular o valor <em>P</em>.</p>
<p><span class="math display">\[
Z_{T}= \frac{\left |T - \mu_{T}  \right | - 0,5}{\sigma_{T}}
\]</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a>Z_T <span class="ot">&lt;-</span> (<span class="fu">abs</span>(T <span class="sc">-</span> mu_T)<span class="sc">-</span> <span class="fl">0.5</span>)<span class="sc">/</span>dp_T</span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a>Z_T</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 2.548236</code></pre>
</div>
</div>
<ol start="9" type="1">
<li><p>Concluindo, o valor da estatística de teste <em>T</em> é superior ao <span class="math inline">\(Z_{crítico} = 1,96\)</span>, para um <span class="math inline">\(\alpha = 0,05\)</span>. Dessa forma, a <span class="math inline">\(H_{0}\)</span> é rejeitada. Existe uma diferença significativa entre o PFE basal e o PFE final, neste grupo de escolares asmáticos.</p></li>
<li><p>O valor <em>P</em> pode ser obtido com a função <code>pnorm()</code> e multiplicando o resultado por 2, pois o teste é bilateral.</p></li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a>P <span class="ot">&lt;-</span> <span class="fu">pnorm</span> (Z_T, <span class="at">lower.tail =</span> <span class="cn">FALSE</span>) <span class="sc">*</span> <span class="dv">2</span></span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a>P</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.01082692</code></pre>
</div>
</div>
<p>Como já dito anteriormente, na prática, não há necessidade de fazer todos esses cálculos, pois o R calcula facilmente o teste. Eles são apenas uma demonstração de como o teste funciona.</p>
</section>
<section id="cálculo-do-teste-de-wilcoxon-no-r" class="level4" data-number="17.5.3.2">
<h4 data-number="17.5.3.2" class="anchored" data-anchor-id="cálculo-do-teste-de-wilcoxon-no-r"><span class="header-section-number">17.5.3.2</span> Cálculo do teste de Wilcoxon no R</h4>
<p>Usando o conjunto de dados no formato longo (<code>dadosL</code>), calcula-se o teste com a função <code>wilcox_test()</code> do pacote <code>rstatix</code>. É a mesma função utilizada para o teste de U de Mann-Whitney, mudando apenas o argumento <code>paired=FALSE</code> para <code>paired=TRUE</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a>teste1 <span class="ot">&lt;-</span> dadosL <span class="sc">%&gt;%</span> </span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a>  rstatix<span class="sc">::</span><span class="fu">wilcox_test</span>(medidas <span class="sc">~</span> momento, <span class="at">paired =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb69-3"><a href="#cb69-3" aria-hidden="true" tabindex="-1"></a>  rstatix<span class="sc">::</span><span class="fu">add_significance</span>()</span>
<span id="cb69-4"><a href="#cb69-4" aria-hidden="true" tabindex="-1"></a>teste1</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 8
  .y.     group1 group2    n1    n2 statistic      p p.signif
  &lt;chr&gt;   &lt;chr&gt;  &lt;chr&gt;  &lt;int&gt; &lt;int&gt;     &lt;dbl&gt;  &lt;dbl&gt; &lt;chr&gt;   
1 medidas basal  final     10    10         2 0.0107 *       </code></pre>
</div>
</div>
<p>Observe que o resultado é o mesmo calculado manualmente.</p>
</section>
</section>
<section id="tamanho-do-efeito" class="level3" data-number="17.5.4">
<h3 data-number="17.5.4" class="anchored" data-anchor-id="tamanho-do-efeito"><span class="header-section-number">17.5.4</span> Tamanho do efeito</h3>
<p>O tamanho do efeito pode ser calculado da mesma forma que para o teste de Mann-Whitney (<a href="#sec-tefMW" class="quarto-xref"><span>Seção 17.4.5</span></a>), usando a mesma equação e os dados obtidos acima, onde 2.548236 e <em>n</em> = 10 tem-se</p>
<p><span class="math display">\[
r = \frac {Z_{T}}{\sqrt{n}}
\]</span></p>
<p>Pode-se usar também a função <code>wilcox_effsize()</code> para calcular a estatística <em>r</em>. A Saída exibe junto a magnitude o efeito, que no caso é grande (&gt; 0,5 como mostra a <a href="#tbl-wilcoxef" class="quarto-xref">Tabela&nbsp;<span>17.2</span></a> do teste de Mann-Whitney).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a>dadosL <span class="sc">%&gt;%</span> </span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">wilcox_effsize</span>(medidas <span class="sc">~</span> momento, <span class="at">paired =</span> <span class="cn">TRUE</span>)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 7
  .y.     group1 group2 effsize    n1    n2 magnitude
* &lt;chr&gt;   &lt;chr&gt;  &lt;chr&gt;    &lt;dbl&gt; &lt;int&gt; &lt;int&gt; &lt;ord&gt;    
1 medidas basal  final    0.823    10    10 large    </code></pre>
</div>
</div>
</section>
<section id="conclusão-1" class="level3" data-number="17.5.5">
<h3 data-number="17.5.5" class="anchored" data-anchor-id="conclusão-1"><span class="header-section-number">17.5.5</span> Conclusão</h3>
<p>Assumindo um <span class="math inline">\(\alpha = 0,05\)</span>, se o valor <em>P</em>, obtido pelo teste, for menor do que 0,05, rejeita-se a hipótese nula (V = 2, <em>P</em> = 0,01, <em>n</em> = 10).</p>
<p>Pode-se concluir que existe diferença nas medidas do pico de fluxo expiratório máximo no início e no fim do programa de exercícios aeróbicos realizados pelos escolares asmáticos e a magnitude do efeito foi grande (<em>r</em> = 0,82).</p>
<p>Isto pode ser visualizado na <a href="#fig-aero2" class="quarto-xref">Figura&nbsp;<span>17.5</span></a>:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a>bxp <span class="ot">&lt;-</span> ggpubr<span class="sc">::</span><span class="fu">ggboxplot</span>(dadosL,</span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a>                         <span class="at">x =</span> <span class="st">"momento"</span>,</span>
<span id="cb73-3"><a href="#cb73-3" aria-hidden="true" tabindex="-1"></a>                         <span class="at">y =</span> <span class="st">"medidas"</span>,</span>
<span id="cb73-4"><a href="#cb73-4" aria-hidden="true" tabindex="-1"></a>                         <span class="at">bxp.errorbar =</span> <span class="cn">TRUE</span>,</span>
<span id="cb73-5"><a href="#cb73-5" aria-hidden="true" tabindex="-1"></a>                         <span class="at">bxp.errorbar.width =</span> <span class="fl">0.1</span>,</span>
<span id="cb73-6"><a href="#cb73-6" aria-hidden="true" tabindex="-1"></a>                         <span class="at">fill =</span> <span class="st">"momento"</span>,</span>
<span id="cb73-7"><a href="#cb73-7" aria-hidden="true" tabindex="-1"></a>                         <span class="at">palette =</span> <span class="fu">c</span>(<span class="st">"cyan4"</span>, <span class="st">"cyan3"</span>),</span>
<span id="cb73-8"><a href="#cb73-8" aria-hidden="true" tabindex="-1"></a>                         <span class="at">legend =</span> <span class="st">"none"</span>,</span>
<span id="cb73-9"><a href="#cb73-9" aria-hidden="true" tabindex="-1"></a>                         <span class="at">ggtheme =</span> <span class="fu">theme_bw</span>(),</span>
<span id="cb73-10"><a href="#cb73-10" aria-hidden="true" tabindex="-1"></a>                         <span class="at">xlab =</span> <span class="st">"Momento"</span> ,</span>
<span id="cb73-11"><a href="#cb73-11" aria-hidden="true" tabindex="-1"></a>                         <span class="at">ylab =</span> <span class="st">"PEF (L/min) "</span>) <span class="sc">+</span></span>
<span id="cb73-12"><a href="#cb73-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span> (<span class="at">text =</span> <span class="fu">element_text</span> (<span class="at">size =</span> <span class="dv">13</span>),</span>
<span id="cb73-13"><a href="#cb73-13" aria-hidden="true" tabindex="-1"></a>         <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">11</span>))</span>
<span id="cb73-14"><a href="#cb73-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-15"><a href="#cb73-15" aria-hidden="true" tabindex="-1"></a>teste <span class="ot">&lt;-</span> dadosL <span class="sc">%&gt;%</span> </span>
<span id="cb73-16"><a href="#cb73-16" aria-hidden="true" tabindex="-1"></a>  rstatix<span class="sc">::</span><span class="fu">wilcox_test</span> (medidas <span class="sc">~</span> momento, <span class="at">paired =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb73-17"><a href="#cb73-17" aria-hidden="true" tabindex="-1"></a>  rstatix<span class="sc">::</span><span class="fu">add_significance</span> ()</span>
<span id="cb73-18"><a href="#cb73-18" aria-hidden="true" tabindex="-1"></a>teste <span class="ot">&lt;-</span> teste <span class="sc">%&gt;%</span> rstatix<span class="sc">::</span><span class="fu">add_xy_position</span> ()</span>
<span id="cb73-19"><a href="#cb73-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-20"><a href="#cb73-20" aria-hidden="true" tabindex="-1"></a>bxp <span class="sc">+</span> </span>
<span id="cb73-21"><a href="#cb73-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_pvalue_manual</span> (teste, </span>
<span id="cb73-22"><a href="#cb73-22" aria-hidden="true" tabindex="-1"></a>                      <span class="at">tip.length =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb73-23"><a href="#cb73-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span> (<span class="at">subtitle =</span> <span class="fu">get_test_label</span> (<span class="at">stat.test =</span> teste, </span>
<span id="cb73-24"><a href="#cb73-24" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">detailed =</span> <span class="cn">TRUE</span>))</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-aero2" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-aero2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="17-testes-naoParametricos_files/figure-html/fig-aero2-1.png" class="quarto-figure quarto-figure-center figure-img" style="width:70.0%;height:70.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-aero2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figura&nbsp;17.5: Impacto de exercícios aeróbicos na função respiratória de 10 escolares asmáticos.
</figcaption>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="sec-kuskalwallis" class="level2" data-number="17.6">
<h2 data-number="17.6" class="anchored" data-anchor-id="sec-kuskalwallis"><span class="header-section-number">17.6</span> Teste de Kruskal-Wallis</h2>
<p>Quando os pressupostos subjacentes à ANOVA não são atendidos, é possível usar o teste não paramétrico de Kruskal-Wallis (KW) para testar a hipótese de que os parâmetros de localização são iguais. Pode ser considerado uma extensão do teste de Wilcoxon-Mann-Whitney.</p>
<p>Enquanto a ANOVA depende da hipótese de que todas as populações são independentes e normalmente distribuídas, o teste de Kruskal-Wallis exige apenas amostras aleatórias independentes provenientes de suas respectivas populações. Entretanto, este teste somente deve ser aplicado se a amostra for pequena e/ou os pressupostos para a ANOVA forem seriamente violados.</p>
<p>O teste não usa diretamente medições de quantidade conhecida, utiliza, como outros testes não paramétricos, os postos dos valores analisados. Em função disso, é também conhecido como <em>análise de variância de um fator em postos</em>.</p>
<section id="dados-usados-nesta-seção-2" class="level3" data-number="17.6.1">
<h3 data-number="17.6.1" class="anchored" data-anchor-id="dados-usados-nesta-seção-2"><span class="header-section-number">17.6.1</span> Dados usados nesta seção</h3>
<p>Um experimento foi realizado para verificar se o álcool ou o café afetam os tempos de reação ao dirigir <span class="citation" data-cites="karadimitriou2020kruskal">(<a href="references.html#ref-karadimitriou2020kruskal" role="doc-biblioref">4</a>)</span>. O estudo tem três grupos diferentes de participantes: 10 bebendo água (controle), 10 bebendo cerveja contendo duas unidades de álcool e 10 bebendo café. O tempo de reação em uma simulação de direção foi medido para cada participante.</p>
<p>Os dados encontram-se no arquivo <code>dadosResposta.xlsx</code>. Clique <a href="https://github.com/petronioliveira/Arquivos/blob/main/dadosResposta.xlsx"><strong>aqui</strong></a> para baixar e, após, salve o mesmo no seu diretório de trabalho.</p>
<p>As variáveis são:</p>
<ul>
<li><strong>id</strong> <span class="math inline">\(\to\)</span> identificação do participante;</li>
<li><strong>tempo</strong> <span class="math inline">\(\to\)</span> tempo de reação na simulação de direção em segundos;</li>
<li><strong>bebida</strong> <span class="math inline">\(\to\)</span> três grupo: água, álcool e café.</li>
</ul>
<p>O estudo pretende verificar se existe diferença no tempo de reação dos participantes em um teste de direção com a ingesta de água, café e álcool.</p>
<section id="leitura-e-exploração-dos-dados" class="level4" data-number="17.6.1.1">
<h4 data-number="17.6.1.1" class="anchored" data-anchor-id="leitura-e-exploração-dos-dados"><span class="header-section-number">17.6.1.1</span> Leitura e exploração dos dados</h4>
<p>Como o dados estão contidos em um arquivo Excel (<em>.xlsx</em>), serão lidos com a função <code>read_excel()</code> do pacote <code>readxl</code> e a sua estrutura será observada com função <code>str()</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a>dados <span class="ot">&lt;-</span> <span class="fu">read_excel</span> (<span class="st">"dados/dadosResposta.xlsx"</span>)</span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(dados)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>tibble [30 × 3] (S3: tbl_df/tbl/data.frame)
 $ id    : num [1:30] 1 2 3 4 5 6 7 8 9 10 ...
 $ tempo : num [1:30] 0.37 0.38 0.61 0.78 0.83 0.86 0.9 0.95 1.63 1.97 ...
 $ bebida: chr [1:30] "agua" "agua" "agua" "agua" ...</code></pre>
</div>
</div>
<p>O formato do arquivo é o longo. A variável bebida encontra-se como caracter e deve ser transformada em fator e as categorias na sequência: <code>agua</code>, <code>cafe</code> e <code>alcool</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a>dados<span class="sc">$</span>bebida <span class="ot">&lt;-</span> <span class="fu">factor</span>(dados<span class="sc">$</span>bebida, </span>
<span id="cb76-2"><a href="#cb76-2" aria-hidden="true" tabindex="-1"></a>                       <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"agua"</span>, <span class="st">"cafe"</span>, <span class="st">"alcool"</span>))</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Os dados serão observados visualmente através de boxplots (<a href="#fig-bebida" class="quarto-xref">Figura&nbsp;<span>17.6</span></a>), usando a função <code>ggplot()</code> do pacote <code>ggplot2</code>, com cores do <code>nejm</code> (<em>New England Journal of Medicine</em>) o pacote <code>ggsci</code>.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a>ggpubr<span class="sc">::</span><span class="fu">ggboxplot</span>(dados,</span>
<span id="cb77-2"><a href="#cb77-2" aria-hidden="true" tabindex="-1"></a>                   <span class="at">x =</span> <span class="st">"bebida"</span>,</span>
<span id="cb77-3"><a href="#cb77-3" aria-hidden="true" tabindex="-1"></a>                   <span class="at">y =</span> <span class="st">"tempo"</span>,</span>
<span id="cb77-4"><a href="#cb77-4" aria-hidden="true" tabindex="-1"></a>                   <span class="at">bxp.errorbar =</span> T,</span>
<span id="cb77-5"><a href="#cb77-5" aria-hidden="true" tabindex="-1"></a>                   <span class="at">bxp.errorbar.width =</span> <span class="fl">0.1</span>,</span>
<span id="cb77-6"><a href="#cb77-6" aria-hidden="true" tabindex="-1"></a>                   <span class="at">fill =</span> <span class="st">"bebida"</span>,</span>
<span id="cb77-7"><a href="#cb77-7" aria-hidden="true" tabindex="-1"></a>                   <span class="at">palette =</span> <span class="st">"nejm"</span>,</span>
<span id="cb77-8"><a href="#cb77-8" aria-hidden="true" tabindex="-1"></a>                   <span class="at">legend =</span> <span class="st">"none"</span>,</span>
<span id="cb77-9"><a href="#cb77-9" aria-hidden="true" tabindex="-1"></a>                   <span class="at">ggtheme =</span> <span class="fu">theme_bw</span>(),</span>
<span id="cb77-10"><a href="#cb77-10" aria-hidden="true" tabindex="-1"></a>                   <span class="at">xlab =</span> <span class="st">"Tipo de bebida"</span> ,</span>
<span id="cb77-11"><a href="#cb77-11" aria-hidden="true" tabindex="-1"></a>                   <span class="at">ylab =</span> <span class="st">"Tempo de reação (seg)"</span>) <span class="sc">+</span></span>
<span id="cb77-12"><a href="#cb77-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>))</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-bebida" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-bebida-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="17-testes-naoParametricos_files/figure-html/fig-bebida-1.png" class="quarto-figure quarto-figure-center figure-img" style="width:70.0%;height:70.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-bebida-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figura&nbsp;17.6: Impacto do tipo de bebida no tempo de reação ao dirigir.
</figcaption>
</figure>
</div>
</div>
</div>
<p>Os boxplots exibem dados com medianas visualmente diferentes, bigodes diferentes e grupos com presença de <em>outliers</em>. Para verificar o impacto desses achados, pode-se usar a função <code>identify_outliers()</code>, do pacote <code>rstatix</code> que confirma, na sua Saída, a presença de <em>outliers</em> no grupo <code>agua</code> e <code>cafe</code>, sendo dois extremos.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a>dados <span class="sc">%&gt;%</span> </span>
<span id="cb78-2"><a href="#cb78-2" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">group_by</span>(bebida) <span class="sc">%&gt;%</span> </span>
<span id="cb78-3"><a href="#cb78-3" aria-hidden="true" tabindex="-1"></a>  rstatix<span class="sc">::</span><span class="fu">identify_outliers</span>(tempo)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 4 × 5
  bebida    id tempo is.outlier is.extreme
  &lt;fct&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;lgl&gt;      &lt;lgl&gt;     
1 agua       9  1.63 TRUE       FALSE     
2 agua      10  1.97 TRUE       TRUE      
3 cafe      19  2.56 TRUE       FALSE     
4 cafe      20  3.07 TRUE       TRUE      </code></pre>
</div>
</div>
<p>Para avaliar a normalidade será usado o teste de Shapiro-Wilk, com a função <code>shapiro_test()</code> e a função <code>group_by()</code> do pacote <code>dplyr</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a>dados <span class="sc">%&gt;%</span> </span>
<span id="cb80-2"><a href="#cb80-2" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">group_by</span> (bebida) <span class="sc">%&gt;%</span> </span>
<span id="cb80-3"><a href="#cb80-3" aria-hidden="true" tabindex="-1"></a>  rstatix<span class="sc">::</span><span class="fu">shapiro_test</span> (tempo) </span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 4
  bebida variable statistic      p
  &lt;fct&gt;  &lt;chr&gt;        &lt;dbl&gt;  &lt;dbl&gt;
1 agua   tempo        0.863 0.0837
2 cafe   tempo        0.815 0.0220
3 alcool tempo        0.875 0.114 </code></pre>
</div>
</div>
<p>A variável <code>cafe</code> tem uma distribuição que não se ajusta a distribuição normal.</p>
<p>Para completar a exploração dos dados, será solicitado, usando as funções <code>group_by ()</code> e <code>summarise</code>, do pacote <code>dplyr</code>, medidas de localização e dispersão adquadas para variáveis bem assimétricas.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a>resumo <span class="ot">&lt;-</span> dados <span class="sc">%&gt;%</span> </span>
<span id="cb82-2"><a href="#cb82-2" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">group_by</span>(bebida) <span class="sc">%&gt;%</span> </span>
<span id="cb82-3"><a href="#cb82-3" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">summarise</span>(<span class="at">n =</span> <span class="fu">n</span>(),</span>
<span id="cb82-4"><a href="#cb82-4" aria-hidden="true" tabindex="-1"></a>                   <span class="at">mediana =</span> <span class="fu">median</span> (tempo, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb82-5"><a href="#cb82-5" aria-hidden="true" tabindex="-1"></a>                   <span class="at">p25=</span><span class="fu">quantile</span>(tempo, <span class="at">probs =</span> <span class="fl">0.25</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb82-6"><a href="#cb82-6" aria-hidden="true" tabindex="-1"></a>                   <span class="at">p75=</span><span class="fu">quantile</span>(tempo, <span class="at">probs =</span> <span class="fl">0.75</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span>
<span id="cb82-7"><a href="#cb82-7" aria-hidden="true" tabindex="-1"></a>resumo</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 5
  bebida     n mediana   p25   p75
  &lt;fct&gt;  &lt;int&gt;   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
1 agua      10   0.845 0.653 0.937
2 cafe      10   1.44  1.28  1.68 
3 alcool    10   2.25  1.77  2.85 </code></pre>
</div>
</div>
</section>
</section>
<section id="hipóteses-estatísticas-1" class="level3" data-number="17.6.2">
<h3 data-number="17.6.2" class="anchored" data-anchor-id="hipóteses-estatísticas-1"><span class="header-section-number">17.6.2</span> Hipóteses estatísticas</h3>
<p>Se não houver diferença entre os grupos, ou seja, os grupos são provenientes de uma mesma população, as somas dos postos em cada grupo devem ficar próximas. Desta forma,</p>
<blockquote class="blockquote">
<p><span class="math inline">\(H_{0}\)</span>: As populações são iguais.</p>
</blockquote>
<blockquote class="blockquote">
<p><span class="math inline">\(H_{1}\)</span>: Pelo menos uma das populações tende a exibir valores diferentes do que as outras populações.</p>
</blockquote>
</section>
<section id="pressupostos-do-teste" class="level3" data-number="17.6.3">
<h3 data-number="17.6.3" class="anchored" data-anchor-id="pressupostos-do-teste"><span class="header-section-number">17.6.3</span> Pressupostos do teste</h3>
<p>O teste de Kruskal-Wallis pressupõe as seguintes condições para o seu adequado uso:</p>
<ol type="1">
<li>As amostras são amostras aleatórias independentes de suas respectivas populações;</li>
<li>A escala de medição utilizada é pelo menos ordinal e, se houver apenas três grupos, deve haver pelo menos 5 casos em cada grupo;</li>
<li>As distribuições dos valores nas populações amostradas são idênticas, exceto pela possibilidade de que uma ou mais das populações sejam compostas por valores que tendem a ser maiores do que os das outras populações.</li>
</ol>
</section>
<section id="execução-do-teste-estatístico-1" class="level3" data-number="17.6.4">
<h3 data-number="17.6.4" class="anchored" data-anchor-id="execução-do-teste-estatístico-1"><span class="header-section-number">17.6.4</span> Execução do teste estatístico</h3>
<section id="lógica-do-teste-de-kruskall-wallis" class="level4" data-number="17.6.4.1">
<h4 data-number="17.6.4.1" class="anchored" data-anchor-id="lógica-do-teste-de-kruskall-wallis"><span class="header-section-number">17.6.4.1</span> Lógica do teste de Kruskall-Wallis</h4>
<p>A teoria do teste Kruskal-Wallis é semelhante à do teste de Mann-Whitney, ou seja, tem como base a soma dos postos. Em primeiro lugar, os escores são ordenados do menor para o maior, independentemente do grupo que pertençam.</p>
<p>O menor recebe o posto 1 e assim por diante. Após a atribuição dos postos, soma-se os postos por grupo. A soma dos postos de cada grupo é representada por <span class="math inline">\(R_{1}\)</span>, <span class="math inline">\(R_{2}\)</span>, <span class="math inline">\(R_{3}\)</span>, …, <span class="math inline">\(R_{i}\)</span>. A estatística do teste, <em>H</em>, é calculada com a equação <span class="citation" data-cites="zar2014kruskal">(<a href="references.html#ref-zar2014kruskal" role="doc-biblioref">5</a>)</span>:</p>
<p><span class="math display">\[
H =\frac {12}{N \times \left (N + 1  \right )} \sum_{i=1}^{k} \frac {R_{i}^{2}}{n_{{i}}}-3 \times\left (N + 1\right)
\]</span></p>
<p>onde <span class="math inline">\(n_{i}\)</span> é o número de observações no grupo <em>i</em>, <span class="math inline">\(N = \sum_{i=1}^{k}\times n_{i}\)</span> (o número total de observações em todos os <em>k</em> grupos) e <span class="math inline">\(R_{i}\)</span> é a soma dos postos das <span class="math inline">\(n_{i}\)</span> observações no grupo <em>i</em>.</p>
<p>Uma boa verificação (mas não uma garantia) de que os postos foram atribuídos corretamente é ver se a soma de todos os postos é igual a <span class="math inline">\(\frac {N \times \left (N + 1\right )}{2}\)</span>.</p>
<ol type="1">
<li>Criar a variável <code>posto</code> com os postos ordenados de forma crescente, independente do grupo, como realizado no teste de Mann-Whitney:</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a>dados<span class="sc">$</span>posto <span class="ot">&lt;-</span> <span class="fu">rank</span>(dados<span class="sc">$</span>tempo, <span class="at">ties.method =</span> <span class="st">"average"</span>)</span>
<span id="cb84-2"><a href="#cb84-2" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(dados)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>tibble [30 × 4] (S3: tbl_df/tbl/data.frame)
 $ id    : num [1:30] 1 2 3 4 5 6 7 8 9 10 ...
 $ tempo : num [1:30] 0.37 0.38 0.61 0.78 0.83 0.86 0.9 0.95 1.63 1.97 ...
 $ bebida: Factor w/ 3 levels "agua","cafe",..: 1 1 1 1 1 1 1 1 1 1 ...
 $ posto : num [1:30] 1 2 3 4 5 6 7 8 16 22.5 ...</code></pre>
</div>
</div>
<ol start="2" type="1">
<li>Somar os postos de cada grupo separadamente:</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb86"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a>resumo1 <span class="ot">&lt;-</span> dados <span class="sc">%&gt;%</span> </span>
<span id="cb86-2"><a href="#cb86-2" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">group_by</span>(bebida) <span class="sc">%&gt;%</span> </span>
<span id="cb86-3"><a href="#cb86-3" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">summarise</span>(<span class="at">n =</span> <span class="fu">n</span>(),</span>
<span id="cb86-4"><a href="#cb86-4" aria-hidden="true" tabindex="-1"></a>                   <span class="at">soma =</span> <span class="fu">sum</span>(posto))</span>
<span id="cb86-5"><a href="#cb86-5" aria-hidden="true" tabindex="-1"></a>resumo1</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 3
  bebida     n  soma
  &lt;fct&gt;  &lt;int&gt; &lt;dbl&gt;
1 agua      10  74.5
2 cafe      10 157  
3 alcool    10 234. </code></pre>
</div>
</div>
<ol start="3" type="1">
<li>Cálculo da estatística do teste <em>H</em></li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb88"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="dv">30</span></span>
<span id="cb88-2"><a href="#cb88-2" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">10</span></span>
<span id="cb88-3"><a href="#cb88-3" aria-hidden="true" tabindex="-1"></a>R_agua <span class="ot">&lt;-</span> resumo1[<span class="dv">1</span>,<span class="dv">3</span>]</span>
<span id="cb88-4"><a href="#cb88-4" aria-hidden="true" tabindex="-1"></a>R_alcool <span class="ot">&lt;-</span> resumo1[<span class="dv">2</span>,<span class="dv">3</span>]</span>
<span id="cb88-5"><a href="#cb88-5" aria-hidden="true" tabindex="-1"></a>R_cafe <span class="ot">&lt;-</span> resumo1[<span class="dv">3</span>,<span class="dv">3</span>]</span>
<span id="cb88-6"><a href="#cb88-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-7"><a href="#cb88-7" aria-hidden="true" tabindex="-1"></a>H <span class="ot">&lt;-</span> (<span class="dv">12</span><span class="sc">/</span>(N<span class="sc">*</span>(N<span class="sc">+</span><span class="dv">1</span>))) <span class="sc">*</span> ((R_agua<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span>n) <span class="sc">+</span> (R_alcool<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span>n) <span class="sc">+</span> (R_cafe<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span>n)) <span class="sc">-</span> (<span class="dv">3</span><span class="sc">*</span>(N<span class="sc">+</span><span class="dv">1</span>))</span>
<span id="cb88-8"><a href="#cb88-8" aria-hidden="true" tabindex="-1"></a>H</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      soma
1 16.31806</code></pre>
</div>
</div>
<ol start="4" type="1">
<li>Cálculo do Valor <em>P</em></li>
</ol>
<p>Se existir três grupos, com cinco ou menos participantes em cada grupo, há necessidade de usar a tabela especial para tamanhos de amostra pequenos <span class="citation" data-cites="gopal2006table">(<a href="references.html#ref-gopal2006table" role="doc-biblioref">6</a>)</span>. Se você tiver mais de cinco participantes por grupo, trate <em>H</em> como qui-quadrado. A estatística <em>H</em> é estatisticamente significativo se for igual ou maior que o valor crítico qui-quadrado para o grau de liberdade específico, igual a <span class="math inline">\(k - 1\)</span>. Aqui, tem-se 10 participantes por grupo e, assumindo um <span class="math inline">\(\alpha = 0,05\)</span>, o <span class="math inline">\(H_{crítico}\)</span> é igual a:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb90"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> <span class="fl">0.05</span></span>
<span id="cb90-2"><a href="#cb90-2" aria-hidden="true" tabindex="-1"></a>k <span class="ot">&lt;-</span> <span class="dv">3</span></span>
<span id="cb90-3"><a href="#cb90-3" aria-hidden="true" tabindex="-1"></a>gl <span class="ot">=</span> k <span class="sc">-</span> <span class="dv">1</span></span>
<span id="cb90-4"><a href="#cb90-4" aria-hidden="true" tabindex="-1"></a>H_critico <span class="ot">&lt;-</span> <span class="fu">qchisq</span>(<span class="dv">1</span> <span class="sc">-</span> alpha, gl)</span>
<span id="cb90-5"><a href="#cb90-5" aria-hidden="true" tabindex="-1"></a>H_critico</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 5.991465</code></pre>
</div>
</div>
<p>Uma vez que o <span class="math inline">\(H_{calculado} = 16,3\)</span> é maior que <span class="math inline">\(H_{crítico} = 6,0\)</span> , rejeita-se a <span class="math inline">\(H_{0}\)</span>. O valor <em>P</em> é obtido através da função <code>pchisq()</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb92"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a>H <span class="ot">&lt;-</span> <span class="fl">16.32</span></span>
<span id="cb92-2"><a href="#cb92-2" aria-hidden="true" tabindex="-1"></a><span class="fu">pchisq</span>(H, <span class="dv">2</span>, <span class="at">lower.tail =</span> <span class="cn">FALSE</span>)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.0002858624</code></pre>
</div>
</div>
<p>O R tem funções que fazem facilmente esses cálculos enfadonhos. Eles são colocados aqui apenas para ilustrar o raciocínio de como o teste de Kruskal-Wallis funciona. Sempre existem curiosos lendo o livro!</p>
</section>
<section id="teste-de-kruskal-wallis-no-r" class="level4" data-number="17.6.4.2">
<h4 data-number="17.6.4.2" class="anchored" data-anchor-id="teste-de-kruskal-wallis-no-r"><span class="header-section-number">17.6.4.2</span> Teste de Kruskal-Wallis no R</h4>
<p>No R, pode-se calcular o teste, usando a função <code>kruskal_test()</code> do pacote <code>rstatix</code>, cujos argumentos podem ser consultados na ajuda do <em>RStudio</em>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb94"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a>teste <span class="ot">&lt;-</span> rstatix<span class="sc">::</span><span class="fu">kruskal_test</span> (<span class="at">data =</span> dados, <span class="at">formula =</span> tempo <span class="sc">~</span> bebida)</span>
<span id="cb94-2"><a href="#cb94-2" aria-hidden="true" tabindex="-1"></a>teste</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 6
  .y.       n statistic    df        p method        
* &lt;chr&gt; &lt;int&gt;     &lt;dbl&gt; &lt;int&gt;    &lt;dbl&gt; &lt;chr&gt;         
1 tempo    30      16.3     2 0.000286 Kruskal-Wallis</code></pre>
</div>
</div>
</section>
</section>
<section id="tamanho-do-efeito-1" class="level3" data-number="17.6.5">
<h3 data-number="17.6.5" class="anchored" data-anchor-id="tamanho-do-efeito-1"><span class="header-section-number">17.6.5</span> Tamanho do efeito</h3>
<p>O eta quadrado (<span class="math inline">\(\eta^{2}\)</span>), com base na estatística <em>H</em>, pode ser usado como a medida do tamanho do efeito do teste de Kruskal-Wallis. É calculado pela equação:</p>
<p><span class="math display">\[
\eta_{H}^{2} = \frac {\left (H - k + 1 \right)}{\left (N - k\right)}
\]</span></p>
<p>onde <em>H</em> é a estatística obtida no teste de Kruskal-Wallis; <em>k</em> é o número de grupos; N é o número total de observações <span class="citation" data-cites="tomczak2014need">(<a href="references.html#ref-tomczak2014need" role="doc-biblioref">7</a>)</span>.</p>
<p>A estimativa eta ao quadrado assume valores de 0 a 1 e, multiplicada por 100, indica a porcentagem de variância na variável dependente explicada pela variável independente. Pode ser obtido no R com a função <code>kruskal_effsize()</code> do pacote <code>rstatix:</code></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb96"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a>dados <span class="sc">%&gt;%</span> <span class="fu">kruskal_effsize</span> (tempo<span class="sc">~</span>bebida)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 5
  .y.       n effsize method  magnitude
* &lt;chr&gt; &lt;int&gt;   &lt;dbl&gt; &lt;chr&gt;   &lt;ord&gt;    
1 tempo    30   0.530 eta2[H] large    </code></pre>
</div>
</div>
<p>Um efeito <span class="math inline">\(\ge 0,14\)</span> é considerado grande e <span class="math inline">\(&lt;0,06\)</span> é pequeno <span class="citation" data-cites="watson2021effectsize">(<a href="references.html#ref-watson2021effectsize" role="doc-biblioref">8</a>)</span>.</p>
</section>
<section id="testes-post-hoc" class="level3" data-number="17.6.6">
<h3 data-number="17.6.6" class="anchored" data-anchor-id="testes-post-hoc"><span class="header-section-number">17.6.6</span> Testes post hoc</h3>
<p>A partir do resultado do teste de Kruskal-Wallis, sabe-se que há uma diferença significativa entre os grupos, mas não se sabe quais pares de grupos são diferentes.</p>
<p>Um teste de Kruskal-Wallis significativo é geralmente seguido pelo teste de Dunn <span class="citation" data-cites="dunn1964multiple">(<a href="references.html#ref-dunn1964multiple" role="doc-biblioref">9</a>)</span> para identificar quais grupos são diferentes.</p>
<p>Para realizar as múltiplas comparações, no R, pode ser usada a função <code>dunn_test()</code>, incluído no pacote <code>rstatix</code>. O ajuste de <em>P</em> é feito pelo método de Bonferroni:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb98"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb98-1"><a href="#cb98-1" aria-hidden="true" tabindex="-1"></a>pwc <span class="ot">&lt;-</span> dados <span class="sc">%&gt;%</span> </span>
<span id="cb98-2"><a href="#cb98-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">dunn_test</span> (tempo <span class="sc">~</span> bebida, <span class="at">p.adjust.method =</span> <span class="st">"bonferroni"</span>) </span>
<span id="cb98-3"><a href="#cb98-3" aria-hidden="true" tabindex="-1"></a>pwc</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 9
  .y.   group1 group2    n1    n2 statistic         p    p.adj p.adj.signif
* &lt;chr&gt; &lt;chr&gt;  &lt;chr&gt;  &lt;int&gt; &lt;int&gt;     &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt; &lt;chr&gt;       
1 tempo agua   cafe      10    10      2.10 0.0361    0.108    ns          
2 tempo agua   alcool    10    10      4.04 0.0000537 0.000161 ***         
3 tempo cafe   alcool    10    10      1.94 0.0520    0.156    ns          </code></pre>
</div>
</div>
<p>A saída do teste de Dunn, mostra que existe uma diferença estatisticamente significativa apenas entre a água e o álcool, valor <em>P</em> ajustado igual a 1.61^{-4}.</p>
</section>
<section id="conclusão-2" class="level3" data-number="17.6.7">
<h3 data-number="17.6.7" class="anchored" data-anchor-id="conclusão-2"><span class="header-section-number">17.6.7</span> Conclusão</h3>
<p>Um teste de Kruskal-Wallis foi realizado para comparar os tempos de reação em uma simulação de direção após beber água, café ou álcool. Houve evidência de uma diferença (<em>P</em> = 0,00029) de pelo menos um par de grupos (<a href="#fig-bebida1" class="quarto-xref">Figura&nbsp;<span>17.7</span></a>).</p>
<p>O teste de comparações de pares, usando o teste de Dunn, foi realizado para os três pares de grupos. Houve evidencia de diferença entre o grupo que consumiu duas unidades de álcool e o grupo que ingeriu água (<em>P</em> ajustado (Bonferroni) = 0,00016). Entre os demais pares não houve diferença significativa. O tempo mediano de reação para o grupo que recebeu água foi de 0,84 (0,65 – 0,94) segundos, em comparação com 2,25(1,77 – 2,85) segundos no grupo que bebeu cerveja equivalente a duas unidades de álcool, enquanto para o café foi de 1,45(1,28 – 1,69) segundos.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb100"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb100-1"><a href="#cb100-1" aria-hidden="true" tabindex="-1"></a>pwc <span class="ot">&lt;-</span> pwc <span class="sc">%&gt;%</span> rstatix<span class="sc">::</span><span class="fu">add_xy_position</span>(<span class="at">x=</span> <span class="st">"bebida"</span>)</span>
<span id="cb100-2"><a href="#cb100-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb100-3"><a href="#cb100-3" aria-hidden="true" tabindex="-1"></a>ggpubr<span class="sc">::</span><span class="fu">ggboxplot</span>(dados,</span>
<span id="cb100-4"><a href="#cb100-4" aria-hidden="true" tabindex="-1"></a>                  <span class="at">x =</span> <span class="st">"bebida"</span>,</span>
<span id="cb100-5"><a href="#cb100-5" aria-hidden="true" tabindex="-1"></a>                  <span class="at">y =</span> <span class="st">"tempo"</span>,</span>
<span id="cb100-6"><a href="#cb100-6" aria-hidden="true" tabindex="-1"></a>                  <span class="at">bxp.errorbar =</span> <span class="cn">TRUE</span>,</span>
<span id="cb100-7"><a href="#cb100-7" aria-hidden="true" tabindex="-1"></a>                  <span class="at">bxp.errorbar.width =</span> <span class="fl">0.1</span>,</span>
<span id="cb100-8"><a href="#cb100-8" aria-hidden="true" tabindex="-1"></a>                  <span class="at">fill =</span> <span class="st">"bebida"</span>,</span>
<span id="cb100-9"><a href="#cb100-9" aria-hidden="true" tabindex="-1"></a>                  <span class="at">palette =</span> <span class="st">"nejm"</span>,</span>
<span id="cb100-10"><a href="#cb100-10" aria-hidden="true" tabindex="-1"></a>                  <span class="at">legend =</span> <span class="st">"none"</span>,</span>
<span id="cb100-11"><a href="#cb100-11" aria-hidden="true" tabindex="-1"></a>                  <span class="at">ggtheme =</span> <span class="fu">theme_bw</span>())<span class="sc">+</span></span>
<span id="cb100-12"><a href="#cb100-12" aria-hidden="true" tabindex="-1"></a>  ggpubr<span class="sc">::</span><span class="fu">stat_pvalue_manual</span> (pwc,</span>
<span id="cb100-13"><a href="#cb100-13" aria-hidden="true" tabindex="-1"></a>                              <span class="at">label =</span> <span class="st">"p = {scales::pvalue(p.adj)}"</span>,</span>
<span id="cb100-14"><a href="#cb100-14" aria-hidden="true" tabindex="-1"></a>                              <span class="at">label.size =</span> <span class="fl">3.2</span>,</span>
<span id="cb100-15"><a href="#cb100-15" aria-hidden="true" tabindex="-1"></a>                              <span class="at">hide.ns =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb100-16"><a href="#cb100-16" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Tipo de bebida"</span>, </span>
<span id="cb100-17"><a href="#cb100-17" aria-hidden="true" tabindex="-1"></a>                <span class="at">y =</span> <span class="st">"Tempo de reação (seg)"</span>,</span>
<span id="cb100-18"><a href="#cb100-18" aria-hidden="true" tabindex="-1"></a>                <span class="at">subtitle =</span> <span class="fu">get_test_label</span> (teste, <span class="at">detailed =</span> <span class="cn">TRUE</span>),</span>
<span id="cb100-19"><a href="#cb100-19" aria-hidden="true" tabindex="-1"></a>                <span class="at">caption =</span> <span class="fu">get_pwc_label</span>(pwc))</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-bebida1" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-bebida1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="17-testes-naoParametricos_files/figure-html/fig-bebida1-1.png" class="quarto-figure quarto-figure-center figure-img" style="width:70.0%;height:70.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-bebida1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figura&nbsp;17.7: Impacto do tipo de bebida no tempo de reação ao dirigir.
</figcaption>
</figure>
</div>
</div>
</div>


<div id="refs" class="references csl-bib-body" role="list" style="display: none">
<div id="ref-altman1991mannwhitney" class="csl-entry" role="listitem">
<div class="csl-left-margin">1. </div><div class="csl-right-inline">Altman DG. Comparing groups: continuos data. Em: Practical Statistics for Medical Research. London: Chapman &amp; Hall/CRC; 1991. p. 194–7. </div>
</div>
<div id="ref-hothorn2006lego" class="csl-entry" role="listitem">
<div class="csl-left-margin">2. </div><div class="csl-right-inline">Hothorn T, Hornik K, Van De Wiel MA, Zeileis A. A lego system for conditional inference. The American Statistician. 2006;60(3):257–63. </div>
</div>
<div id="ref-zar2014wilcoxon" class="csl-entry" role="listitem">
<div class="csl-left-margin">3. </div><div class="csl-right-inline">Zar JH. Paired-Sample Hypotheses. Em: Biostatistical Analysis. Edinburgh: Pearson; 2014. p. 189–98. </div>
</div>
<div id="ref-karadimitriou2020kruskal" class="csl-entry" role="listitem">
<div class="csl-left-margin">4. </div><div class="csl-right-inline">Karadimitriou SM, Marshall E. Kruskal-Wallis in R [Internet]. Statistics Support for Students. Loughborough; Coventry Universities; 2020. Disponível em: <a href="https://www.statstutor.ac.uk/">https://www.statstutor.ac.uk/</a></div>
</div>
<div id="ref-zar2014kruskal" class="csl-entry" role="listitem">
<div class="csl-left-margin">5. </div><div class="csl-right-inline">Zar JH. Nonparametric Analysis of Variance. Em: Biostatistical Analysis. Edinburgh: Pearson; 2014. p. 226–30. </div>
</div>
<div id="ref-gopal2006table" class="csl-entry" role="listitem">
<div class="csl-left-margin">6. </div><div class="csl-right-inline">Kanji GK. The Kruskal–Wallis test. Em: 100 Statiscal Tests. 3rd Edition. London: Sage publications; 2006. p. 220. </div>
</div>
<div id="ref-tomczak2014need" class="csl-entry" role="listitem">
<div class="csl-left-margin">7. </div><div class="csl-right-inline">Tomczak M, Tomczak E. The need to report effect size estimates revisited. An overview of some recommended measures of effect size. Trends in sport sciences. 2014;1(21):19–25. </div>
</div>
<div id="ref-watson2021effectsize" class="csl-entry" role="listitem">
<div class="csl-left-margin">8. </div><div class="csl-right-inline">Watson P. Rules of thumb on magnitudes of effect sizes [Internet]. MRC Cognition and Brain Sciences Unit. Cambridge University; 2021. Disponível em: <a href="https://imaging.mrc-cbu.cam.ac.uk/statswiki/FAQ/effectSize">https://imaging.mrc-cbu.cam.ac.uk/statswiki/FAQ/effectSize</a></div>
</div>
<div id="ref-dunn1964multiple" class="csl-entry" role="listitem">
<div class="csl-left-margin">9. </div><div class="csl-right-inline">Dunn OJ. Multiple comparisons using rank sums. Technometrics. 1964;6(3):241–52. </div>
</div>
</div>
</section>
</section>
<section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes">
<hr>
<ol>
<li id="fn1"><p>O cálculo pode também ser realizado, usando a função <code>wilcox.test()</code> do pacote <code>stats</code>, incluído no R base.<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn2"><p>Para maiores detalhes consulte a ajuda da função.<a href="#fnref2" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copiada");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copiada");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./16-dadosCategoricos.html" class="pagination-link" aria-label="Análise de Dados Categóricos">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Análise de Dados Categóricos</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./18-epidemiologia.html" class="pagination-link" aria-label="Estatística em Epidemiologia">
        <span class="nav-page-text"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Estatística em Epidemiologia</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




</body></html>