<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="pt" xml:lang="pt"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.42">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>18&nbsp; Estatística em Epidemiologia – Bioestatística Usando o R</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./references.html" rel="next">
<link href="./17-testes-naoParametricos.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-2f5df379a58b258e96c21c0638c20c03.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-8da5b4427184b79ecddefad3d342027e.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "Nenhum resultado",
    "search-matching-documents-text": "documentos correspondentes",
    "search-copy-link-title": "Copiar link para a busca",
    "search-hide-matches-text": "Esconder correspondências adicionais",
    "search-more-match-text": "mais correspondência neste documento",
    "search-more-matches-text": "mais correspondências neste documento",
    "search-clear-button-title": "Limpar",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancelar",
    "search-submit-button-title": "Enviar",
    "search-label": "Procurar"
  }
}</script>
<link href="site_libs/tabwid-1.1.3/tabwid.css" rel="stylesheet">

<script src="site_libs/tabwid-1.1.3/tabwid.js"></script>


  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="style.css">
</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Alternar barra lateral" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./18-epidemiologia.html"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Estatística em Epidemiologia</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Alternar barra lateral" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Procurar" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Bioestatística Usando o R</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Procurar"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Prefácio</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introdução</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02-dados.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Natureza dos Dados</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./03-producaoDados.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Produção dos Dados</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./04-ambienteR.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Ambiente do <em>R</em></span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./05-manipulandoDados.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Manipulando os dados no <em>RStudio</em></span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./06-descrevendoDados.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Descrevendo os dados</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./07-probabilidades.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Introdução à Teoria das Probabilidades</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./08-assimetria_curtose.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Assimetria e Curtose</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./09-distAmostrais.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Distribuições Amostrais</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./10-estimacao.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Estimação</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./11-testeHipoteses.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Teste de Hipóteses</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./12-teste-t.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Comparação entre duas médias</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./13-anova.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Análise de Variância</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./14-anovaRep.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">ANOVA de medidas repetidas</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./15-correlacao-regressao.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Correlação e Regressão</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./16-dadosCategoricos.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Análise de Dados Categóricos</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./17-testes-naoParametricos.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Métodos não paramétricos</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./18-epidemiologia.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Estatística em Epidemiologia</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Índice</h2>
   
  <ul>
  <li><a href="#pacotes-necessários" id="toc-pacotes-necessários" class="nav-link active" data-scroll-target="#pacotes-necessários"><span class="header-section-number">18.1</span> Pacotes necessários</a></li>
  <li><a href="#sec-diagbayes" id="toc-sec-diagbayes" class="nav-link" data-scroll-target="#sec-diagbayes"><span class="header-section-number">18.2</span> Raciocínio bayesiano no diagnóstico médico</a>
  <ul class="collapse">
  <li><a href="#sensibilidade-e-especificidade" id="toc-sensibilidade-e-especificidade" class="nav-link" data-scroll-target="#sensibilidade-e-especificidade"><span class="header-section-number">18.2.1</span> Sensibilidade e Especificidade</a></li>
  <li><a href="#valor-preditivo" id="toc-valor-preditivo" class="nav-link" data-scroll-target="#valor-preditivo"><span class="header-section-number">18.2.2</span> Valor Preditivo</a></li>
  <li><a href="#razão-de-probabilidade" id="toc-razão-de-probabilidade" class="nav-link" data-scroll-target="#razão-de-probabilidade"><span class="header-section-number">18.2.3</span> Razão de Probabilidade</a></li>
  <li><a href="#sec-rocurve" id="toc-sec-rocurve" class="nav-link" data-scroll-target="#sec-rocurve"><span class="header-section-number">18.2.4</span> Curva ROC</a></li>
  </ul></li>
  <li><a href="#estatística-kappa" id="toc-estatística-kappa" class="nav-link" data-scroll-target="#estatística-kappa"><span class="header-section-number">18.3</span> Estatística <em>kappa</em></a>
  <ul class="collapse">
  <li><a href="#sec-exkappa" id="toc-sec-exkappa" class="nav-link" data-scroll-target="#sec-exkappa"><span class="header-section-number">18.3.1</span> Exemplo</a></li>
  </ul></li>
  <li><a href="#medidas-de-frequência" id="toc-medidas-de-frequência" class="nav-link" data-scroll-target="#medidas-de-frequência"><span class="header-section-number">18.4</span> Medidas de frequência</a>
  <ul class="collapse">
  <li><a href="#prevalência" id="toc-prevalência" class="nav-link" data-scroll-target="#prevalência"><span class="header-section-number">18.4.1</span> Prevalência</a></li>
  <li><a href="#incidência" id="toc-incidência" class="nav-link" data-scroll-target="#incidência"><span class="header-section-number">18.4.2</span> Incidência</a></li>
  <li><a href="#relação-entre-prevalência-e-incidência" id="toc-relação-entre-prevalência-e-incidência" class="nav-link" data-scroll-target="#relação-entre-prevalência-e-incidência"><span class="header-section-number">18.4.3</span> Relação entre prevalência e incidência</a></li>
  </ul></li>
  <li><a href="#medidas-de-associação" id="toc-medidas-de-associação" class="nav-link" data-scroll-target="#medidas-de-associação"><span class="header-section-number">18.5</span> Medidas de associação</a>
  <ul class="collapse">
  <li><a href="#sec-or" id="toc-sec-or" class="nav-link" data-scroll-target="#sec-or"><span class="header-section-number">18.5.1</span> <em>Odds Ratio</em></a></li>
  <li><a href="#sec-rr" id="toc-sec-rr" class="nav-link" data-scroll-target="#sec-rr"><span class="header-section-number">18.5.2</span> Risco Relativo</a></li>
  <li><a href="#odds-ratio-vs-risco-relativo" id="toc-odds-ratio-vs-risco-relativo" class="nav-link" data-scroll-target="#odds-ratio-vs-risco-relativo"><span class="header-section-number">18.5.3</span> <em>Odds Ratio</em> vs Risco Relativo</a></li>
  <li><a href="#razão-de-prevalência" id="toc-razão-de-prevalência" class="nav-link" data-scroll-target="#razão-de-prevalência"><span class="header-section-number">18.5.4</span> Razão de Prevalência</a></li>
  </ul></li>
  <li><a href="#medidas-de-impacto" id="toc-medidas-de-impacto" class="nav-link" data-scroll-target="#medidas-de-impacto"><span class="header-section-number">18.6</span> Medidas de impacto</a>
  <ul class="collapse">
  <li><a href="#risco-atribuível" id="toc-risco-atribuível" class="nav-link" data-scroll-target="#risco-atribuível"><span class="header-section-number">18.6.1</span> Risco Atribuível</a></li>
  <li><a href="#redução-relativa-do-risco" id="toc-redução-relativa-do-risco" class="nav-link" data-scroll-target="#redução-relativa-do-risco"><span class="header-section-number">18.6.2</span> Redução Relativa do Risco</a></li>
  <li><a href="#número-necessário-para-tratar" id="toc-número-necessário-para-tratar" class="nav-link" data-scroll-target="#número-necessário-para-tratar"><span class="header-section-number">18.6.3</span> Número Necessário para Tratar</a></li>
  <li><a href="#número-necessário-para-causar-dano" id="toc-número-necessário-para-causar-dano" class="nav-link" data-scroll-target="#número-necessário-para-causar-dano"><span class="header-section-number">18.6.4</span> Número Necessário para Causar Dano</a></li>
  </ul></li>
  <li><a href="#análise-de-sobrevida" id="toc-análise-de-sobrevida" class="nav-link" data-scroll-target="#análise-de-sobrevida"><span class="header-section-number">18.7</span> Análise de sobrevida</a>
  <ul class="collapse">
  <li><a href="#dados-censurados" id="toc-dados-censurados" class="nav-link" data-scroll-target="#dados-censurados"><span class="header-section-number">18.7.1</span> Dados Censurados</a></li>
  <li><a href="#método-de-kaplan-meier" id="toc-método-de-kaplan-meier" class="nav-link" data-scroll-target="#método-de-kaplan-meier"><span class="header-section-number">18.7.2</span> Método de Kaplan-Meier</a></li>
  <li><a href="#regressão-de-cox-ou-modelo-de-riscos-proporcionais" id="toc-regressão-de-cox-ou-modelo-de-riscos-proporcionais" class="nav-link" data-scroll-target="#regressão-de-cox-ou-modelo-de-riscos-proporcionais"><span class="header-section-number">18.7.3</span> Regressão de Cox ou Modelo de Riscos Proporcionais</a></li>
  </ul></li>
  <li><a href="#regressão-logística-binária" id="toc-regressão-logística-binária" class="nav-link" data-scroll-target="#regressão-logística-binária"><span class="header-section-number">18.8</span> Regressão logística binária</a>
  <ul class="collapse">
  <li><a href="#sec-logisticfunction" id="toc-sec-logisticfunction" class="nav-link" data-scroll-target="#sec-logisticfunction"><span class="header-section-number">18.8.1</span> Função Logistica</a></li>
  <li><a href="#pressupostos-da-regressão-logística" id="toc-pressupostos-da-regressão-logística" class="nav-link" data-scroll-target="#pressupostos-da-regressão-logística"><span class="header-section-number">18.8.2</span> Pressupostos da regressão logística</a></li>
  <li><a href="#dados-para-a-regressão-logística" id="toc-dados-para-a-regressão-logística" class="nav-link" data-scroll-target="#dados-para-a-regressão-logística"><span class="header-section-number">18.8.3</span> Dados para a regressão logística</a></li>
  <li><a href="#construção-do-modelo-de-regressão-logística" id="toc-construção-do-modelo-de-regressão-logística" class="nav-link" data-scroll-target="#construção-do-modelo-de-regressão-logística"><span class="header-section-number">18.8.4</span> Construção do Modelo de Regressão Logística</a></li>
  <li><a href="#avaliação-do-modelo-de-regressão-logística" id="toc-avaliação-do-modelo-de-regressão-logística" class="nav-link" data-scroll-target="#avaliação-do-modelo-de-regressão-logística"><span class="header-section-number">18.8.5</span> Avaliação do Modelo de Regressão Logística</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span id="sec-cap18" class="quarto-section-identifier"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Estatística em Epidemiologia</span></span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="pacotes-necessários" class="level2" data-number="18.1">
<h2 data-number="18.1" class="anchored" data-anchor-id="pacotes-necessários"><span class="header-section-number">18.1</span> Pacotes necessários</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(BiocManager,</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>               car,</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>               caret,</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>               DescTools,</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>               dplyr,</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>               epiR,</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>               epitools,</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>               flextable,</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>               ggeffects,</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>               ggplot2,</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>               ggpubr,</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>               ggsci,</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>               kableExtra,</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>               knitr,</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a>               limma,</span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a>               mice,</span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a>               MKmisc,</span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a>               performance,</span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a>               pROC,</span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a>               readxl,</span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a>               sjPlot,</span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a>               survival,</span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a>               survminer,</span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a>               vcd)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="sec-diagbayes" class="level2" data-number="18.2">
<h2 data-number="18.2" class="anchored" data-anchor-id="sec-diagbayes"><span class="header-section-number">18.2</span> Raciocínio bayesiano no diagnóstico médico</h2>
<p>O processo diagnóstico é o centro da atenção da atividade médica na busca de reduzir as incertezas e reconhecer a que classe pertence determinado paciente. Portanto, é extremamente importante saber quão bem os testes diagnósticos podem prever que um indivíduo é portador de certa condição ou doença. Entende-se aqui como teste diagnóstico todo o processo diagnótico, desde o exame clínico até o mais sofisticado exame de imagem ou laboratorial. A ideia é saber como o teste diagnóstico se comporta para separar um “doente” e um “não doente”; qual a sua validade neste processo?</p>
<p>Deve-se sempre ter em mente que o estabelecimento do diagnóstico é um processo imperfeito que resulta em uma probabilidade ao invés de uma certeza de estar correto. Ou seja, cada vez mais os médicos têm que aplicar as leis da probabilidade na avaliação de testes diagnósticos e sinais clínicos.</p>
<p>A abordagem bayesiana denomina de <strong>probabilidade a priori</strong> a probabilidade estabelecida inicialmente, baseada apenas na experiência do médico, em seu conhecimento em relação a doença suspeitada. Diante de uma evidência de doença, pode ser solictado um teste diagnóstico. Quando ele recebe um teste positivo para uma doença, a probabilidade muda, passa a ser uma probabilidade condicional, probabilidade da doença dado que o teste é positivo, denominada <strong>probabilidade a posteriori</strong>.</p>
<p>Um teste que define corretamente quem é doente e quem não é doente é denominado de <strong>padrão-ouro</strong> ou <strong>padrão de referência</strong>. Algumas vezes, o teste padrão de referência é simples e barato. Outras vezes, é caro, difícil de obter, tecnicamente complexo, arriscado ou pouco prático. Inclusive, pode não hver padrão-ouro. Em função dessas limitações, outros testes são usados e, como consequência, podem ocorrer erros. Em outras palavras, no processo diagnóstico podem ocorrer <strong>falsos positivos</strong> e <strong>falsos negativos</strong>.<br>
Esta incerteza, na utilização de testes diagnósticos, gera a necessidade de o médico conferir a probabilidade de falsos positivos e falsos negativos na elaboração de um diagnóstico ao receber o resultado positivo ou negativo de um exame. Uma maneira simples de mostrar as relações de um teste diagnóstico e o verdadeiro diagnóstico, é mostrada na tabela de contingência <span class="math inline">\(2\times2\)</span> (<a href="#tbl-fpfn" class="quarto-xref">Tabela&nbsp;<span>18.1</span></a>).</p>
<div class="cell" data-layout-align="center">
<div id="tbl-fpfn" class="cell quarto-float quarto-figure quarto-figure-center anchored" data-layout-align="center">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-fpfn-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Tabela&nbsp;18.1: Falsos positivos e falsos negativos
</figcaption>
<div aria-describedby="tbl-fpfn-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://i.imgur.com/udFZ2ek.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:70.0%"></p>
</figure>
</div>
</div>
</div>
</figure>
</div>
</div>
<section id="sensibilidade-e-especificidade" class="level3" data-number="18.2.1">
<h3 data-number="18.2.1" class="anchored" data-anchor-id="sensibilidade-e-especificidade"><span class="header-section-number">18.2.1</span> Sensibilidade e Especificidade</h3>
<p>As estatísticas mais utilizadas para descrever a validade dos testes de diagnóstico em contextos clínicos são sensibilidade e a especificidade.</p>
<p><strong>Sensibilidade</strong> é a habilidade do teste em identificar corretamente quem tem a doença. É a taxa de verdadeiros positivos (VP) de um teste e corresponde a probabilidade de um indivíduo com a doença ter um teste positivo.</p>
<p>Um teste sensível raramente deixará passar pessoas que tenham a doença. Testes com sensibilidade alta são úteis para <em>excluir</em> a presença de uma doença. Isto é, um teste negativo exclui virtualmente a possibilidade de o paciente ter a doença de interesse, pois tem pouca probabilidade de produzir resultados falsos negativos. Isto pode ser lembrado pelo mnemônico <em>SnNout</em>, do inglês: <em>High Sensivity, a Negative result rules out the diagnosis</em> <span class="citation" data-cites="straus2019screening">(<a href="references.html#ref-straus2019screening" role="doc-biblioref">1</a>)</span>.</p>
<p><strong>Especificidade</strong> é a habilidade do teste em identificar corretamente quem não tem a doença. É a taxa de verdadeiros negativos (VN) de um teste e corresponde a probabilidade de um indivíduo sem a doença ter um teste negativo. Um teste específico raramente classificará de forma errônea indivíduos sendo portadores da doença quando eles não são. Os testes muito específicos são usados para <em>confirmar</em> a presença da doença. Se o teste é altamente específico, um teste positivo sugere fortemente a presença da doença de interesse.</p>
<p>De forma similar que a sensibilidade pode-se usar o mnemônico <em>SpPin</em>, do inglês: <em>High Specificity, a Positive result rules in the diagnosis</em> <span class="citation" data-cites="straus2019screening">(<a href="references.html#ref-straus2019screening" role="doc-biblioref">1</a>)</span>.</p>
<p>Estas estatísticas de diagnóstico podem ser calculadas a partir das equações, cujas letras representam as caselas da tabela <span class="math inline">\(2 \times 2\)</span> da <a href="#tbl-fpfn" class="quarto-xref">Tabela&nbsp;<span>18.1</span></a>;</p>
<p><span class="math display">\[
Sensibilidade = \frac {a}{\left (a + c\right )} \quad \quad Especificidade = \frac {d}{\left (b + d\right )}
\]</span></p>
<p>A <strong>taxa de falsos negativos</strong> (TFN) é a proporção de indivíduos que têm a doença e que têm um resultado de teste negativo e a <strong>taxa de falsos positivos</strong> (TFP) é a proporção de pacientes que não possuem a doença e que apresentam resultados positivos. Podem ser expressas pelas equações:</p>
<p><span class="math display">\[
TFN= \frac {c}{\left (a + c\right )} \quad ou \quad \left (1 - sensibilidade\right)
\]</span></p>
<p><span class="math display">\[
TFP= \frac {b}{\left (b + d\right )} \quad ou \quad \left (1 - especifcidade\right)
\]</span></p>
<p>Idealmente, um teste de diagnóstico deveria ter altos níveis de sensibilidade e especificidade. No entanto, isso não é possível, pois existe um balanço entre sensibilidade e especificidade. À medida que a especificidade aumenta, a sensibilidade diminui e vice-versa. As curvas ROC podem ser usadas para identificar um ponto de corte em uma medição contínua que maximize a sensibilidade e a especificidade (veja a <a href="#sec-rocurve" class="quarto-xref"><span>Seção 18.2.4</span></a>).</p>
<p>Quando um clínico tem um paciente cujo teste apresentou resultado positivo, a pergunta mais importante é a seguinte: dado que o teste é positivo, qual é a probabilidade de o paciente ter a doença? A sensibilidade do teste não responde a este questionamento, mas sim a probabilidade de um resultado positivo, dado que o paciente tem a doença <span class="citation" data-cites="altman1994diagnostic">(<a href="references.html#ref-altman1994diagnostic" role="doc-biblioref">2</a>)</span>.</p>
<section id="sec-exapendicite" class="level4" data-number="18.2.1.1">
<h4 data-number="18.2.1.1" class="anchored" data-anchor-id="sec-exapendicite"><span class="header-section-number">18.2.1.1</span> Exemplo</h4>
<p>O conjunto de dados <code>dadosApendicite.xlsx</code> contém informações de 156 pacientes que realizaram ultrassonografia abdominal para o diagnóstico de apendicite aguda.Para obter arquivo, clique <a href="https://github.com/petronioliveira/Arquivos/blob/main/dadosApendicite.xlsx"><strong>aqui</strong></a> e salve o mesmo em seu diretório de trabalho.</p>
<p>Foram avaliados pacientes com diagnóstico clínico de apendicite aguda, submetidos à ultrassonografia abdominal e apendicectomia laparoscópica, acompanhado de estudo anatomopatológico dos apêndices extirpados <span class="citation" data-cites="peixoto2011indices">(<a href="references.html#ref-peixoto2011indices" role="doc-biblioref">3</a>)</span>. Será avaliado o teste diagnóstico usado.</p>
<p><u>Leitura e observação do conjunto de dados</u></p>
<p>Será usado a função <code>read_excel()</code>do pacote <code>readxl</code> para ler os dados e a função <code>str()</code> para observar a sua estrutura:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>dados <span class="ot">&lt;-</span> readxl<span class="sc">::</span><span class="fu">read_excel</span> (<span class="st">"dados/dadosApendicite.xlsx"</span>)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(dados)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>tibble [156 × 3] (S3: tbl_df/tbl/data.frame)
 $ id        : num [1:156] 1 2 3 4 5 6 7 8 9 10 ...
 $ apendicite: num [1:156] 1 1 1 1 1 1 1 1 1 1 ...
 $ eco       : num [1:156] 1 1 1 1 1 1 1 1 1 1 ...</code></pre>
</div>
</div>
<p>As variáveis <code>apendicite</code> e <code>eco</code> foram exibidas como variáveis numéricas e serão transformadas em fatores:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>dados<span class="sc">$</span>apendicite <span class="ot">&lt;-</span> <span class="fu">factor</span>(dados<span class="sc">$</span>apendicite,</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>                           <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>),</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>                           <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Presente"</span>, </span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>                                      <span class="st">"Ausente"</span>))</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>dados<span class="sc">$</span>eco <span class="ot">&lt;-</span> <span class="fu">factor</span>(dados<span class="sc">$</span>eco,</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>                    <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>),</span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>                    <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Positivo"</span>, </span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>                               <span class="st">"Negativo"</span>))</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><u>Construção de uma tabela de contingência 2$$2</u></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>tab_ap <span class="ot">&lt;-</span> <span class="fu">with</span>(dados, <span class="fu">table</span>(eco, apendicite, <span class="at">dnn =</span> <span class="fu">c</span> (<span class="st">"Eco"</span>, <span class="st">"Apendicite"</span>)))</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="fu">addmargins</span>(tab_ap, <span class="at">FUN =</span> sum)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Margins computed over dimensions
in the following order:
1: Eco
2: Apendicite</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>          Apendicite
Eco        Presente Ausente sum
  Positivo       85       7  92
  Negativo       46      18  64
  sum           131      25 156</code></pre>
</div>
</div>
<p><u>Cálculo da sensibilidade e da especificidade</u></p>
<p>Pode-se usar a função <code>epi.tests()</code> do pacote <code>epiR</code> <span class="citation" data-cites="stevenson2022epir">(<a href="references.html#ref-stevenson2022epir" role="doc-biblioref">4</a>)</span> que calcula, junto com os intervalos de confiança exatos, a prevalência aparente e verdadeira, sensibilidade, especificidade, valores preditivos positivos e negativos e razões de probabilidade positivas e negativas a partir de dados de contagem fornecidos em uma tabela <span class="math inline">\(2\times2\)</span>. Utiliza os argumentos</p>
<ul>
<li><strong>dat</strong> &nbsp;&nbsp;dados sob a forma de vetor ou matriz<br>
</li>
<li><strong>conf.level</strong> &nbsp;&nbsp;magnitude do intervalode confiança, entre 0 e 1.</li>
</ul>
<p>Os resultados serão atribuídos a um objeto de nome <code>diag</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>diag <span class="ot">&lt;-</span> epiR<span class="sc">::</span><span class="fu">epi.tests</span>(tab_ap, </span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>                        <span class="at">conf.level =</span> <span class="fl">0.95</span>)</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(diag)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>          Outcome +    Outcome -      Total
Test +           85            7         92
Test -           46           18         64
Total           131           25        156

Point estimates and 95% CIs:
--------------------------------------------------------------
Apparent prevalence *                  0.59 (0.51, 0.67)
True prevalence *                      0.84 (0.77, 0.89)
Sensitivity *                          0.65 (0.56, 0.73)
Specificity *                          0.72 (0.51, 0.88)
Positive predictive value *            0.92 (0.85, 0.97)
Negative predictive value *            0.28 (0.18, 0.41)
Positive likelihood ratio              2.32 (1.22, 4.40)
Negative likelihood ratio              0.49 (0.35, 0.68)
False T+ proportion for true D- *      0.28 (0.12, 0.49)
False T- proportion for true D+ *      0.35 (0.27, 0.44)
False T+ proportion for T+ *           0.08 (0.03, 0.15)
False T- proportion for T- *           0.72 (0.59, 0.82)
Correctly classified proportion *      0.66 (0.58, 0.73)
--------------------------------------------------------------
* Exact CIs</code></pre>
</div>
</div>
<p>Assim, a sensibilidade é igual a 65% (IC95%: 56 – 73%) e a especificidade é igual a 72% (IC95%: 51 – 88%). Isto significa que um indivíduo com apendicite aguda tem 65% de probabilidade de ter uma ecografia alterada; um indivíduo sem apendicite aguda tem 72% de probabilidade de ter uma ecografia normal. O objetivo do teste de diagnóstico é usá-lo para fazer um diagnóstico, então há necessidade de saber a probabilidade que o teste fornece para um diagnóstico correto. A sensibilidade e a especificidade não fornecem esta informação. Para atingir esse objetivo, usa-se o <strong>valor preditivo</strong> <span class="citation" data-cites="altman1994predictive">(<a href="references.html#ref-altman1994predictive" role="doc-biblioref">5</a>)</span>.</p>
</section>
</section>
<section id="valor-preditivo" class="level3" data-number="18.2.2">
<h3 data-number="18.2.2" class="anchored" data-anchor-id="valor-preditivo"><span class="header-section-number">18.2.2</span> Valor Preditivo</h3>
<p>O propósito de um teste diagnóstico é usar seus resultados para fazer um diagnóstico, portanto, é necessário conhecer a probabilidade de que o resultado do teste forneça o diagnóstico correto <span class="citation" data-cites="altman1994predictive">(<a href="references.html#ref-altman1994predictive" role="doc-biblioref">5</a>)</span>.</p>
<p>Os valores preditivos positivo e negativo descrevem a probabilidade de um paciente ter doença, uma vez que os resultados de seus testes são conhecidos.</p>
<p>O <strong>valor preditivo positivo</strong> (VPP) de um teste é definido como a proporção de pessoas com um resultado de teste positivo que realmente têm a doença.</p>
<p>O <strong>valor preditivo negativo</strong> (VPN) é a proporção de pacientes com resultados de teste negativos que não têm doença.</p>
<p>Como a sensibilidade e a especificidade, estas estatísticas de diagnóstico também podem ser calculadas a partir da tabela <span class="math inline">\(2\times2\)</span>, mostrada no início:</p>
<p><span class="math display">\[
VPP = \frac {a}{\left (a + b\right )} \quad \quad VPN = \frac {d}{\left (c + d\right )}
\]</span></p>
<p>Observando os resultados anteriores da função <code>epi.tests()</code>, verifica-se que 92% (85/92) dos indivíduos que tiveram teste positivo (ultrassonografia alterada) tinham doença (apendicite aguda). Isso significa que seu VPP é igual a 92% (IC95%: 18 – 41%), ou dito de outra forma, uma pessoa com ultrassonografia positiva tem 92% de probabilidade de ter a apendicite aguda. O VPP é também conhecido como <strong>probabilidade pós-teste</strong> de doença dado um teste positivo.</p>
<p>Dos 64 pacientes que tiveram ultrassonografia sem alterações, 18 não apresentaram apendicite aguda, portanto, um VPN de 28% (IC95%: 56 – 73%). Isso significa que uma pessoa quem tem um teste negativo tem 28,1% de probabilidade de não ter apendicite aguda.</p>
<p>Entretanto, essas proporções são de validade limitada. Os valores preditivos de um teste, na prática clínica, dependem criticamente da prevalência da anormalidade nos pacientes testados. No estudo, a prevalência de apendicite aguda é igual a</p>
<p><span class="math display">\[
\frac {total\ de\ casos\ de \ apendicite \ aguda}{total\ de\ casos\ no\ estudo} = \frac {131}{156} = 0,84\ ou\ 84\% \left(IC_{95\%}:77\ a\ 89\%\right)
\]</span></p>
<p>Levando-se em consideração que a prevalência de apendicite aguda na população é de 7% <span class="citation" data-cites="lima2016perfil">(<a href="references.html#ref-lima2016perfil" role="doc-biblioref">6</a>)</span>, mantendo a sensibilidade (64%) e a especificidade (72%) da ultrassonografia, entre 156 pacientes, selecionados aleatoriamente, se esperaria encontrar aproximadamente 11 casos (7% de 156) de apendicite aguda. Para facilitar a compreensão, observe a a tabela <span class="math inline">\(2\times2\)</span> (<a href="#tbl-vpp" class="quarto-xref">Tabela&nbsp;<span>18.2</span></a>):</p>
<div class="cell" data-layout-align="center">
<div id="tbl-vpp" class="cell quarto-float quarto-figure quarto-figure-center anchored" data-layout-align="center">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-vpp-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Tabela&nbsp;18.2: Prevalencia e valor preditivo
</figcaption>
<div aria-describedby="tbl-vpp-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://i.imgur.com/s0tdwod.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:70.0%"></p>
</figure>
</div>
</div>
</div>
</figure>
</div>
</div>
<p>O VPP e o VPN são iguais a:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="dv">7</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="dv">41</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>c <span class="ot">&lt;-</span> <span class="dv">4</span></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="dv">104</span></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>vpp <span class="ot">=</span> a<span class="sc">/</span>(a <span class="sc">+</span> b)</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(vpp, <span class="dv">3</span>)<span class="sc">*</span><span class="dv">100</span></span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 14.6</code></pre>
</div>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>vpn <span class="ot">=</span> d<span class="sc">/</span>(c <span class="sc">+</span> d)</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(vpn, <span class="dv">3</span>)<span class="sc">*</span><span class="dv">100</span></span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 96.3</code></pre>
</div>
</div>
<p>Ao se comparar o VPP obtido, agora, com o VPP do estudo, observa-se que o mesmo diminuiu bastante, de 92% para 14,6%. O contrário ocorre com a VPN que aumenta substancialmente de 28% para 96,3%, mostrando claramente a influência da prevalência.</p>
<p>Se a prevalência diminui, o VPP diminui e o VPN aumenta. Portanto, será errado aplicar diretamente os valores preditivos publicados de um teste ao seu pacciente, quando a prevalência da doença em sua população for diferente da prevalência da doença na população em que o estudo publicado foi realizado. Um teste pode ser útil em um lugar e não ter validade em outro onde a prevalência é muito baixa.</p>
<p>Pode-se chegar aos mesmos resultados, usando as equações:</p>
<p><span class="math display">\[
VPP =\frac{sens \times prev}{\left(sens \times prev\right) + \left [\left (1- espec\right) \times \left (1- prev\right)\right ]}
\]</span></p>
<p><span class="math display">\[
VPN =\frac{espec\times \left (1- prev\right)}{\left[\left (1 - sens \right)\times prev\right]+\left[espec\times \left (1 - prev\right)\right]}
\]</span></p>
<p>A prevalência pode ser interpretada como a probabilidade antes da realização do teste, conhecida como <em>probabilidade pré-teste</em>. A diferença entre as probabilidades pré e pós-teste é uma forma de avaliar a utilidade do teste. Esta diferença pode ser mensurada pela <strong>razão de probabilidade</strong> (<strong>likelihood ratio</strong>).</p>
</section>
<section id="razão-de-probabilidade" class="level3" data-number="18.2.3">
<h3 data-number="18.2.3" class="anchored" data-anchor-id="razão-de-probabilidade"><span class="header-section-number">18.2.3</span> Razão de Probabilidade</h3>
<p>A <strong>Razão de Probabilidades</strong> (<em>likelihood ratio</em>) é uma forma alternativa de descrever o desempenho de um teste diagnóstico. Alguns autores a denominam de razão de verossimilhança <a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a>.</p>
<p>A razão de probabilidades para um resultado de teste é definida como a razão entre a probabilidade de observar aquele resultado em indivíduos com a doença em questão e a probabilidade desse resultado em indivíduos sem a doença <span class="citation" data-cites="halkin1998likelihood">(<a href="references.html#ref-halkin1998likelihood" role="doc-biblioref">7</a>)</span>.</p>
<p>Razões de probabilidade são, clinicamente, mais úteis do que sensibilidade e especificidade. Fornecem um resumo de quantas vezes mais (ou menos) a probabilidade de os indivíduos com a doença apresentarem aquele resultado específico do que os indivíduos sem a doença, e também podem ser usados para calcular a probabilidade de doença para pacientes individuais <span class="citation" data-cites="deeks2004likelihood">(<a href="references.html#ref-deeks2004likelihood" role="doc-biblioref">8</a>)</span>. Cada vez mais as razões de probabilidade estão se tornando populares para relatar a utilidade dos testes de diagnóstico.</p>
<p>Quando os resultados do teste são relatados como sendo positivos ou negativos, dois tipos de razões de probabilidades podem ser descritos, a razão de probabilidades para um teste positivo (denotada LR +) e a razão de probabilidades para um teste negativo (denotada LR−).</p>
<p>A <em>razão de probabilidades para um teste positivo</em> é definida como a probabilidade de um indivíduo com doença ter um teste positivo dividida pela probabilidade de um indivíduo sem doença ter um teste positivo. A fórmula para calcular LR + é</p>
<p>Ou seja,</p>
<p><span class="math display">\[
LR(+)=\frac{sensibilidade}{1 - especificidade}
\]</span></p>
<p>Razão de probabilidades positiva maior que 1 significa que um teste positivo tem mais probabilidade de ocorrer em pessoas com a doença do que em pessoas sem a doença. De um modo geral, para os indivíduos que apresentam um resultado positivo, LR (+) &gt; 10 aumenta significativamente a probabilidade de doença (“confirma” a doença), enquanto LR (+) &lt; 0,1, virtualmente, exclui a probabilidade de uma pessoa ter a doença <span class="citation" data-cites="guyatt2015diagnostic">(<a href="references.html#ref-guyatt2015diagnostic" role="doc-biblioref">9</a>)</span>.</p>
<p>Usando os dados incluídos no objeto <code>diag</code>, obtido com a função <code>epi.tests()</code> do pacote <code>epiR</code>, tem-se que a LR (+) da ultrassonografia para o diagnóstico de apendicite aguda é igual 2.32 (IC95%: 1,22 – 4,40). Significa que uma pessoa com apendicite aguda tem cerca de 2,32 vezes mais probabilidade de ter um teste positivo do que uma pessoa que não tem a doença.</p>
<p>A <em>razão de probabilidade negativa</em> é definida como a probabilidade de um indivíduo com doença ter um teste negativo dividido pela probabilidade de um indivíduo sem doença ter um teste negativo. A fórmula para calcular a LR− é:</p>
<p>Ou seja,</p>
<p><span class="math display">\[
LR(-)=\frac{sensibilidade}{1-especificidade}
\]</span></p>
<p>Razão de probabilidade negativa menor que 1 significa que um teste negativo é menos provável de ocorrer em pessoas com a doença do que em pessoas sem a doença. Um LR muito baixo (abaixo de 0,1) praticamente exclui a chance de que uma pessoa tenha a doença <span class="citation" data-cites="guyatt2015diagnostic">(<a href="references.html#ref-guyatt2015diagnostic" role="doc-biblioref">9</a>)</span>.</p>
<p>Voltando aos dados anteriores, a LR (-) para a ultrassonografia é igual a 0.49 (IC95%: 0.35 - 0.68). Significa que a probabilidade de ter um teste negativo para indivíduos com doença é 0,49 vezes ou cerca de metade daqueles sem a doença. Dito de outra forma, os indivíduos sem a doença têm cerca o dobro probabilidade de ter um teste negativo do que os indivíduos com a doença.</p>
<section id="estimando-a-probabilidade-de-doença" class="level4" data-number="18.2.3.1">
<h4 data-number="18.2.3.1" class="anchored" data-anchor-id="estimando-a-probabilidade-de-doença"><span class="header-section-number">18.2.3.1</span> Estimando a probabilidade de doença</h4>
<p>Uma grande vantagem das razões de probabilidade é que elas podem ser usadas para ajudar o médico a adaptar a sensibilidade e a especificidade dos testes aos pacientes individuais. Ao se atender um paciente em uma clínica, pode-se decidir realizar um teste específico, após uma anamnese e um exame físico. A decisão de fazer o teste baseia-se nos sintomas e sinais do paciente e na experiência pessoal. Existe suspeita de um determinado diagnóstico e o objetivo é excluir ou confirmar esse diagnóstico. Antes de solicitar o teste, geralmente existe uma estimativa aproximada da probabilidade do paciente de ter essa doença, conhecida como <strong>probabilidade pré-teste</strong> ou <strong>a priori</strong>, que geralmente é estimada com base na experiência pessoal do médico, dados de prevalência local e publicações científicas.</p>
<p>A razão mais importante pela qual um teste é realizado é tentar modificar a probabilidade de doença. Um teste positivo pode aumentar a probabilidade pós-teste e um teste negativo pode reduzir essa probabilidade. A probabilidade pós-teste de doença é o que mais interessa aos médicos e pacientes, pois isso pode ajudar a decidir se devem confirmar, descartar um diagnóstico ou realizar outros testes.</p>
<p>Os resultados dos testes clínicos são geralmente usados não para fazer ou excluir categoricamente um diagnóstico, mas para modificar a probabilidade do pré-teste a fim de gerar a probabilidade do pós-teste. O teorema de Bayes é uma relação matemática que permite estimar a probabilidade pós-teste.</p>
<p>Para se compreender este conceito, é importante entender a diferença entre <strong>probabilidade</strong> e <strong>odds</strong> <span class="citation" data-cites="oliveira2022diagnostico">(<a href="references.html#ref-oliveira2022diagnostico" role="doc-biblioref">10</a>)</span>.</p>
<p><strong>Probabilidade</strong> é a proporção de pessoas que apresentam uma determinada característica (teste positivo, sinal clínico).<br>
<strong>Odds</strong> (chance) representa a razão entre duas características complementares, ou seja, a probabilidade de um evento dividido pela probabilidade do não evento (1 – evento). Ambos contêm as mesmas informações de maneiras diferentes. Por exemplo, usando os dados da tabela <code>tab_ap</code> (veja <a href="#sec-exapendicite" class="quarto-xref"><span>Seção 18.2.1.1</span></a>), verifica-se que a probabilidade (<em>p</em>) de uma ultrassonografia positiva para apendicite aguda é igual</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>a <span class="ot">&lt;-</span> tab_ap[<span class="dv">1</span>,<span class="dv">1</span>]</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>b <span class="ot">&lt;-</span> tab_ap[<span class="dv">1</span>,<span class="dv">2</span>]</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>c <span class="ot">&lt;-</span> tab_ap[<span class="dv">2</span>,<span class="dv">1</span>]</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> tab_ap[<span class="dv">2</span>,<span class="dv">2</span>]</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> (a <span class="sc">+</span> b)<span class="sc">/</span>(a <span class="sc">+</span> b <span class="sc">+</span> c <span class="sc">+</span> d)</span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>p</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.5897436</code></pre>
</div>
</div>
<p>e que o <em>odds</em> da ultrassonografia positiva<a href="#fn2" class="footnote-ref" id="fnref2" role="doc-noteref"><sup>2</sup></a> é</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a> odds <span class="ot">&lt;-</span> (a <span class="sc">+</span> b)<span class="sc">/</span>(c <span class="sc">+</span> d) </span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a> odds</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1.4375</code></pre>
</div>
</div>
<p>Para transformar a <em>odds</em> em probabilidades e vice-versa, procede-se da seguinte maneira:</p>
<p><span class="math display">\[
p=\frac{odds}{1+odds}
\]</span></p>
<p>Voltando ao exemplo (<a href="#sec-exapendicite" class="quarto-xref"><span>Seção 18.2.1.1</span></a>):</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>p <span class="ot">=</span> odds<span class="sc">/</span>(<span class="dv">1</span> <span class="sc">+</span> odds)</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>p</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.5897436</code></pre>
</div>
</div>
<p>e</p>
<p><span class="math display">\[
odds=\frac{p}{1-p}
\]</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>odds <span class="ot">=</span> p<span class="sc">/</span>(<span class="dv">1</span><span class="sc">-</span>p)</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>odds</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1.4375</code></pre>
</div>
</div>
<p>Pelo teorema de Bayes, sabendo-se a <em>probabilidade a priori</em> ou <em>probabilidade pré-teste</em>, é possível obter a <em>probabilidade pós-teste</em> ou <em>a posteriori</em>, usando a razão de probabilidades.</p>
<p>Para atingir este objetivo, basta, inicialmente, multiplicar o <em>odds pré-teste</em> pela razão de probabilidades:</p>
<p><span class="math display">\[
odds_{pos} = odds_{pre \quad \times \quad LR}
\]</span></p>
<p>Após, para encontrar a probabilidade pós-teste, basta converter o <em>odds</em> pós-teste em probabilidade:</p>
<p><span class="math display">\[
p_{pos} = \frac{odds_{pos}}{1-odds_{pos}}
\]</span></p>
<p>No exemplo (<a href="#sec-exapendicite" class="quarto-xref"><span>Seção 18.2.1.1</span></a>), foi verificado que o LR (+) é igual a 2,32 e a prevalência de apendicite aguda é em torno de 7% pode-se prever a probabilidade de haver apendicite aguda, diante de uma ultrassonografia alterada:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>prev <span class="ot">&lt;-</span>  <span class="fl">0.07</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>LR <span class="ot">&lt;-</span>  <span class="fl">2.32</span></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>odds_pre <span class="ot">&lt;-</span>  <span class="fl">0.07</span><span class="sc">/</span>(<span class="dv">1</span> <span class="sc">-</span><span class="fl">0.07</span>)</span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>odds_pos <span class="ot">&lt;-</span> odds_pre <span class="sc">*</span> LR</span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a>p_pos <span class="ot">&lt;-</span> odds_pos<span class="sc">/</span>(odds_pos <span class="sc">+</span><span class="dv">1</span>)</span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(p_pos, <span class="dv">3</span>)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.149</code></pre>
</div>
</div>
<p>Ou, em outras palavras, diante de um teste positivo, a probabilidade de o paciente ter apendicite aguda passa de 7% antes do teste para praticamente 15%!</p>
<p>Estes cálculos podem ser simplificados, utilizando o nomograma de Fagan <span class="citation" data-cites="fagan1975nomogram">(<a href="references.html#ref-fagan1975nomogram" role="doc-biblioref">11</a>)</span>, extremamente fácil de se usar <span class="citation" data-cites="caraguel2013fagan">(<a href="references.html#ref-caraguel2013fagan" role="doc-biblioref">12</a>)</span>, pois basta unir a probabilidade pré-teste ao LR que a reta apontará para a probabilidade pós-teste (<a href="#fig-fagan" class="quarto-xref">Figura&nbsp;<span>18.1</span></a>)).</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-fagan" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" data-fig-pos="ht">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-fagan-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="https://i.imgur.com/Qyvlj5q.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:60.0%" data-fig-pos="ht">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-fagan-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figura&nbsp;18.1: Nomograma de Fagan
</figcaption>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="sec-rocurve" class="level3" data-number="18.2.4">
<h3 data-number="18.2.4" class="anchored" data-anchor-id="sec-rocurve"><span class="header-section-number">18.2.4</span> Curva ROC</h3>
<p>Nem sempre o resultado de um teste é dicotômico (positivo/negativo). Com frequência, trabalha-se com variáveis contínuas (pressão arterial, glicemia, dosagem do sódio, dosagens hormonais, etc.). Neste caso, não há um resultado “positivo” ou “negativo”. Um “ponto de corte” precisa ser criado, para definir quem será considerado positivo ou negativo.</p>
<p>A escolha do ponto de corte depende das consequências de um resultado falso positivo ou de um falso negativo. Falsos positivos estão associados com custos (emocional ou financeiro) e com a dificuldade de “desrotular” alguém que recebeu o rótulo de “positivo”. Resultados falsos negativos podem “tranquilizar” pessoas doentes que não são seguidas ou tratadas precocemente.</p>
<p>A distribuição dos níveis glicêmicos em diabéticos e não diabéticos não tem um ponto de corte bem nítido. As duas populações se sobrepõem (<a href="#fig-diabetes" class="quarto-xref">Figura&nbsp;<span>18.2</span></a>)), gerando falso positivos ou falso negativos, dependendo do ponto de corte escolhido <span class="citation" data-cites="oliveira2022diagnostico">(<a href="references.html#ref-oliveira2022diagnostico" role="doc-biblioref">10</a>)</span>.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-diabetes" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" data-fig-pos="ht">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-diabetes-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="18-epidemiologia_files/figure-html/fig-diabetes-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:80.0%" data-fig-pos="ht">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-diabetes-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figura&nbsp;18.2: Populações de indivíduos normais (curva em azul) e diabéticos (curva em vermelho)
</figcaption>
</figure>
</div>
</div>
</div>
<p>Suponha que ao se examinar uma população fosse escolhido o ponto de corte de 80mg/dL, haveria um aumento no número de indivíduos com teste positivo com uma taxa de falsos positivos elevada, diminuindo a especificidade do teste. Se, por outro lado, o ponto de corte fosse elevado para 200mg/dL, o número de falsos negativos teria um grande aumento, reduzindo a sensibilidade. Esta oscilação entre a sensibilidade e a especificidade ocorre pelo fato de a localização do ponto de corte ser uma decisão arbitrária num contínuo entre o normal e anormal.</p>
<p>Ao se escolher um ponto de corte deve-se fazer um balanço entre a sensibilidade e a especificidade, levando em conta as consequências da escolha. Por exemplo, a triagem para fenilcetonúria em recém-nascidos valoriza a sensibilidade em vez de especificidade; o custo da perda de um caso é alto, pois existe tratamento eficaz. Uma desvantagem é que ocorre um grande número de testes falso positivos que causam angústia e a realização de mais testes.</p>
<p>Em contraste, a triagem para o câncer de mama deve favorecer a especificidade sobre a sensibilidade, uma vez que uma avaliação mais aprofundada daquelas com teste positivo, implica em biopsias dispendiosas e invasivas.</p>
<p>As <strong>curvas ROC</strong> (<em>Receiver Operating Characteristic</em>) são uma ferramenta inestimável para encontrar o ponto de corte em uma medida com distribuição contínua que melhor prediz se uma condição está presente, por exemplo, se pacientes são positivos ou negativos para a presença de uma doença <span class="citation" data-cites="altman1994roc">(<a href="references.html#ref-altman1994roc" role="doc-biblioref">13</a>)</span>. As curvas ROC são usadas para encontrar um ponto de corte que separa um resultado de teste “normal” de um “anormal” quando o resultado do teste é uma medida contínua. As curvas ROC são traçadas calculando a sensibilidade e a especificidade do teste na predição do diagnóstico para cada valor da medida. A curva permite determinar um ponto de corte para a medição que maximiza a taxa de verdadeiros positivos (sensibilidade) e minimiza a taxa de falsos positivos (1 – especificidade) e, portanto, maximiza a razão de probabilidades (<em>likelihood ratio</em>).</p>
<section id="sec-exdadosTestes" class="level4" data-number="18.2.4.1">
<h4 data-number="18.2.4.1" class="anchored" data-anchor-id="sec-exdadosTestes"><span class="header-section-number">18.2.4.1</span> Exemplo</h4>
<p>O conjunto de dados <code>dadosTestes.xlsx</code> contém informações para os resultados hipotéticos de três testes bioquímicos diferentes e uma variável (<code>doença</code>) que indica se foi confirmada a doença (<em>padrão-ouro</em>). Para obter arquivo, clique <a href="https://github.com/petronioliveira/Arquivos/blob/main/dadosTestes.xlsx"><strong>aqui</strong></a> e salve o mesmo em seu diretório de trabalho.</p>
<p><u>Leitura e observação dos dados</u></p>
<p>Como é um arquivo em Excel, a leitura será realizada pela função <code>read_excel()</code> do pacote <code>readxl</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>testes <span class="ot">&lt;-</span> readxl<span class="sc">::</span><span class="fu">read_excel</span>(<span class="st">"dados/dadosTestes.xlsx"</span>)</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(testes)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>tibble [145 × 5] (S3: tbl_df/tbl/data.frame)
 $ id    : num [1:145] 1 2 3 4 5 6 7 8 9 10 ...
 $ teste1: num [1:145] 25 2.2 46.2 9.9 46.5 36.1 34.8 44.9 36.9 7.1 ...
 $ teste2: num [1:145] 25 2.2 15.6 20.4 15.7 35.7 34.8 55.4 36.9 7.1 ...
 $ teste3: num [1:145] 15 2.2 25 20.4 15.7 36.1 24 55.4 36.9 7.1 ...
 $ doenca: num [1:145] 2 2 1 1 2 2 2 1 2 2 ...</code></pre>
</div>
</div>
<p>A variável <code>doença</code> será transformada em fator:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>testes<span class="sc">$</span>doenca <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(testes<span class="sc">$</span>doenca)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>As curvas ROC são usadas para avaliar qual teste é mais útil para prever quais pacientes serão positivos para a doença. A hipótese nula é que a área sob a curva ROC é igual a 0,5, ou seja, a habilidade do teste para identificar casos positivos e negativos é a esperada por acaso.</p>
<p>A <a href="#fig-status123" class="quarto-xref">Figura&nbsp;<span>18.3</span></a> mostra a quantidade de sobreposição na distribuição da medição dos testes bioquímicos contínuos em ambos os grupos doença positiva e doença negativa. No Teste 1, a sobreposição é completa e não haverá um ponto de corte que separe efetivamente os dois grupos. Nos Testes 2 e 3, há uma maior separação das medidas de teste entre os grupos, particularmente para Teste 3.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-status123" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" data-fig-pos="ht">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-status123-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="https://i.imgur.com/bTZ7RuY.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:60.0%" data-fig-pos="ht">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-status123-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figura&nbsp;18.3: Resultado do teste vs doença.
</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="construção-da-curva-roc" class="level4" data-number="18.2.4.2">
<h4 data-number="18.2.4.2" class="anchored" data-anchor-id="construção-da-curva-roc"><span class="header-section-number">18.2.4.2</span> Construção da curva ROC</h4>
<p>A validade dos testes, na distinção entre os grupos doença-positivo e doença-negativo, pode ser quantificada pelas curvas ROC, usando a função <code>roc()</code> do pacote <code>pROC</code> <span class="citation" data-cites="robin2011proc">(<a href="references.html#ref-robin2011proc" role="doc-biblioref">14</a>)</span>. Este pacote tem várias funções:</p>
<ul>
<li><strong>auc</strong>: calcula a área da curva ROC;</li>
<li><strong>ci</strong>: calcula o intervalo de confiança da curva ROC;</li>
<li><strong>ci.auc</strong>: calcula o intervalo de confiança da AUC;</li>
<li><strong>ci.se</strong>: calcula o intervalo de confiança de sensibilidades em determinadas especificidades;</li>
<li><strong>ci.sp</strong>: calcula o intervalo de confiança de especificidades em determinadas sensibilidades;</li>
<li><strong>ci.thresholds</strong>: calcula o intervalo de confiança dos limites;</li>
<li><strong>coords</strong>: Retorna as coordenadas (sensibilidades, especificidades, pontos de corte) de uma curva ROC;<br>
</li>
<li><strong>roc</strong>: Constroi uma curva ROC;<br>
</li>
<li><strong>roc.test</strong>: Compara a AUC de duas curvas ROC correlacionadas;<br>
</li>
<li><strong>smooth</strong>: suaviza a curva ROC</li>
</ul>
<p>Usar a função com os argumentos variável resposta (<code>doenca</code>), variável preditora (<code>teste3</code>, <code>teste2</code> e <code>teste1</code>), indicação de que o gráfico deve ser desenhado (<code>plot = TRUE</code>). Como por padrão o gráfico é plotado com a sensibilidade no eixo <em>x</em> e a especificidade no eixo <em>y</em>; deve-se acrescentar o argumento <code>legacy.axes = TRUE</code> para aparecer o seu complemento, os falsos positivos (<span class="math inline">\(1 – especificidade\)</span>).</p>
<p>Além desses, pode-se usar vários outros argumentos como: <code>print.auc = TRUE</code>, que imprime no gráfico a <code>AUC</code> e <code>ci</code> que é o intervalo de confiança da AUC. Para que a sensibilidade e especificidade apareçam como uma percentagem, deve-se usar o argumento <code>percent = TRUE</code>, pois o padrão é <code>FALSE</code>. Os demais argumentos são os rótulos dos eixos, cor da curva, largura da curva (<code>lwd</code>).</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>roc3 <span class="ot">&lt;-</span> <span class="fu">roc</span> (testes<span class="sc">$</span>doenca,</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>             testes<span class="sc">$</span>teste3, </span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>             <span class="at">plot=</span><span class="cn">TRUE</span>,</span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>             <span class="at">quiet =</span> <span class="cn">TRUE</span>,</span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>             <span class="at">legacy.axes=</span><span class="cn">TRUE</span>, </span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a>             <span class="at">print.auc=</span><span class="cn">TRUE</span>,</span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a>             <span class="at">print.auc.y =</span> <span class="fl">0.2</span>,</span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a>             <span class="at">ci =</span> <span class="cn">TRUE</span>,</span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a>             <span class="at">ylab=</span><span class="st">"Sensibilidade"</span>,</span>
<span id="cb27-10"><a href="#cb27-10" aria-hidden="true" tabindex="-1"></a>             <span class="at">xlab=</span><span class="st">"1 - Especificdade"</span>,</span>
<span id="cb27-11"><a href="#cb27-11" aria-hidden="true" tabindex="-1"></a>             <span class="at">col=</span><span class="st">"steelblue"</span>,</span>
<span id="cb27-12"><a href="#cb27-12" aria-hidden="true" tabindex="-1"></a>             <span class="at">smooth =</span> <span class="cn">TRUE</span>,</span>
<span id="cb27-13"><a href="#cb27-13" aria-hidden="true" tabindex="-1"></a>             <span class="at">lwd=</span><span class="dv">2</span>) </span>
<span id="cb27-14"><a href="#cb27-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-15"><a href="#cb27-15" aria-hidden="true" tabindex="-1"></a>roc2 <span class="ot">&lt;-</span> <span class="fu">roc</span> (testes<span class="sc">$</span>doenca,</span>
<span id="cb27-16"><a href="#cb27-16" aria-hidden="true" tabindex="-1"></a>             testes<span class="sc">$</span>teste2, </span>
<span id="cb27-17"><a href="#cb27-17" aria-hidden="true" tabindex="-1"></a>             <span class="at">plot=</span><span class="cn">TRUE</span>,</span>
<span id="cb27-18"><a href="#cb27-18" aria-hidden="true" tabindex="-1"></a>             <span class="at">quiet =</span> <span class="cn">TRUE</span>,</span>
<span id="cb27-19"><a href="#cb27-19" aria-hidden="true" tabindex="-1"></a>             <span class="at">legacy.axes=</span><span class="cn">TRUE</span>, </span>
<span id="cb27-20"><a href="#cb27-20" aria-hidden="true" tabindex="-1"></a>             <span class="at">print.auc=</span><span class="cn">TRUE</span>,</span>
<span id="cb27-21"><a href="#cb27-21" aria-hidden="true" tabindex="-1"></a>             <span class="at">ci =</span> <span class="cn">TRUE</span>,</span>
<span id="cb27-22"><a href="#cb27-22" aria-hidden="true" tabindex="-1"></a>             <span class="at">print.auc.y=</span><span class="fl">0.13</span>,</span>
<span id="cb27-23"><a href="#cb27-23" aria-hidden="true" tabindex="-1"></a>             <span class="at">col=</span><span class="st">"chartreuse4"</span>,</span>
<span id="cb27-24"><a href="#cb27-24" aria-hidden="true" tabindex="-1"></a>             <span class="at">lwd=</span><span class="dv">2</span>,</span>
<span id="cb27-25"><a href="#cb27-25" aria-hidden="true" tabindex="-1"></a>             <span class="at">smooth =</span> <span class="cn">TRUE</span>,</span>
<span id="cb27-26"><a href="#cb27-26" aria-hidden="true" tabindex="-1"></a>             <span class="at">add=</span><span class="cn">TRUE</span>)</span>
<span id="cb27-27"><a href="#cb27-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-28"><a href="#cb27-28" aria-hidden="true" tabindex="-1"></a>roc1 <span class="ot">&lt;-</span> <span class="fu">roc</span> (testes<span class="sc">$</span>doenca,</span>
<span id="cb27-29"><a href="#cb27-29" aria-hidden="true" tabindex="-1"></a>             testes<span class="sc">$</span>teste1, </span>
<span id="cb27-30"><a href="#cb27-30" aria-hidden="true" tabindex="-1"></a>             <span class="at">plot=</span><span class="cn">TRUE</span>,</span>
<span id="cb27-31"><a href="#cb27-31" aria-hidden="true" tabindex="-1"></a>             <span class="at">quiet =</span> <span class="cn">TRUE</span>,</span>
<span id="cb27-32"><a href="#cb27-32" aria-hidden="true" tabindex="-1"></a>             <span class="at">legacy.axes=</span><span class="cn">TRUE</span>, </span>
<span id="cb27-33"><a href="#cb27-33" aria-hidden="true" tabindex="-1"></a>             <span class="at">print.auc=</span><span class="cn">TRUE</span>,</span>
<span id="cb27-34"><a href="#cb27-34" aria-hidden="true" tabindex="-1"></a>             <span class="at">ci =</span> <span class="cn">TRUE</span>,</span>
<span id="cb27-35"><a href="#cb27-35" aria-hidden="true" tabindex="-1"></a>             <span class="at">print.auc.y=</span><span class="fl">0.06</span>,</span>
<span id="cb27-36"><a href="#cb27-36" aria-hidden="true" tabindex="-1"></a>             <span class="at">col=</span><span class="st">"tomato"</span>,</span>
<span id="cb27-37"><a href="#cb27-37" aria-hidden="true" tabindex="-1"></a>             <span class="at">lwd=</span><span class="dv">2</span>,</span>
<span id="cb27-38"><a href="#cb27-38" aria-hidden="true" tabindex="-1"></a>             <span class="at">smooth =</span> <span class="cn">TRUE</span>,</span>
<span id="cb27-39"><a href="#cb27-39" aria-hidden="true" tabindex="-1"></a>             <span class="at">add=</span><span class="cn">TRUE</span>)</span>
<span id="cb27-40"><a href="#cb27-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-41"><a href="#cb27-41" aria-hidden="true" tabindex="-1"></a><span class="co"># Legendas das curvas ROC</span></span>
<span id="cb27-42"><a href="#cb27-42" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span> (<span class="fl">0.73</span>,<span class="fl">0.80</span>,<span class="st">"Teste 3"</span>, <span class="at">col=</span><span class="st">"steelblue"</span>, <span class="at">cex =</span> <span class="dv">1</span>)</span>
<span id="cb27-43"><a href="#cb27-43" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span> (<span class="fl">0.53</span>,<span class="fl">0.73</span>,<span class="st">"Teste 2"</span>, <span class="at">col=</span><span class="st">"chartreuse4"</span>, <span class="at">cex =</span> <span class="dv">1</span>)</span>
<span id="cb27-44"><a href="#cb27-44" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span> (<span class="fl">0.35</span>,<span class="fl">0.65</span>,<span class="st">"Teste 1"</span>, <span class="at">col=</span><span class="st">"tomato"</span>, <span class="at">cex =</span> <span class="dv">1</span>) </span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-roc" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" data-fig-pos="ht">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-roc-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="18-epidemiologia_files/figure-html/fig-roc-1.png" class="quarto-figure quarto-figure-center figure-img" style="width:80.0%;height:80.0%" data-fig-pos="ht">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-roc-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figura&nbsp;18.4: Curvas ROC para os Testes 1, 2 e 3.
</figcaption>
</figure>
</div>
</div>
</div>
<p><u>Interpretação do resultado</u></p>
<p>Em uma curva ROC, a sensibilidade é calculada usando cada valor do teste no conjunto de dados como um ponto de corte e é plotada em relação à (1 – especificidade) correspondente nesse ponto, como mostrado na <a href="#fig-roc" class="quarto-xref">Figura&nbsp;<span>18.4</span></a>.</p>
<p>Assim, a curva são os <em>Verdadeiros Positivos</em> (VP) plotados em relação aos <em>Falsos Positivos</em> (FP), calculados usando cada valor do teste como ponto de corte. A reta diagonal indica onde o teste cairia se os resultados não fossem melhores do que o acaso para predizer a presença de uma doença. O Teste 1 está próximo desta reta, confirmando que ele tem pouca capacidade de discriminar os pacientes doentes e não doentes.</p>
<p>A área abaixo da reta diagonal é equivalente a 0,5 da área total. Quanto maior a área sob a curva ROC, mais útil é o teste para predizer os pacientes que têm a doença. Uma curva que cai substancialmente abaixo da linha diagonal indica que o teste tem pouca capacidade de diagnosticar a doença. Quando há uma separação perfeita dos valores dos dois grupos, isto é, sem sobreposição das distribuições, a área sob a curva ROC é igual a 1 (a curva ROC alcançará o canto superior esquerdo do gráfico).</p>
<p>A área sob a curva (<em>Area Under the Curve</em> – AUC) e seu intervalo de confiança de 95% podem ser obtidos com os comandos usados na construção da <a href="#fig-roc" class="quarto-xref">Figura&nbsp;<span>18.4</span></a> ou separadamente usando as funções <code>auc()</code> e <code>ci.auc()</code> do pacote <code>pROC</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="fu">auc</span> (roc1) </span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Area under the curve: 0.5891</code></pre>
</div>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ci.auc</span> (roc1)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>95% CI: 0.4861-0.6814 (2000 stratified bootstrap replicates)</code></pre>
</div>
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="fu">auc</span>(roc2) </span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Area under the curve: 0.7616</code></pre>
</div>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ci.auc</span>(roc2)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>95% CI: 0.6761-0.8398 (2000 stratified bootstrap replicates)</code></pre>
</div>
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="fu">auc</span> (roc3) </span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Area under the curve: 0.898</code></pre>
</div>
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ci.auc</span>(roc3)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>95% CI: 0.8358-0.939 (2000 stratified bootstrap replicates)</code></pre>
</div>
</div>
<p>A acurácia geral de um teste pode ser descrita como a área sob a curva; quanto maior for a área, melhor será o teste. Na <a href="#fig-roc" class="quarto-xref">Figura&nbsp;<span>18.4</span></a>, o Teste 3 tem uma AUC maior que os outros dois testes.<br>
Usa-se a seguinte estimativa (<a href="#tbl-roc1" class="quarto-xref">Tabela&nbsp;<span>18.3</span></a>) para avaliar a acurácia de um teste ou da capacidade de identificar corretamente uma condição usando curva ROC <span class="citation" data-cites="borges2016accuracy">(<a href="references.html#ref-borges2016accuracy" role="doc-biblioref">15</a>)</span>:</p>
<div class="cell">
<div id="tbl-roc1" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-roc1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Tabela&nbsp;18.3: Acurácia do teste diagnóstico
</figcaption>
<div aria-describedby="tbl-roc1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<div class="tabwid"><style>.cl-256b3064{}.cl-255d3130{font-family:'Arial';font-size:11pt;font-weight:bold;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-255d314e{font-family:'Arial';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-25641478{margin:0;text-align:center;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-25643c00{width:1.05in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-25643c0a{width:1.619in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-25643c14{width:1.05in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-25643c1e{width:1.619in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-25643c1f{width:1.05in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-25643c28{width:1.619in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table data-quarto-disable-processing="true" class="cl-256b3064"><thead><tr style="overflow-wrap:break-word;"><th class="cl-25643c00"><p class="cl-25641478"><span class="cl-255d3130">AUC</span></p></th><th class="cl-25643c0a"><p class="cl-25641478"><span class="cl-255d3130">Qualidade do Teste</span></p></th></tr></thead><tbody><tr style="overflow-wrap:break-word;"><td class="cl-25643c14"><p class="cl-25641478"><span class="cl-255d314e">&gt;0,90</span></p></td><td class="cl-25643c1e"><p class="cl-25641478"><span class="cl-255d314e">excelente</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-25643c14"><p class="cl-25641478"><span class="cl-255d314e">0,80 a 0,90</span></p></td><td class="cl-25643c1e"><p class="cl-25641478"><span class="cl-255d314e">muito bom</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-25643c14"><p class="cl-25641478"><span class="cl-255d314e">0,70 a 0,80</span></p></td><td class="cl-25643c1e"><p class="cl-25641478"><span class="cl-255d314e">bom</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-25643c14"><p class="cl-25641478"><span class="cl-255d314e">0,60 a 0,70</span></p></td><td class="cl-25643c1e"><p class="cl-25641478"><span class="cl-255d314e">suficiente</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-25643c14"><p class="cl-25641478"><span class="cl-255d314e">0,50 a 0,60</span></p></td><td class="cl-25643c1e"><p class="cl-25641478"><span class="cl-255d314e">ruim</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-25643c1f"><p class="cl-25641478"><span class="cl-255d314e">&lt;0,50</span></p></td><td class="cl-25643c28"><p class="cl-25641478"><span class="cl-255d314e">ignorar teste</span></p></td></tr></tbody></table></div>
</div>
</div>
</figure>
</div>
</div>
<p>Desta forma, o Teste 3 pode ser considerado um bom teste e o Teste 1 é um teste ruim.</p>
<p><u>Comparando duas curvas</u></p>
<p>Pode-se comparar duas curvas ROC com a função <code>roc.test()</code>, por exemplo, comparando as curvas dos Teste 3 e 2 <span class="citation" data-cites="delong1988comparing">(<a href="references.html#ref-delong1988comparing" role="doc-biblioref">16</a>)</span>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="fu">roc.test</span>(roc3, roc2)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Bootstrap test for two correlated ROC curves

data:  roc3 and roc2
D = 4.6305, boot.n = 2000, boot.stratified = 1, p-value = 3.648e-06
alternative hypothesis: true difference in AUC is not equal to 0
sample estimates:
Smoothed AUC of roc1 Smoothed AUC of roc2 
           0.8980454            0.7616201 </code></pre>
</div>
</div>
<p>O Teste 3 tem uma AUC que o caracteriza como um bom teste e o teste de DeLong, entregue na saída do <code>roc.test()</code>, resultou que a diferença entre ele o Teste 2 é estatisticamente significativa (<em>P</em> &lt; 0,0001).</p>
</section>
<section id="melhor-ponto-de-corte" class="level4" data-number="18.2.4.3">
<h4 data-number="18.2.4.3" class="anchored" data-anchor-id="melhor-ponto-de-corte"><span class="header-section-number">18.2.4.3</span> Melhor ponto de corte</h4>
<p>O melhor ponto de corte (<em>Best Critical Value</em>), que às vezes é chamado de <em>ponto de diagnóstico ótimo</em> ou <em>de Youden</em>, é o ponto da curva mais próximo da parte superior do eixo <em>y</em> (<a href="#fig-roc" class="quarto-xref">Figura&nbsp;<span>18.4</span></a>, Teste 3). Este é o ponto em que a taxa de verdadeiros positivos é otimizada e a taxa de falsos positivos é minimizada. O melhor ponto de corte para o Teste 3 é mostrado na <a href="#fig-roc3" class="quarto-xref">Figura&nbsp;<span>18.5</span></a>. Este melhor ponto de corte pode ser identificado a partir dos pontos de coordenadas da curva, usando a função <code>roc()</code> com os seguintes argumentos:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>best <span class="ot">&lt;-</span> <span class="fu">roc</span> (testes<span class="sc">$</span>doenca, </span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>     testes<span class="sc">$</span>teste3,</span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">plot =</span> <span class="cn">TRUE</span>,</span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">ci=</span><span class="cn">TRUE</span>,</span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a>     <span class="at">thresholds=</span><span class="st">"best"</span>, </span>
<span id="cb42-6"><a href="#cb42-6" aria-hidden="true" tabindex="-1"></a>     <span class="at">print.thres=</span><span class="st">"best"</span>,</span>
<span id="cb42-7"><a href="#cb42-7" aria-hidden="true" tabindex="-1"></a>     <span class="at">legacy.axes=</span><span class="cn">TRUE</span>,</span>
<span id="cb42-8"><a href="#cb42-8" aria-hidden="true" tabindex="-1"></a>     <span class="at">main=</span><span class="st">""</span>,</span>
<span id="cb42-9"><a href="#cb42-9" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab=</span><span class="st">"Sensibilidade"</span>,</span>
<span id="cb42-10"><a href="#cb42-10" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab=</span><span class="st">"1 - Especificidade"</span>,</span>
<span id="cb42-11"><a href="#cb42-11" aria-hidden="true" tabindex="-1"></a>     <span class="at">col=</span><span class="st">"steelblue"</span>,</span>
<span id="cb42-12"><a href="#cb42-12" aria-hidden="true" tabindex="-1"></a>     <span class="at">lwd=</span><span class="dv">2</span>)</span>
<span id="cb42-13"><a href="#cb42-13" aria-hidden="true" tabindex="-1"></a>best</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
roc.default(response = testes$doenca, predictor = testes$teste3,     ci = TRUE, plot = TRUE, thresholds = "best", print.thres = "best",     legacy.axes = TRUE, main = "", ylab = "Sensibilidade", xlab = "1 - Especificidade",     col = "steelblue", lwd = 2)

Data: testes$teste3 in 48 controls (testes$doenca 1) &gt; 97 cases (testes$doenca 2).
Area under the curve: 0.8973
95% CI: 0.8444-0.9502 (DeLong)</code></pre>
</div>
<div class="cell-output-display">
<div id="fig-roc3" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" data-fig-pos="ht">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-roc3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="18-epidemiologia_files/figure-html/fig-roc3-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:70.0%" data-fig-pos="ht">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-roc3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figura&nbsp;18.5: Curvas ROC para os Testes 1, 2 e 3.
</figcaption>
</figure>
</div>
</div>
</div>
<p>Assim, para o <em>Teste 3</em>, o ponto de corte ideal é 24,8, onde a especificidade é igual a 0,854 e a sensibilidade é igual 0,845. Estes dados, fornecem um LR para um resultado positivo igual a:</p>
<p><span class="math display">\[
LR \left(+\right) = \frac{0.845}{\left (1-0.854\right)} = 5,79
\]</span></p>
<p>As coordenadas da curva ROC podem ser obtida com a seguinte programação, a partir de uma sensibilidade e especificidade acima de 0 (zero):</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>coordenadas <span class="ot">&lt;-</span> testes <span class="sc">%&gt;%</span> <span class="fu">roc</span>(doenca, teste3) <span class="sc">%&gt;%</span> <span class="fu">coords</span> (<span class="at">transpose =</span> F)</span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(coordenadas, <span class="dv">10</span>)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   threshold specificity sensitivity
1        Inf  0.00000000           1
2      57.50  0.02083333           1
3      54.65  0.04166667           1
4      53.45  0.06250000           1
5      52.80  0.08333333           1
6      51.30  0.10416667           1
7      49.65  0.12500000           1
8      48.65  0.16666667           1
9      47.50  0.18750000           1
10     46.50  0.35416667           1</code></pre>
</div>
</div>
<p>A <em>estatística J de Youden</em> <span class="citation" data-cites="youden1950index">(<a href="references.html#ref-youden1950index" role="doc-biblioref">17</a>)</span> é calculada deduzindo 1 a partir da soma de sensibilidade e especificidade do teste e não é expressa como porcentagem, mas como parte de um número inteiro: <span class="math inline">\(\left (sensibilidade + especificidade\right) - 1\)</span>. A estatística J de Youden no melhor ponto de corte do Teste 3 é igual a <span class="math inline">\(\left (0,845+ 0,854\right) - 1 = 0,699\)</span>.</p>
<p>Este é o maior valor de todos os valores das coordenadas (91 valores) usadas.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>youden <span class="ot">&lt;-</span> <span class="fu">max</span>(coordenadas<span class="sc">$</span>sensitivity <span class="sc">+</span> coordenadas<span class="sc">$</span>specificity) <span class="sc">-</span> <span class="dv">1</span></span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>youden</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.6995275</code></pre>
</div>
</div>
<p>A <a href="#fig-roc3" class="quarto-xref">Figura&nbsp;<span>18.5</span></a> mostra o ponto de corte ideal. Ele também pode ser obtido com a função <code>coords()</code> do pacote <code>pRoc</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a>roc3 <span class="ot">&lt;-</span> testes <span class="sc">%&gt;%</span> <span class="fu">roc</span>(doenca, teste3)</span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a><span class="fu">coords</span>(roc3, <span class="at">x =</span> <span class="st">"best"</span>, <span class="at">ret=</span><span class="st">"threshold"</span>, <span class="at">transpose =</span> <span class="cn">FALSE</span>, </span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a>       <span class="at">best.method=</span><span class="st">"youden"</span>)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  threshold
1      24.8</code></pre>
</div>
</div>
<p>O método para obter o melhor ponto de corte (<code>best.method</code>) pode ser pelo método de <code>youden</code> ou <code>closest.topleft</code>. No exemplo, o resultado é o mesmo. Para maiores detalhes consulte a ajuda da função <code>coord()</code>, do pacote <code>pROC</code>.</p>
</section>
</section>
</section>
<section id="estatística-kappa" class="level2" data-number="18.3">
<h2 data-number="18.3" class="anchored" data-anchor-id="estatística-kappa"><span class="header-section-number">18.3</span> Estatística <em>kappa</em></h2>
<p>A estatística de concordância <em>kappa</em> (<em>k</em>) de Cohen é utilizada para descrever a concordância entre dois ou mais avaliadores quando realizam uma avaliação nominal ou ordinal de uma mesma amostra <span class="citation" data-cites="cohen1960coefficient">(<a href="references.html#ref-cohen1960coefficient" role="doc-biblioref">18</a>)</span>. A estatística <em>kappa</em> corrige a chance do acaso nas avaliações e é obtida pela fórmula igual a:</p>
<p><span class="math display">\[
k= \frac{p_{o} - p_{e}}{1 - p_{e}}
\]</span></p>
<p>Onde <span class="math inline">\(p_{o}\)</span> = proporção observada de concordância e <span class="math inline">\(p_{e}\)</span> = proporção esperada de concordância apenas pelo acaso.</p>
<p>Por exemplo, dois radiologistas podem revisar independentemente uma série de radiografias do tórax de pacientes para determinar a presença ou ausência de pneumonia. Para avaliar o grau de concordância entre as classificações dos dois médicos, pode ser relatado o percentual de concordância entre os avaliadores (por exemplo, 50% dos avaliadores responderam “sim” nas duas ocasiões). No entanto, esse percentual pode ser enganoso, pois não leva em conta o nível de concordância entre os dois avaliadores que pode ocorrer por acaso. A estatística <em>kappa</em> pode ser usada para avaliar a concordância das respostas para dois ou mais avaliadores após considerar a concordância casual. Portanto, a estatística <em>kappa</em> é uma estimativa da proporção de concordância entre avaliadores que excede a concordância que ocorreria por acaso.</p>
<p>A interpretação dos valores de <em>kappa</em> é mostrada na <a href="#tbl-kappa" class="quarto-xref">Tabela&nbsp;<span>18.4</span></a> <span class="citation" data-cites="landis1977measurement">(<a href="references.html#ref-landis1977measurement" role="doc-biblioref">19</a>)</span>. Quando a proporção observada de concordância é menor que a esperada por acaso, o <em>kappa</em> terá um valor negativo indicando não concordância. Um valor de <em>kappa</em> igual a 0 indica que a concordância observada é igual à concordância casual.</p>
<p>O teste de hipóteses testa a hipótese de que a concordância entre os dois avaliadores seja puramente aleatória. Quando o valor <em>P</em> é menor que 0,05, rejeitamos a hipótese de que a concordância foi puramente aleatória. As premissas para o <em>kappa</em> de Cohen são que os participantes ou itens a serem classificados são independentes e também que os avaliadores e categorias são independentes.</p>
<div class="cell">
<div id="tbl-kappa" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-kappa-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Tabela&nbsp;18.4: Valor Kappa e nível de concordância
</figcaption>
<div aria-describedby="tbl-kappa-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<div class="tabwid"><style>.cl-2f656620{}.cl-2f593ef4{font-family:'Arial';font-size:11pt;font-weight:bold;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-2f593f08{font-family:'Arial';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-2f5ddcac{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-2f5ddce8{margin:0;text-align:center;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-2f5e051a{width:1.101in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-2f5e052e{width:1.253in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-2f5e052f{width:1.101in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-2f5e0538{width:1.253in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-2f5e0539{width:1.101in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-2f5e053a{width:1.253in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-2f5e0542{width:1.101in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-2f5e0543{width:1.253in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table data-quarto-disable-processing="true" class="cl-2f656620"><thead><tr style="overflow-wrap:break-word;"><th class="cl-2f5e051a"><p class="cl-2f5ddcac"><span class="cl-2f593ef4">Valor kappa</span></p></th><th class="cl-2f5e052e"><p class="cl-2f5ddcac"><span class="cl-2f593ef4">Concordância</span></p></th></tr></thead><tbody><tr style="overflow-wrap:break-word;"><td class="cl-2f5e052f"><p class="cl-2f5ddce8"><span class="cl-2f593f08">&lt;0,00</span></p></td><td class="cl-2f5e0538"><p class="cl-2f5ddcac"><span class="cl-2f593f08">pobre</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-2f5e0539"><p class="cl-2f5ddce8"><span class="cl-2f593f08">0,00 - 0,20</span></p></td><td class="cl-2f5e053a"><p class="cl-2f5ddcac"><span class="cl-2f593f08">leve</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-2f5e0539"><p class="cl-2f5ddce8"><span class="cl-2f593f08">0,21 - 0,40</span></p></td><td class="cl-2f5e053a"><p class="cl-2f5ddcac"><span class="cl-2f593f08">razoável</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-2f5e0539"><p class="cl-2f5ddce8"><span class="cl-2f593f08">0,41 - 0,60</span></p></td><td class="cl-2f5e053a"><p class="cl-2f5ddcac"><span class="cl-2f593f08">moderada</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-2f5e0539"><p class="cl-2f5ddce8"><span class="cl-2f593f08">0,61 - 0,80</span></p></td><td class="cl-2f5e053a"><p class="cl-2f5ddcac"><span class="cl-2f593f08">substancial</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-2f5e0542"><p class="cl-2f5ddce8"><span class="cl-2f593f08">0,81 - 1,00</span></p></td><td class="cl-2f5e0543"><p class="cl-2f5ddcac"><span class="cl-2f593f08">quase perfeita</span></p></td></tr></tbody></table></div>
</div>
</div>
</figure>
</div>
</div>
<p>Existem diferentes tipos de estatísticas <em>kappa</em>. Para dados com três ou mais categorias possíveis (por exemplo, concordo, concordo parcialmente, discordo) ou para dados categóricos ordenados, o <em>kappa</em> ponderado deve ser usado para que as respostas que estão mais distantes da concordância tenham maior peso do que aquelas próximas à concordância. No exemplo usado, as categorias possíveis são dicotômicas (sim e não), portanto, o kappa não ponderado (<em>unweighted</em>) e o ponderado (<em>weighted</em>) retornam o mesmo resultado.</p>
<section id="sec-exkappa" class="level3" data-number="18.3.1">
<h3 data-number="18.3.1" class="anchored" data-anchor-id="sec-exkappa"><span class="header-section-number">18.3.1</span> Exemplo</h3>
<p>O arquivo <code>dadosPneumonia.xlsx</code> contém os dados de 54 crianças com suspeita de pneumonia, cujas radiografias foram avaliadas por dois radiologistas. O objetivo foi medir a concordância diagnóstica dos dois profissionais. Para o cálculo do coeficiente <em>kappa</em>, será usada a função <code>Kappa()</code> do pacote <code>vcd</code> <span class="citation" data-cites="zeileis2007residual">(<a href="references.html#ref-zeileis2007residual" role="doc-biblioref">20</a>)</span>. Essa função tem os seguintes argumentos:</p>
<ul>
<li><strong>x</strong> <span class="math inline">\(\longrightarrow\)</span> matriz ou tabela</li>
<li><strong>weights</strong> <span class="math inline">\(\longrightarrow\)</span> matriz especificada pelo usuário com as mesmas dimensões de <em>x</em>, desnecessário para <em>kappa</em> não ponderado.</li>
</ul>
<p>Na impressão do <em>kappa</em> pode-se usar <code>print (k, digits = 3, CI = TRUE, level = 0.95)</code>. Onde <em>k</em> é o coeficiente de <em>kappa</em>, calculado pela função <code>Kappa()</code>, <em>CI</em> é o intervalo de confiança e o nível de confiança padrão é 95%.</p>
<section id="leitura-e-exploração-dos-dados" class="level4" data-number="18.3.1.1">
<h4 data-number="18.3.1.1" class="anchored" data-anchor-id="leitura-e-exploração-dos-dados"><span class="header-section-number">18.3.1.1</span> Leitura e exploração dos dados</h4>
<p>O conjunto de dados <code>dadosPneumonia.xlsx</code> pode ser obtido <a href="https://github.com/petronioliveira/Arquivos/blob/main/dadosPneumonia.xlsx"><strong>aqui</strong></a>. Após salvar o arquivo em seu diretório, ele pode ser carregado com a função <code>read_excel()</code> do pacote <code>readxl</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a>dados <span class="ot">&lt;-</span> readxl<span class="sc">::</span><span class="fu">read_excel</span>(<span class="st">"dados/dadosPneumonia.xlsx"</span>)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="construção-da-tabela" class="level4" data-number="18.3.1.2">
<h4 data-number="18.3.1.2" class="anchored" data-anchor-id="construção-da-tabela"><span class="header-section-number">18.3.1.2</span> Construção da tabela</h4>
<p>O cálculo do <em>kappa</em> com a função <code>Kappa()</code> exige uma tabela, onde os dados dos dois radiologistas são cruzados. As variáveis a serem cruzadas são <code>rx1</code> e <code>rx2</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a>dados<span class="sc">$</span>rx1 <span class="ot">&lt;-</span> <span class="fu">factor</span>(dados<span class="sc">$</span>rx1,</span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>                        <span class="at">ordered=</span><span class="cn">TRUE</span>,</span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a>                        <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"sim"</span>, <span class="st">"não"</span>))                           </span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a>dados<span class="sc">$</span>rx2 <span class="ot">&lt;-</span> <span class="fu">factor</span>(dados<span class="sc">$</span>rx2,</span>
<span id="cb51-5"><a href="#cb51-5" aria-hidden="true" tabindex="-1"></a>                        <span class="at">ordered=</span><span class="cn">TRUE</span>,</span>
<span id="cb51-6"><a href="#cb51-6" aria-hidden="true" tabindex="-1"></a>                        <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"sim"</span>, <span class="st">"não"</span>))</span>
<span id="cb51-7"><a href="#cb51-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-8"><a href="#cb51-8" aria-hidden="true" tabindex="-1"></a>tabk <span class="ot">&lt;-</span> <span class="fu">with</span>(dados, <span class="fu">table</span>(rx1, rx2, <span class="at">dnn =</span> <span class="fu">c</span> (<span class="st">"Radiologista 1"</span>, <span class="st">"Radiologista 2"</span>)))</span>
<span id="cb51-9"><a href="#cb51-9" aria-hidden="true" tabindex="-1"></a><span class="fu">addmargins</span>(tabk, <span class="at">FUN =</span> sum)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Margins computed over dimensions
in the following order:
1: Radiologista 1
2: Radiologista 2</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>              Radiologista 2
Radiologista 1 sim não sum
           sim  32   5  37
           não   3  14  17
           sum  35  19  54</code></pre>
</div>
</div>
</section>
<section id="cálculo-do-kappa" class="level4" data-number="18.3.1.3">
<h4 data-number="18.3.1.3" class="anchored" data-anchor-id="cálculo-do-kappa"><span class="header-section-number">18.3.1.3</span> Cálculo do <em>kappa</em></h4>
<p>O <em>kappa</em> é dado pela execução da função:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a>k <span class="ot">&lt;-</span> vcd<span class="sc">::</span><span class="fu">Kappa</span>(tabk)</span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span> (k, </span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a>       <span class="at">digits=</span> <span class="dv">3</span>, </span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a>       <span class="at">CI=</span><span class="cn">TRUE</span>, </span>
<span id="cb54-5"><a href="#cb54-5" aria-hidden="true" tabindex="-1"></a>       <span class="at">level=</span><span class="fl">0.95</span>)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>           value   ASE    z Pr(&gt;|z|) lower upper
Unweighted 0.667 0.107 6.21 5.42e-10 0.456 0.878
Weighted   0.667 0.107 6.21 5.42e-10 0.456 0.878</code></pre>
</div>
</div>
<p>A saída exibe o <em>kappa</em> pontual e os intervalos de confiança de 95%, podendo-se concluir, desses resultados, que existe uma boa confiabilidade nos diagnósticos dos radiologistas (k = 0,67, concordância substancial,de acordo com a <a href="#tbl-kappa" class="quarto-xref">Tabela&nbsp;<span>18.4</span></a>.</p>
</section>
</section>
</section>
<section id="medidas-de-frequência" class="level2" data-number="18.4">
<h2 data-number="18.4" class="anchored" data-anchor-id="medidas-de-frequência"><span class="header-section-number">18.4</span> Medidas de frequência</h2>
<section id="prevalência" class="level3" data-number="18.4.1">
<h3 data-number="18.4.1" class="anchored" data-anchor-id="prevalência"><span class="header-section-number">18.4.1</span> Prevalência</h3>
<p>A prevalência, ou mais adequadamente, a <em>prevalência pontual</em> de uma doença é a proporção da população portadora da doença em um determinado ponto do tempo. É uma medida instantânea por excelência e fornece uma medida estática da frequência da doença. É também conhecida como <em>taxa de prevalência</em> e é expressa em percentagem ou por <span class="math inline">\(10^{n}\)</span> habitantes. As medidas de prevalência geram informações úteis para o planejamento e administração de serviços de saúde.</p>
<p>A <em>prevalência por período</em> descreve os casos que estavam presentes em qualquer momento durante um determinado período de tempo. Diz o número total de casos de uma doença que se sabe haver existido durante um período de tempo.</p>
<p>Um tipo especial de prevalência de período é a prevalência ao longo da vida, que mede a frequência cumulativa ao longo da vida de um resultado até o momento presente (ou seja, a proporção de pessoas que tiveram o evento em qualquer momento no passado).</p>
<p>As doenças, quanto a sua duração, podem ser agudas e de longa duração ou crônicas. A prevalência é proporcional ao tempo de duração da doença. Hipoteticamente, se o surgimento de novos casos de doença ocorre em ritmo constante e igual para doenças agudas e crônicas, estas últimas acumularão casos, aumentando a prevalência. As doenças agudas tenderão a manter uma prevalência constante. A terapêutica, diminuindo o tempo de duração das doenças, também reduz a prevalência. A prevalência é dada pela razão:</p>
<p><span class="math display">\[
prevalência = \frac{número \ de \ casos \ conhecidos \ da \ doença}{total \ da \ População} \times 10^{n}
\]</span></p>
<section id="exemplo" class="level4" data-number="18.4.1.1">
<h4 data-number="18.4.1.1" class="anchored" data-anchor-id="exemplo"><span class="header-section-number">18.4.1.1</span> Exemplo</h4>
<p>Como exemplo, será verificada a frequência de tabagismo entre as puérperas da maternidade do HGCS. O banco de dados <code>dadosMater.xlsx</code> contém informação de 1368 nascimentos e pode ser consultado na <a href="05-manipulandoDados.html#sec-mater" class="quarto-xref"><span>Seção 5.3</span></a>. Clique <a href="https://github.com/petronioliveira/Arquivos/blob/main/dadosMater.xlsx"><strong>aqui</strong></a> para baixar e depois de salvar em seu diretório de trabalho, carregue-o com a função <code>read_excel()</code> do pacote <code>readxl</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a>dados <span class="ot">&lt;-</span> readxl<span class="sc">::</span><span class="fu">read_excel</span> (<span class="st">"dados/dadosMater.xlsx"</span>)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Inicialmente, será verificado quantas fumantes existem. O conjunto de dados contém uma variável <code>fumo</code>, onde <code>1 = fumante</code> e <code>2 = não fumante</code>. Portanto, há necessidade de transformar a variável numérica em um fator:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a>dados<span class="sc">$</span>fumo <span class="ot">&lt;-</span> <span class="fu">factor</span> (dados<span class="sc">$</span>fumo,</span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a>                      <span class="at">ordered =</span> <span class="cn">TRUE</span>, </span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a>                      <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>),</span>
<span id="cb57-4"><a href="#cb57-4" aria-hidden="true" tabindex="-1"></a>                      <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"fumante"</span>, <span class="st">"não fumante"</span>))</span>
<span id="cb57-5"><a href="#cb57-5" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb57-6"><a href="#cb57-6" aria-hidden="true" tabindex="-1"></a>tabFumo <span class="ot">&lt;-</span> <span class="fu">with</span>(<span class="at">data =</span> dados, <span class="fu">table</span>(fumo))</span>
<span id="cb57-7"><a href="#cb57-7" aria-hidden="true" tabindex="-1"></a><span class="fu">addmargins</span>(tabFumo, <span class="at">FUN =</span> sum)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>fumo
    fumante não fumante         sum 
        301        1067        1368 </code></pre>
</div>
</div>
<p>Além de relatar a estimativa pontual da frequência da doença, é importante fornecer uma indicação da incerteza em torno dessa estimativa pontual. A função <code>epi.conf()</code>, do pacote <code>epiR</code> <span class="citation" data-cites="stevenson2022epir">(<a href="references.html#ref-stevenson2022epir" role="doc-biblioref">4</a>)</span>, permite calcular intervalos de confiança para prevalência, motivo da escolha dessa função.</p>
<p>A função <code>epi.conf()</code> usa os seguintes argumentos:</p>
<ul>
<li><strong>dat</strong> <span class="math inline">\(\longrightarrow\)</span> matriz ou tabela;</li>
<li><strong>ctype</strong> <span class="math inline">\(\longrightarrow\)</span> tipo de intervalo de confiança a ser calculado. Opções: <em>mean.single</em>, <em>mean.unpair</em>, <em>mean.pair</em>, <em>prop.single</em>, <em>prop.unpaired</em>, <em>prevalence</em>, <em>inc.risk</em>, <em>inc.rate</em>, <em>odds</em> e <em>smr</em> (<em>standardized mortality rate</em>);<br>
</li>
<li><strong>method</strong> <span class="math inline">\(\longrightarrow\)</span> método a ser usado. Quando <code>ctype = "inc.risk"</code> ou <code>ctype = "prevalence"</code>, as opções são <code>exact</code>, <code>wilson</code> e <code>fleiss</code> Quando <code>ctype = "inc.rate"</code> as opções são <code>exact</code> e <code>byar</code>;</li>
<li><strong>N</strong> <span class="math inline">\(\longrightarrow\)</span> tamanho da população;</li>
<li><strong>conf.level</strong> <span class="math inline">\(\longrightarrow\)</span> magnitude do intervalo de confiança retornado. Deve ser um único número entre 0 e 1.</li>
</ul>
<p><u>Construção da matriz</u></p>
<p>Com os dados da <code>tabFumo</code>, constrói-se uma matriz de duas colunas:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a>n1 <span class="ot">&lt;-</span> tabFumo[<span class="dv">1</span>]</span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a>N1 <span class="ot">&lt;-</span> tabFumo[<span class="dv">1</span>] <span class="sc">+</span> tabFumo[<span class="dv">2</span>]</span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a>mat1 <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(<span class="fu">cbind</span> (n1, N1))</span>
<span id="cb59-4"><a href="#cb59-4" aria-hidden="true" tabindex="-1"></a>mat1</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>         n1   N1
fumante 301 1368</code></pre>
</div>
</div>
<p><u>Cálculo da prevalência</u></p>
<p>Usando a função <code>epiR()</code>, tem-se:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a>epiR<span class="sc">::</span><span class="fu">epi.conf</span>(mat1, </span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a>               <span class="at">ctype =</span> <span class="st">"prevalence"</span>, </span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a>               <span class="at">method =</span> <span class="st">"exact"</span>, </span>
<span id="cb61-4"><a href="#cb61-4" aria-hidden="true" tabindex="-1"></a>               <span class="at">conf.level =</span> <span class="fl">0.95</span>) </span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>        est     lower     upper
1 0.2200292 0.1983313 0.2429365</code></pre>
</div>
</div>
<p>A saída mostra que a prevalência de fumantes entre as puérperas do HGCS é igual a 22,0% (IC95%: 19,8 – 24,3%).</p>
</section>
</section>
<section id="incidência" class="level3" data-number="18.4.2">
<h3 data-number="18.4.2" class="anchored" data-anchor-id="incidência"><span class="header-section-number">18.4.2</span> Incidência</h3>
<p>A incidência fornece uma medida da frequência com que os indivíduos suscetíveis se tornam casos de doenças, à medida que são observados ao longo do tempo.<br>
Um caso incidente ocorre quando um indivíduo deixa de ser suscetível e passa a ser doente. A contagem de casos incidentes é o número de tais eventos que ocorrem em uma população durante um período de acompanhamento definido. Existem duas maneiras de expressar a incidência:</p>
<p>A <em>incidência cumulativa</em> (risco) é a proporção de indivíduos inicialmente suscetíveis em uma população que se tornam novos casos durante um período de acompanhamento definido.</p>
<p>Para calcular a incidência cumulativa, é necessário primeiro identificar os doentes e após acompanhar por um determinado tempo os não doentes (<a href="#fig-incidencia" class="quarto-xref">Figura&nbsp;<span>18.6</span></a>).</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-incidencia" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" data-fig-pos="ht">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-incidencia-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="https://i.imgur.com/TqBeiuV.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:75.0%" data-fig-pos="ht">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-incidencia-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figura&nbsp;18.6: Incidência
</figcaption>
</figure>
</div>
</div>
</div>
<p>A <em>taxa de incidência</em> (densidade de incidência ou taxa de incidência) é o número de novos casos da doença que ocorrem por unidade de tempo em risco durante um período de acompanhamento definido. Este período é expresso como <em>pessoas-tempo</em> (pessoas-ano, por exemplo).</p>
<p>O conceito de pessoas-tempo pode ser ilustrado com o seguinte exemplo: a <a href="#fig-incidencia1" class="quarto-xref">Figura&nbsp;<span>18.7</span></a> representa um estudo epidemiológico hipotético com duração de cinco anos, onde D é o desfecho e C representa os sujeitos que deixaram o estudo por migração ou morte (censurados) por causa não relacionada ao desfecho</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-incidencia1" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" data-fig-pos="ht">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-incidencia1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="https://i.imgur.com/drqeIs8.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:65.0%" data-fig-pos="ht">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-incidencia1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figura&nbsp;18.7: Pessoas-tempo (estudo epidemiológico hipotético).
</figcaption>
</figure>
</div>
</div>
</div>
<p>Nesse estudo hipotético, o indivíduo 1 permaneceu no estudo 3,5 anos; o indivíduo 2, ficou 5 anos; o indivíduo 3, 4,5 anos e, assim por diante, totalizando 32,5 pessoas-anos. Em outras palavras, ocorreram 4 desfechos durante os 5 anos do estudo, consequentemente, a taxa de incidência (TI) foi de</p>
<p><span class="math display">\[
TI = \frac{4}{32,5} \times 1000 = \frac{123}{1000\ pessoas-ano}
\]</span></p>
<p>Isto significa que se fossem acompanhadas 1000 pessoas por um ano, 123 delas apresentariam o desfecho D.</p>
<section id="exemplo-1" class="level4" data-number="18.4.2.1">
<h4 data-number="18.4.2.1" class="anchored" data-anchor-id="exemplo-1"><span class="header-section-number">18.4.2.1</span> Exemplo</h4>
<p>Aparentemente, pessoas cegas tem uma menor incidência de câncer e esse efeito parece ser mais pronunciado em pessoas totalmente cegas do que em pessoas com deficiência visual grave.</p>
<p>Para testar essa hipótese, foi identificada uma coorte de 1.567 pessoas totalmente cegas e 13.292 sujeitos com deficiência visual grave. As informações sobre a incidência de câncer foram obtidas do Registro Sueco de Câncer <span class="citation" data-cites="feychting1998reduced">(<a href="references.html#ref-feychting1998reduced" role="doc-biblioref">21</a>)</span>. Foram diagnosticados de 136 casos de câncer em 22050 pessoas-ano em risco totalmente cegas e 1709 casos de câncer em 127650 pessoas-anos em risco com deficiência visual grave.</p>
<p>A taxa de incidência pode ser calculada, usando-se a mesma função <code>epi.conf()</code>, usada para o cálculo da prevalência, mudando o argumento <code>ctype = “prevalence”</code> para <code>ctype = “inc.rate”</code>, conforme recomendado:</p>
<p><u>Pessoas totalmente cegas</u></p>
<p>Inicialmente, contrói-se a matriz:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a>n2 <span class="ot">&lt;-</span> <span class="dv">136</span></span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a>N2 <span class="ot">&lt;-</span> <span class="dv">22050</span></span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a>mat2 <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(<span class="fu">cbind</span> (n2, N2))</span>
<span id="cb63-4"><a href="#cb63-4" aria-hidden="true" tabindex="-1"></a>mat2</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      n2    N2
[1,] 136 22050</code></pre>
</div>
</div>
<p>Logo, a incidência de câncer nos totalmente cegos é:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a>epiR<span class="sc">::</span><span class="fu">epi.conf</span>(mat2, </span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a>               <span class="at">ctype =</span> <span class="st">"inc.rate"</span>, </span>
<span id="cb65-3"><a href="#cb65-3" aria-hidden="true" tabindex="-1"></a>               <span class="at">method =</span> <span class="st">"exact"</span>, </span>
<span id="cb65-4"><a href="#cb65-4" aria-hidden="true" tabindex="-1"></a>               <span class="at">conf.level =</span> <span class="fl">0.95</span>)<span class="sc">*</span><span class="dv">1000</span></span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      est    lower    upper
n2 6.1678 5.174806 7.295817</code></pre>
</div>
</div>
<p><u>Pessoas com grave deficiência visual</u></p>
<p>Inicialmente, contrói-se a matriz:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a>n3 <span class="ot">&lt;-</span> <span class="dv">1709</span></span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a>N3 <span class="ot">&lt;-</span> <span class="dv">127650</span></span>
<span id="cb67-3"><a href="#cb67-3" aria-hidden="true" tabindex="-1"></a>mat3 <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(<span class="fu">cbind</span> (n3, N3))</span>
<span id="cb67-4"><a href="#cb67-4" aria-hidden="true" tabindex="-1"></a>mat3</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       n3     N3
[1,] 1709 127650</code></pre>
</div>
</div>
<p>Logo, a incidência de câncer nos com grave deficiência visual é:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a>epiR<span class="sc">::</span><span class="fu">epi.conf</span>(mat3, </span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a>               <span class="at">ctype =</span> <span class="st">"inc.rate"</span>, </span>
<span id="cb69-3"><a href="#cb69-3" aria-hidden="true" tabindex="-1"></a>               <span class="at">method =</span> <span class="st">"exact"</span>, </span>
<span id="cb69-4"><a href="#cb69-4" aria-hidden="true" tabindex="-1"></a>               <span class="at">conf.level =</span> <span class="fl">0.95</span>)<span class="sc">*</span><span class="dv">1000</span></span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>        est    lower    upper
n3 13.38817 12.76088 14.03832</code></pre>
</div>
</div>
<p>As saídas mostram que para cada 1000 pessoas cegas (a função foi multiplicada por 1000) acompanhadas por um ano, ocorreu 6,2 ((IC95%: 5,2 – 7,3) casos de câncer. Uma taxa de incidência, praticamente, metade da taxa de incidências das pessoas com deficiência visual grave. Os IC95% não são coincidentes, o que significa que essa diferença é significativa. Houve, na amostra, uma incidência menor de câncer entre os indivíduos totalmente cegos, sugerindo que a melatonina possa ser um fator protetor contra o câncer.</p>
</section>
</section>
<section id="relação-entre-prevalência-e-incidência" class="level3" data-number="18.4.3">
<h3 data-number="18.4.3" class="anchored" data-anchor-id="relação-entre-prevalência-e-incidência"><span class="header-section-number">18.4.3</span> Relação entre prevalência e incidência</h3>
<p>A incidência é uma medida de risco. A prevalência, por não levar em consideração o tempo de duração da doença (<em>t</em>), não tem esta capacidade. Em uma população onde a situação da doença encontra-se em estado estacionário (ou seja, sem grandes migrações ou mudanças ao longo do tempo na incidência/prevalência), a relação entre prevalência e incidência e duração da doença pode ser expressa pela seguinte fórmula <span class="citation" data-cites="szklo2019measuring">(<a href="references.html#ref-szklo2019measuring" role="doc-biblioref">22</a>)</span>:</p>
<p><span class="math display">\[
prevalência \ pontual = incidência \times duração \ da \ doença \ (t)
\]</span></p>
<p>Por exemplo, se a incidência da doença for de 0,8% ao ano e sua duração média (sobrevida após o diagnóstico) for de 10 anos, a prevalência pontual será de aproximadamente 8%.</p>
</section>
</section>
<section id="medidas-de-associação" class="level2" data-number="18.5">
<h2 data-number="18.5" class="anchored" data-anchor-id="medidas-de-associação"><span class="header-section-number">18.5</span> Medidas de associação</h2>
<section id="sec-or" class="level3" data-number="18.5.1">
<h3 data-number="18.5.1" class="anchored" data-anchor-id="sec-or"><span class="header-section-number">18.5.1</span> <em>Odds Ratio</em></h3>
<p><strong>Odds Ratio</strong> (OR) é a razão entre dois <em>odds</em>. A <em>Odds Ratio</em>, traduzida como <em>Razão de Chances</em>, está associada, usualmente, com estudos retrospectivos tipo caso-controle com desfechos dicotômicos.</p>
<p>A <em>odds ratio</em> (OR) expressa a <em>odds</em> de exposição entre os que têm o desfecho (casos) pela <em>odds</em> de exposição nos livres de desfecho (controles).</p>
<div class="cell" data-layout-align="center">
<div id="tbl-2por2" class="cell quarto-float quarto-figure quarto-figure-center anchored" data-layout-align="center">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-2por2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Tabela&nbsp;18.5: Tabela de contingência 2 x 2
</figcaption>
<div aria-describedby="tbl-2por2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://i.imgur.com/KAWIH8W.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:70.0%"></p>
</figure>
</div>
</div>
</div>
</figure>
</div>
</div>
<p>Usando a <a href="#tbl-2por2" class="quarto-xref">Tabela&nbsp;<span>18.5</span></a>, a fórmula <span class="math inline">\(odds =\frac{p}{1 -p}\)</span> e que</p>
<p><span class="math display">\[
p_{exp \ doentes} = \frac{a}{a+c}
\]</span> <span class="math display">\[
p_{exp \ não \ doentes} = \frac{b}{b+d}
\]</span> tem-se:</p>
<p><span class="math display">\[
odds_{exp} \ {casos} = \frac{\frac{a}{a+c}}{1- \frac{a}{a+c}}=\frac{a}{c}
\]</span></p>
<p><span class="math display">\[
odds_{exp} \ {controles} = \frac{\frac{b}{b+d}}{1- \frac{b}{b+d}}=\frac{b}{d}
\]</span></p>
<p>Portanto, a OR é igual a:</p>
<p><span class="math display">\[
OR = \frac{odds_{exp}\ {casos}}{odds_{exp}\ {controles}}=\frac{\frac{a}{c}}{\frac{b}{d}}=\frac{a \times d}{c \times b}
\]</span></p>
<p>Em decorrência da última fórmula, a OR é definida como a razão dos produtos cruzados em uma tabela de contingência 2×2.</p>
<section id="exemplo-2" class="level4" data-number="18.5.1.1">
<h4 data-number="18.5.1.1" class="anchored" data-anchor-id="exemplo-2"><span class="header-section-number">18.5.1.1</span> Exemplo</h4>
<p>Em um estudo de caso-controle hipotético, a distribuição das exposições entre os casos e um grupo de pessoas saudáveis (“controles”) é comparada entre si. Os casos correspondem a um tipo raro de câncer, onde se suspeita que exista uma associação à exposição a um determinado fator de risco.</p>
<p>Os dados desse estudo hipotético estão no arquivo <code>dadosCasoControle.xlsx</code>. O conjunto de dados pode ser obtido <a href="https://github.com/petronioliveira/Arquivos/blob/main/dadosCasoControle.xlsx"><strong>aqui</strong></a>. Depois de salvo em seu diretório de trabalho, ele pode ser carregado com a função <code>read_excel()</code> do pacote <code>readxl</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a>cc <span class="ot">&lt;-</span> readxl<span class="sc">::</span><span class="fu">read_excel</span> (<span class="st">"dados/dadosCasoControle.xlsx"</span>)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>As variáveis <code>cc$exposto</code> e <code>cc$desfecho</code> devem ser transformadas em fatores e na ordem <code>sim</code>, <code>não</code>, uma vez que o R coloca em ordem alfabética (<code>não</code>, <code>sim</code>):</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a>cc<span class="sc">$</span>exposto <span class="ot">&lt;-</span> <span class="fu">factor</span> (cc<span class="sc">$</span>exposto,</span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a>                      <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"sim"</span>, <span class="st">"não"</span>))</span>
<span id="cb72-3"><a href="#cb72-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-4"><a href="#cb72-4" aria-hidden="true" tabindex="-1"></a>cc<span class="sc">$</span>desfecho <span class="ot">&lt;-</span> <span class="fu">factor</span> (cc<span class="sc">$</span>desfecho,</span>
<span id="cb72-5"><a href="#cb72-5" aria-hidden="true" tabindex="-1"></a>                       <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"sim"</span>, <span class="st">"não"</span>))</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Após essa etapa, construir uma tabela <span class="math inline">\(2 \times 2\)</span>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a>tab_cc <span class="ot">&lt;-</span> <span class="fu">table</span> (cc<span class="sc">$</span>exposto, </span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a>                 cc<span class="sc">$</span>desfecho, </span>
<span id="cb73-3"><a href="#cb73-3" aria-hidden="true" tabindex="-1"></a>                 <span class="at">dnn =</span> <span class="fu">c</span>(<span class="st">"Exposição"</span>, <span class="st">"Desfecho"</span>))</span>
<span id="cb73-4"><a href="#cb73-4" aria-hidden="true" tabindex="-1"></a><span class="fu">addmargins</span>(tab_cc)         </span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>         Desfecho
Exposição sim não Sum
      sim  48  20  68
      não  12  40  52
      Sum  60  60 120</code></pre>
</div>
</div>
<p>A OR será obtida utilizando a função <code>epi.2by2()</code> do pacote <code>epiR</code> <span class="citation" data-cites="stevenson2022epir">(<a href="references.html#ref-stevenson2022epir" role="doc-biblioref">4</a>)</span>. Esta função tem os seguintes argumentos:</p>
<ul>
<li><strong>dat</strong> <span class="math inline">\(\longrightarrow\)</span> tabela de contingência <span class="math inline">\(2 \times 2\)</span>;</li>
<li><strong>method</strong> <span class="math inline">\(\longrightarrow\)</span> as opções são “cohort.count”, “cohort.time”, “case.control” ou “cross.sectional”.;</li>
<li><strong>conf.level</strong> <span class="math inline">\(\longrightarrow\)</span> padrão = 0.95;</li>
<li><strong>units</strong> <span class="math inline">\(\longrightarrow\)</span> multiplicador para incidência e prevalência;</li>
<li><strong>outcome</strong> <span class="math inline">\(\longrightarrow\)</span> indicação de como a variável desfecho é representada na tabela de contingência (“as.columns” ou “as.rows”).</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a>epiR<span class="sc">::</span><span class="fu">epi.2by2</span>(tab_cc, </span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a>               <span class="at">method =</span> <span class="st">"case.control"</span>, </span>
<span id="cb75-3"><a href="#cb75-3" aria-hidden="true" tabindex="-1"></a>               <span class="at">conf.level =</span> <span class="fl">0.95</span>, </span>
<span id="cb75-4"><a href="#cb75-4" aria-hidden="true" tabindex="-1"></a>               <span class="at">units =</span> <span class="dv">100</span>, </span>
<span id="cb75-5"><a href="#cb75-5" aria-hidden="true" tabindex="-1"></a>               <span class="at">outcome =</span> <span class="st">"as.columns"</span>)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>             Outcome +    Outcome -      Total                       Odds
Exposed +           48           20         68        2.40 (1.43 to 4.23)
Exposed -           12           40         52        0.30 (0.13 to 0.53)
Total               60           60        120        1.00 (0.69 to 1.45)

Point estimates and 95% CIs:
-------------------------------------------------------------------
Exposure odds ratio                            8.00 (3.49, 18.34)
Attrib fraction (est) in the exposed (%)      87.24 (69.26, 95.03)
Attrib fraction (est) in the population (%)   70.00 (48.69, 82.46)
-------------------------------------------------------------------
Uncorrected chi2 test that OR = 1: chi2(1) = 26.606 Pr&gt;chi2 = &lt;0.001
Fisher exact test that OR = 1: Pr&gt;chi2 = &lt;0.001
 Wald confidence limits
 CI: confidence interval</code></pre>
</div>
</div>
<p>A saída exibe os dados em uma tabela <span class="math inline">\(2 \times 2\)</span>, mostrando as <code>odds</code> e os IC95% e outras estatísticas epidemiológicas relacionadas.</p>
<p>A OR varia de zero ao infinito. Quando o valor da OR se aproxima de 1, a doença e o fator de risco não estão associados. Acima de 1 significa que existe associação e valores menores de 1 indicam uma associação negativa (efeito protetor).</p>
<p>No exemplo hipotético, os indivíduos que se expuseram ao fator de risco têm uma chance 8 vezes maior de apresentar este tipo de câncer. O valor <em>P</em> do qui-quadrado é altamente significativo (<em>P</em> &lt; 0,001).</p>
</section>
</section>
<section id="sec-rr" class="level3" data-number="18.5.2">
<h3 data-number="18.5.2" class="anchored" data-anchor-id="sec-rr"><span class="header-section-number">18.5.2</span> Risco Relativo</h3>
<p>O <em>Risco relativo</em> (RR) é a razão entre a incidência de desfecho em indivíduos expostos e a incidência de desfecho em indivíduos não expostos. O RR estima a magnitude da associação entre a exposição e o desfecho (doença). Em outras palavras, compara a probabilidade de ocorrência do desfecho entre os indivíduos expostos com a probabilidade de ocorrência do desfecho nos indivíduos não expostos.</p>
<p>A partir da tabela de contingência <span class="math inline">\(2 \times 2\)</span> (<a href="#tbl-2por2" class="quarto-xref">Tabela&nbsp;<span>18.5</span></a>), tem-se que o estimador do RR é dado por:</p>
<p><span class="math display">\[
RR = \frac{incidência_{exp}}{incidência_{não \ exp}}=\frac{\frac{a}{a + b}}{\frac{c}{c + d}}
\]</span></p>
<section id="exemplo-3" class="level4" data-number="18.5.2.1">
<h4 data-number="18.5.2.1" class="anchored" data-anchor-id="exemplo-3"><span class="header-section-number">18.5.2.1</span> Exemplo</h4>
<p>Em 1940, ocorreu um surto de gastroenterite, após um jantar, em uma igreja, na cidade de Lycoming, Condado de Oswego, Nova York. Das 80 pessoas presentes, 75 foram entrevistadas. Quarenta e seis relataram doença gastrointestinal, atendendo à definição de caso.</p>
<p>As taxas de ataque (incidência) foram calculadas para aqueles que comeram e não comeram cada um dos 14 itens alimentares consumidos na ceia <span class="citation" data-cites="gross1976oswego">(<a href="references.html#ref-gross1976oswego" role="doc-biblioref">23</a>)</span>. O pacote <code>epitools</code> <span class="citation" data-cites="aragon2020epitools">(<a href="references.html#ref-aragon2020epitools" role="doc-biblioref">24</a>)</span> contém os dados desta investigação no arquivo <code>oswego</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(oswego)</span>
<span id="cb77-2"><a href="#cb77-2" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(oswego)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>'data.frame':   75 obs. of  21 variables:
 $ id                 : int  2 3 4 6 7 8 9 10 14 16 ...
 $ age                : int  52 65 59 63 70 40 15 33 10 32 ...
 $ sex                : chr  "F" "M" "F" "F" ...
 $ meal.time          : chr  "8:00 PM" "6:30 PM" "6:30 PM" "7:30 PM" ...
 $ ill                : chr  "Y" "Y" "Y" "Y" ...
 $ onset.date         : chr  "4/19" "4/19" "4/19" "4/18" ...
 $ onset.time         : chr  "12:30 AM" "12:30 AM" "12:30 AM" "10:30 PM" ...
 $ baked.ham          : chr  "Y" "Y" "Y" "Y" ...
 $ spinach            : chr  "Y" "Y" "Y" "Y" ...
 $ mashed.potato      : chr  "Y" "Y" "N" "N" ...
 $ cabbage.salad      : chr  "N" "Y" "N" "Y" ...
 $ jello              : chr  "N" "N" "N" "Y" ...
 $ rolls              : chr  "Y" "N" "N" "N" ...
 $ brown.bread        : chr  "N" "N" "N" "N" ...
 $ milk               : chr  "N" "N" "N" "N" ...
 $ coffee             : chr  "Y" "Y" "Y" "N" ...
 $ water              : chr  "N" "N" "N" "Y" ...
 $ cakes              : chr  "N" "N" "Y" "N" ...
 $ vanilla.ice.cream  : chr  "Y" "Y" "Y" "Y" ...
 $ chocolate.ice.cream: chr  "N" "Y" "Y" "N" ...
 $ fruit.salad        : chr  "N" "N" "N" "N" ...</code></pre>
</div>
</div>
<p>Existem 75 observações de 21 variáveis, algumas características dos indivíduos como idade, sexo, etc. Importante para a análise é a variável <code>ill</code> (Y – sim, doente; N – não doente) e a variáveis relacionadas aos alimentos ingeridos durante o jantar na igreja. O sorvete de baunilha foi considerado o principal responsável pelo surto.</p>
<p>A seguir, as variáveis <code>oswego$vanilla.ice.cream</code> e <code>oswego$ill</code> <a href="#fn3" class="footnote-ref" id="fnref3" role="doc-noteref"><sup>3</sup></a> serão transformadas em fator e os níveis colocados na ordem <code>Y</code>, <code>N</code>, uma vez que o R coloca em ordem alfabética (<code>N</code>, <code>Y</code>) :</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a>oswego<span class="sc">$</span>ill <span class="ot">&lt;-</span> <span class="fu">factor</span> (oswego<span class="sc">$</span>ill,</span>
<span id="cb79-2"><a href="#cb79-2" aria-hidden="true" tabindex="-1"></a>                      <span class="at">levels =</span> <span class="fu">c</span> (<span class="st">"Y"</span>, <span class="st">"N"</span>))</span>
<span id="cb79-3"><a href="#cb79-3" aria-hidden="true" tabindex="-1"></a>oswego<span class="sc">$</span>vanilla.ice.cream <span class="ot">&lt;-</span> <span class="fu">factor</span> (oswego<span class="sc">$</span>vanilla.ice.cream,</span>
<span id="cb79-4"><a href="#cb79-4" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">levels =</span> <span class="fu">c</span> (<span class="st">"Y"</span>, <span class="st">"N"</span>))</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Realizada essa etapa, será construída uma tabela para o cálculo do RR:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a>tab_vanilla <span class="ot">&lt;-</span> <span class="fu">table</span> (oswego<span class="sc">$</span>vanilla.ice.cream, </span>
<span id="cb80-2"><a href="#cb80-2" aria-hidden="true" tabindex="-1"></a>                      oswego<span class="sc">$</span>ill, </span>
<span id="cb80-3"><a href="#cb80-3" aria-hidden="true" tabindex="-1"></a>                      <span class="at">dnn =</span> <span class="fu">c</span> (<span class="st">"Vanilla"</span>, <span class="st">"Ill"</span>))</span>
<span id="cb80-4"><a href="#cb80-4" aria-hidden="true" tabindex="-1"></a>tab_vanilla            </span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       Ill
Vanilla  Y  N
      Y 43 11
      N  3 18</code></pre>
</div>
</div>
<p>O RR será obtido, utilizando a função <code>epi.2by2()</code> do pacote <code>epiR</code>, cujos argumentos foram mostrados no cálculo da OR, mudando a tabela para <code>tab_vanilla</code> e <code>method = “cohort.count”</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a>epiR<span class="sc">::</span><span class="fu">epi.2by2</span>(tab_vanilla, </span>
<span id="cb82-2"><a href="#cb82-2" aria-hidden="true" tabindex="-1"></a>               <span class="at">method =</span> <span class="st">"cohort.count"</span>, </span>
<span id="cb82-3"><a href="#cb82-3" aria-hidden="true" tabindex="-1"></a>               <span class="at">conf.level =</span> <span class="fl">0.95</span>, </span>
<span id="cb82-4"><a href="#cb82-4" aria-hidden="true" tabindex="-1"></a>               <span class="at">units =</span> <span class="dv">100</span>, </span>
<span id="cb82-5"><a href="#cb82-5" aria-hidden="true" tabindex="-1"></a>               <span class="at">outcome =</span> <span class="st">"as.columns"</span>)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>             Outcome +    Outcome -      Total                 Inc risk *
Exposed +           43           11         54     79.63 (66.47 to 89.37)
Exposed -            3           18         21      14.29 (3.05 to 36.34)
Total               46           29         75     61.33 (49.38 to 72.36)

Point estimates and 95% CIs:
-------------------------------------------------------------------
Inc risk ratio                                 5.57 (1.94, 16.03)
Inc odds ratio                                 23.45 (5.84, 94.18)
Attrib risk in the exposed *                   65.34 (46.92, 83.77)
Attrib fraction in the exposed (%)            82.06 (48.41, 93.76)
Attrib risk in the population *                47.05 (28.46, 65.63)
Attrib fraction in the population (%)         76.71 (37.11, 91.37)
-------------------------------------------------------------------
Uncorrected chi2 test that OR = 1: chi2(1) = 27.223 Pr&gt;chi2 = &lt;0.001
Fisher exact test that OR = 1: Pr&gt;chi2 = &lt;0.001
 Wald confidence limits
 CI: confidence interval
 * Outcomes per 100 population units </code></pre>
</div>
</div>
<p>Os resultados da saída indicam que os indivíduos que ingeriram sorvete de baunilha (n = 54) tiveram um risco maior de desenvolver gastrenterite aguda quando comparado aos que não ingeriram (n = 21). Dividindo o risco dos indivíduos expostos (incidência = 79,6) pelo risco dos não expostos (incidência = 14,3), encontra-se o RR = 5,57. Isso confirma que o sorvete de baunilha foi o principal responsável.</p>
<p>Quanto maior o RR mais forte é a associação entre a doença em questão e a exposição ao fator de risco. Um RR = 1 indica que a doença e a exposição ao fator de risco não estão associadas. Valores &lt; 1 indicam uma associação negativa entre o fator de risco e a doença (efeito protetor).</p>
</section>
</section>
<section id="odds-ratio-vs-risco-relativo" class="level3" data-number="18.5.3">
<h3 data-number="18.5.3" class="anchored" data-anchor-id="odds-ratio-vs-risco-relativo"><span class="header-section-number">18.5.3</span> <em>Odds Ratio</em> vs Risco Relativo</h3>
<p>A OR não deve ser entendida como uma medida aproximada do RR, exceto para doenças raras (doenças, em geral com prevalência menor do que 10%). Caso contrário, a OR tenderá a superestimar a magnitude da associação e o OR afasta-se da hipótese nula da não associação (OR =1), independentemente de ser um fator de risco ou de proteção. A discrepância (d)<a href="#fn4" class="footnote-ref" id="fnref4" role="doc-noteref"><sup>4</sup></a> entre as estimativas do RR e OR pode ser definido como a razão entre o OR e o RR estimados <span class="citation" data-cites="szklo2019associations">(<a href="references.html#ref-szklo2019associations" role="doc-biblioref">25</a>)</span>. Em outras palavras, a discrepância corresponde a uma proporção do RR <span class="citation" data-cites="davies1998can">(<a href="references.html#ref-davies1998can" role="doc-biblioref">26</a>)</span>.</p>
<p><span class="math display">\[
d = \frac {1- p_{não \ exp}}{1- p_{exp}}= \frac{\frac{c}{c + d}}{\frac{a}{a + b}}
\]</span></p>
<p>Logo,</p>
<p><span class="math display">\[
OR = RR \times d
\]</span></p>
<p>Para finalizar, uma comparação entre OR e RR é mostrada na <a href="#tbl-magnitude" class="quarto-xref">Tabela&nbsp;<span>18.6</span></a> <span class="citation" data-cites="hopkins2016scales">(<a href="references.html#ref-hopkins2016scales" role="doc-biblioref">27</a>)</span>.</p>
<div class="cell">
<div id="tbl-magnitude" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-magnitude-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Tabela&nbsp;18.6: Força de associação do RR comparado com a OR.
</figcaption>
<div aria-describedby="tbl-magnitude-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<div class="tabwid"><style>.cl-3080dd00{}.cl-307487e4{font-family:'Arial';font-size:11pt;font-weight:bold;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-307487f8{font-family:'Arial';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-3079bf16{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-307a0a34{width:0.727in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-307a0a48{width:1.253in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-307a0a49{width:0.727in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-307a0a52{width:1.253in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-307a0a53{width:0.727in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-307a0a5c{width:1.253in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-307a0a5d{width:0.727in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-307a0a66{width:1.253in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-307a0a67{width:0.727in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-307a0a70{width:1.253in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-307a0a7a{width:0.727in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-307a0a7b{width:1.253in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table data-quarto-disable-processing="true" class="cl-3080dd00"><thead><tr style="overflow-wrap:break-word;"><th class="cl-307a0a34"><p class="cl-3079bf16"><span class="cl-307487e4">OR</span></p></th><th class="cl-307a0a34"><p class="cl-3079bf16"><span class="cl-307487e4">RR</span></p></th><th class="cl-307a0a48"><p class="cl-3079bf16"><span class="cl-307487e4">Magnitude</span></p></th></tr></thead><tbody><tr style="overflow-wrap:break-word;"><td class="cl-307a0a49"><p class="cl-3079bf16"><span class="cl-307487f8">1,0</span></p></td><td class="cl-307a0a49"><p class="cl-3079bf16"><span class="cl-307487f8">1,0</span></p></td><td class="cl-307a0a52"><p class="cl-3079bf16"><span class="cl-307487f8">insignificante</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-307a0a53"><p class="cl-3079bf16"><span class="cl-307487f8">1,5</span></p></td><td class="cl-307a0a53"><p class="cl-3079bf16"><span class="cl-307487f8">1,2</span></p></td><td class="cl-307a0a5c"><p class="cl-3079bf16"><span class="cl-307487f8">pequena</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-307a0a53"><p class="cl-3079bf16"><span class="cl-307487f8">3,5</span></p></td><td class="cl-307a0a53"><p class="cl-3079bf16"><span class="cl-307487f8">1,9</span></p></td><td class="cl-307a0a5c"><p class="cl-3079bf16"><span class="cl-307487f8">moderada</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-307a0a5d"><p class="cl-3079bf16"><span class="cl-307487f8">9,0</span></p></td><td class="cl-307a0a5d"><p class="cl-3079bf16"><span class="cl-307487f8">3,0</span></p></td><td class="cl-307a0a66"><p class="cl-3079bf16"><span class="cl-307487f8">grande</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-307a0a5d"><p class="cl-3079bf16"><span class="cl-307487f8">32</span></p></td><td class="cl-307a0a5d"><p class="cl-3079bf16"><span class="cl-307487f8">5,7</span></p></td><td class="cl-307a0a66"><p class="cl-3079bf16"><span class="cl-307487f8">muito grande</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-307a0a67"><p class="cl-3079bf16"><span class="cl-307487f8">360</span></p></td><td class="cl-307a0a67"><p class="cl-3079bf16"><span class="cl-307487f8">19</span></p></td><td class="cl-307a0a70"><p class="cl-3079bf16"><span class="cl-307487f8">quase perfeita</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-307a0a7a"><p class="cl-3079bf16"><span class="cl-307487f8">infinito</span></p></td><td class="cl-307a0a7a"><p class="cl-3079bf16"><span class="cl-307487f8">infinito</span></p></td><td class="cl-307a0a7b"><p class="cl-3079bf16"><span class="cl-307487f8">perfeita</span></p></td></tr></tbody></table></div>
</div>
</div>
</figure>
</div>
</div>
</section>
<section id="razão-de-prevalência" class="level3" data-number="18.5.4">
<h3 data-number="18.5.4" class="anchored" data-anchor-id="razão-de-prevalência"><span class="header-section-number">18.5.4</span> Razão de Prevalência</h3>
<p>Quando dados transversais estão disponíveis, muitas vezes as associações são avaliadas, usando a <em>razão de prevalência pontual</em> (RPP).</p>
<p>Tendo o mesmo princípio das duas medidas anteriores, a razão de prevalência (RPP) compara a prevalência do desfecho entre os expostos com a prevalência do desfecho entre os não expostos.</p>
<p>Matematicamente, a RPP é calculada de maneira semelhante ao RR. Apenas, deve-se ter em mente que o desfecho e a exposição foram medidos no mesmo momento, enquanto para o cálculo do RR há necessidade de calcular a incidência.</p>
<p>Tomando como base a estrutura da tabela de contingência 2 x 2 , <a href="#tbl-2por2" class="quarto-xref">Tabela&nbsp;<span>18.5</span></a>, tem-se:</p>
<p><span class="math display">\[
RPP = \frac{prevalência \ de \ doença_{exp}}{prevalência \ de \ doença_{não \ exp}}=\frac{\frac{a}{a + b}}{\frac{c}{c + d}}
\]</span></p>
<p>Também é possível verificar a prevalência de exposição entre doentes e não doentes:</p>
<p><span class="math display">\[
RPP = \frac{prevalência \ de \ exposição_{doentes}}{prevalência \ de \ exposição_{não \ doentes}}=\frac{\frac{a}{a + c}}{\frac{b}{b + d}}
\]</span></p>
<section id="exemplo-4" class="level4" data-number="18.5.4.1">
<h4 data-number="18.5.4.1" class="anchored" data-anchor-id="exemplo-4"><span class="header-section-number">18.5.4.1</span> Exemplo</h4>
<p>Em um estudo transversal <span class="citation" data-cites="madi2010prevalence">(<a href="references.html#ref-madi2010prevalence" role="doc-biblioref">28</a>)</span>, foi verificada a prevalência de infecções congênitas entre as puérperas com idade igual ou acima de 20 anos comparadas às mulheres com menos de 20 anos (adolescentes). A hipótese foi de que as adolescentes tinham uma prevalência maior de infecções.</p>
<p>Parte dos dados estão no arquivo <code>dadosMater.xlsx</code>, que contém, como já mencionado, informações de 1368 nascimentos. Entre essas, tem-se a idade das mães (<code>idadeMae</code>) e se foi diagnosticada infecção congênita (<code>infCong</code>).</p>
<p>O arquivo pode ser obtido <a href="https://github.com/petronioliveira/Arquivos/blob/main/dadosMater.xlsx"><strong>aqui</strong></a>. Depois de salvo em seu diretório de trabalho, ele pode ser carregado com a função <code>read_excel()</code> do pacote <code>readxl</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a>dados <span class="ot">&lt;-</span> readxl<span class="sc">::</span><span class="fu">read_excel</span> (<span class="st">"dados/dadosMater.xlsx"</span>)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>A partir da variável <code>idadeMae</code>, criar a variável <code>faixaEtaria</code>, dividindo as parturientes em menores de 20 anos (adolescentes) e ≥ 20 anos. Para isso, usou-se a função <code>cut()</code> do pacote base. Revise os argumentos desta função.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb85"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a>dados<span class="sc">$</span>faixaEtaria <span class="ot">&lt;-</span> <span class="fu">cut</span> (dados<span class="sc">$</span>idadeMae,</span>
<span id="cb85-2"><a href="#cb85-2" aria-hidden="true" tabindex="-1"></a>                          <span class="at">breaks=</span><span class="fu">c</span>(<span class="dv">13</span>,<span class="dv">20</span>,<span class="dv">46</span>),</span>
<span id="cb85-3"><a href="#cb85-3" aria-hidden="true" tabindex="-1"></a>                          <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"&lt;20a"</span>,<span class="st">"=&gt;20a"</span>),</span>
<span id="cb85-4"><a href="#cb85-4" aria-hidden="true" tabindex="-1"></a>                          <span class="at">right =</span> <span class="cn">FALSE</span>,</span>
<span id="cb85-5"><a href="#cb85-5" aria-hidden="true" tabindex="-1"></a>                          <span class="at">include.lowest =</span> <span class="cn">TRUE</span>)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>A variável <code>ìnfCong</code> encontra-se como uma variável numérica e deve ser transformada em fator:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb86"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a>dados<span class="sc">$</span>infCong <span class="ot">&lt;-</span> <span class="fu">factor</span> (dados<span class="sc">$</span>infCong,</span>
<span id="cb86-2"><a href="#cb86-2" aria-hidden="true" tabindex="-1"></a>                         <span class="at">ordered =</span> <span class="cn">TRUE</span>, </span>
<span id="cb86-3"><a href="#cb86-3" aria-hidden="true" tabindex="-1"></a>                         <span class="at">levels =</span> <span class="fu">c</span> (<span class="dv">1</span>,<span class="dv">2</span>),</span>
<span id="cb86-4"><a href="#cb86-4" aria-hidden="true" tabindex="-1"></a>                         <span class="at">labels =</span> <span class="fu">c</span> (<span class="st">"sim"</span>, <span class="st">"não"</span>))</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Após estes procedimentos, constroi-se uma tabela <span class="math inline">\(2 \times 2\)</span>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb87"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a>tab_infCong <span class="ot">&lt;-</span> <span class="fu">table</span>(dados<span class="sc">$</span>faixaEtaria,</span>
<span id="cb87-2"><a href="#cb87-2" aria-hidden="true" tabindex="-1"></a>                     dados<span class="sc">$</span>infCong,</span>
<span id="cb87-3"><a href="#cb87-3" aria-hidden="true" tabindex="-1"></a>                     <span class="at">dnn =</span> <span class="fu">c</span>(<span class="st">"Faixa Etária"</span>, <span class="st">"Inf. Cong."</span>))</span>
<span id="cb87-4"><a href="#cb87-4" aria-hidden="true" tabindex="-1"></a><span class="fu">addmargins</span>(tab_infCong)            </span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>            Inf. Cong.
Faixa Etária  sim  não  Sum
       &lt;20a     7  212  219
       =&gt;20a  119 1030 1149
       Sum    126 1242 1368</code></pre>
</div>
</div>
<p><u>Cálculo da RPP</u></p>
<p>Usando a tabela <code>tab_infCong</code> com a função <code>epi.2by2()</code> do pacote <code>epiR</code>, cujos argumentos foram mostrados no cálculo da OR e RR, e mudando a tabela para <code>tab_infCong</code> e <code>method = “cross.sectional”</code>, obtem-se:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb89"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a>epiR<span class="sc">::</span><span class="fu">epi.2by2</span>(tab_infCong, </span>
<span id="cb89-2"><a href="#cb89-2" aria-hidden="true" tabindex="-1"></a>               <span class="at">method =</span> <span class="st">"cross.sectional"</span>, </span>
<span id="cb89-3"><a href="#cb89-3" aria-hidden="true" tabindex="-1"></a>               <span class="at">conf.level =</span> <span class="fl">0.95</span>, </span>
<span id="cb89-4"><a href="#cb89-4" aria-hidden="true" tabindex="-1"></a>               <span class="at">units =</span> <span class="dv">100</span>, </span>
<span id="cb89-5"><a href="#cb89-5" aria-hidden="true" tabindex="-1"></a>               <span class="at">outcome =</span> <span class="st">"as.columns"</span>)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>             Outcome +    Outcome -      Total               Prev risk *
Exposed +            7          212        219       3.20 (1.29 to 6.47)
Exposed -          119         1030       1149     10.36 (8.65 to 12.26)
Total              126         1242       1368      9.21 (7.73 to 10.87)

Point estimates and 95% CIs:
-------------------------------------------------------------------
Prev risk ratio                                0.31 (0.15, 0.65)
Prev odds ratio                                0.29 (0.13, 0.62)
Attrib prev in the exposed *                   -7.16 (-10.08, -4.24)
Attrib fraction in the exposed (%)            -224.02 (-584.89, -53.29)
Attrib prev in the population *                -1.15 (-3.48, 1.19)
Attrib fraction in the population (%)         -12.45 (-17.53, -7.58)
-------------------------------------------------------------------
Uncorrected chi2 test that OR = 1: chi2(1) = 11.278 Pr&gt;chi2 = &lt;0.001
Fisher exact test that OR = 1: Pr&gt;chi2 = &lt;0.001
 Wald confidence limits
 CI: confidence interval
 * Outcomes per 100 population units </code></pre>
</div>
</div>
<p>A saída exibe várias informações. Foi feita a hipótese de uma maior prevalência entre as mulheres com menos de 20 anos. Por este motivo, elas aparecem como as expostas (<code>Exposed +</code>) e tem uma prevalência de 3,20/100, enquanto as mulheres com mais de 20 anos tiveram uma prevalência de 10,36/100. Isto mostra que a razão de prevalência é igual a 0,31 (IC95%: 0,15-0,65)<a href="#fn5" class="footnote-ref" id="fnref5" role="doc-noteref"><sup>5</sup></a>, ou seja, abaixo de 1, sugerindo que ao contrário da hipótese inicial, as adolescentes têm, neste estudo, uma menor prevalência de infecções congênitas.</p>
</section>
</section>
</section>
<section id="medidas-de-impacto" class="level2" data-number="18.6">
<h2 data-number="18.6" class="anchored" data-anchor-id="medidas-de-impacto"><span class="header-section-number">18.6</span> Medidas de impacto</h2>
<section id="risco-atribuível" class="level3" data-number="18.6.1">
<h3 data-number="18.6.1" class="anchored" data-anchor-id="risco-atribuível"><span class="header-section-number">18.6.1</span> Risco Atribuível</h3>
<p>O <em>Risco Atribuível</em> (RA) possui características de medida de impacto. O RA, ao invés de concentrar-se na associação em si, refere-se mais às consequências e às repercussões da exposição sobre a ocorrência do desfecho.</p>
<p>O RA é a medida do excesso ou acréscimo absoluto de risco que pode ser atribuído à exposição <span class="citation" data-cites="szklo2019ar">(<a href="references.html#ref-szklo2019ar" role="doc-biblioref">29</a>)</span>. Com o RA é possível estimar o número de casos que podem ser prevenidos se a exposição for eliminada e assim estimar a magnitude do impacto, em termos de saúde pública, imposto por esta exposição.</p>
<p>O risco de desenvolver o desfecho (incidência) está aumentado em RA nos indivíduos expostos em comparação com os que não estão expostos. Nos estudos de coorte, costuma-se usar mais a expressão <em>Risco Atribuível</em> ou <em>Diferença de Risco</em>. Nos ensaios clínicos, usa-se mais a expressão <em>Redução Absoluta do Risco</em> (RAR), pois se espera que a intervenção reduza o risco.</p>
<p>Calcula-se o RA ou a RAR pela diferença absoluta entre as incidências dos expostos e não expostos:</p>
<p><span class="math display">\[
RA = \left|I_{expostos} - I_{não \ expostos}\right|
\]</span></p>
<p>Utilizando a tabela de contingência <span class="math inline">\(2 \times 2\)</span> (<a href="#tbl-2por2" class="quarto-xref">Tabela&nbsp;<span>18.5</span></a>), o RA fica expresso da seguinte maneira:</p>
<p><span class="math display">\[
RA = \left|\frac{a}{a + b} -\frac{c}{c + d}\right|
\]</span></p>
<p>No exemplo do Risco Relativo, o RA pode ser calculado usando a mesma tabela de contingência, repetida aqui para facilitar a leitura (<a href="#tbl-vanilla" class="quarto-xref">Tabela&nbsp;<span>18.7</span></a>):</p>
<div class="cell" data-layout-align="center">
<div id="tbl-vanilla" class="cell quarto-float quarto-figure quarto-figure-center anchored" data-layout-align="center">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-vanilla-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Tabela&nbsp;18.7: Taxa de ataque de gastrenterite com sorvete de baunilha - Oswego
</figcaption>
<div aria-describedby="tbl-vanilla-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://i.imgur.com/mT8id4Q.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:70.0%"></p>
</figure>
</div>
</div>
</div>
</figure>
</div>
</div>
<p>Logo,</p>
<p><span class="math display">\[
RA = \left|\frac{43}{43 + 11} -\frac{3}{3 + 18}\right| = \left|0,796 - 0,143\right| = 0,653
\]</span></p>
<p>O risco atribuível na exposição mede o excesso de risco associado a uma determinada categoria de exposição. Por exemplo, com base no exemplo, a incidência cumulativa de gastrenterite aguda entre os indivíduos que comeram o sorvete de baunilha é de 79,6% e para os que não ingeriram o sorvete (categoria de referência ou não exposta) foi de 14,3%. Desta forma, o risco excessivo associado à exposição 79,6 – 14,3 = 65,3%. Ou seja, assumindo uma associação causal (sem confusão ou viés), a não ocorrência da festa diminuiria o risco no grupo exposto de 79,6% para 14,3%.</p>
<p>O RA expresso em relação à incidência nos expostos e apresentado em percentual é denominado de <em>Risco Atribuível Proporcional</em> (RAP) ou <em>Fração Atribuível nos Expostos</em>.</p>
<p>O RAP informa qual a proporção de desfecho, expresso em percentagem, entre os expostos que poderia ter sido prevenida se a exposição fosse eliminada. É dado pela fórmula:</p>
<p><span class="math display">\[
RAP = \left(\frac{I_{expostos} - I_{não \ expostos}}{I_{expostos}}\right) \times 100
\]</span></p>
<p>No exemplo do surto de gastrenterite aguda no jantar da igreja de Oswego (<a href="#sec-rr" class="quarto-xref"><span>Seção 18.5.2</span></a>), tem-se:</p>
<p><span class="math display">\[
RAP = \left(\frac{0,796 - 0,143}{0,796}\right) \times 100 = 82,06 \%
\]</span></p>
<p>Se a causalidade foi estabelecida, essa medida pode ser interpretada como a porcentagem do risco total de gastrenterite aguda que é atribuível à ingesta de sorvete de baunilha.</p>
<p>Outra maneira de se chegar a este mesmo resultado é através do RR, usando a seguinte fórmula</p>
<p><span class="math display">\[
RAP = \left(\frac{I_{expostos} - I_{não \ expostos}}{I_{expostos}}\right) \times 100
\]</span></p>
<p><span class="math display">\[
RAP = \left(\frac{I_{expostos}}{I_{expostos}} - \frac{I_{não \ expostos }}{I_{expostos}}\right) \times 100
\]</span></p>
<p><span class="math display">\[
RAP = \left(1 - \frac{1}{\frac{I_{expostos }}{I_{não \ expostos}}}\right) \times 100
\]</span></p>
<p><span class="math display">\[
RAP = \left(1 - \frac{1}{RR}\right) \times 100
\]</span></p>
<p><span class="math display">\[
RAP = \left(\frac{RR - 1}{RR}\right) \times 100
\]</span></p>
<p>No exemplo, o RR é igual a 5,57, logo:</p>
<p><span class="math display">\[
RAP = \left(\frac{5,57 - 1}{5,57}\right) \times 100 = 82,05\%
\]</span></p>
</section>
<section id="redução-relativa-do-risco" class="level3" data-number="18.6.2">
<h3 data-number="18.6.2" class="anchored" data-anchor-id="redução-relativa-do-risco"><span class="header-section-number">18.6.2</span> Redução Relativa do Risco</h3>
<p>Quando se avalia um tratamento ou alguma intervenção em que se suponha haver uma redução do risco — por exemplo, o uso da aspirina para reduzir a ocorrência de infarto agudo do miocárdio —, o termo <em>Risco Atribuível</em> é substituído por <em>Redução do Risco Atribuível</em> e é calculado da mesma forma apresentada na equação do Risco Atribuível.</p>
<p>Neste caso, ao invés de usar o Risco Atribuível Proporcional (RAP), onde se pressupõe que a exposição é um fator de risco para a doença e o RR <span class="math inline">\(&lt;\)</span> 1, usa-se a <em>Redução Relativa do Risco</em>, pois a exposição é supostamente um fator protetor, como se espera que ocorra nos ensaios clínicos.</p>
<p>Esta medida, análoga ao RAP, é também chamada de <em>Eficácia</em>, definida como a proporção da incidência nos indivíduos não tratados (por exemplo, o grupo controle) que é reduzida pela intervenção <span class="citation" data-cites="szklo2019rrr">(<a href="references.html#ref-szklo2019rrr" role="doc-biblioref">30</a>)</span>.</p>
<p>O cálculo da <strong>Redução Relativa do Risco</strong> (RRR) é semelhante ao Risco Atribuível Proporcional (RAP), onde a incidência nos expostos é a incidência no grupo que recebeu a intervenção (ou taxa de eventos no grupo tratamento) e a incidência nos não expostos é incidência nos controles (ou taxa de eventos nos controles – TEC). Como se supõe que a incidência nos controles seja maior que a incidência no grupo de tratamento, a equação fica:</p>
<p><span class="math display">\[
RRR = \left(\frac{I_{controle} - I_{tratamento}}{I_{controle}}\right) \times 100
\]</span></p>
<p>Alternativamente, a RRR pode ser estimada pela equação:</p>
<p><span class="math display">\[
RRR = \left(1 - RR\right) \times 100
\]</span></p>
<p>O <em>Physicians’ Health Study</em> <span class="citation" data-cites="steering1989final">(<a href="references.html#ref-steering1989final" role="doc-biblioref">31</a>)</span> é um ensaio clinico randomizado controlado, duplo cego, desenhado com o objetivo de determinar se uma dose baixa de aspirina (325 mg a cada 48 horas) diminui a mortalidade cardiovascular e se o betacaroteno reduz a incidência de câncer. Participaram deste estudo 22071 indivíduos por uma média de 60,2 meses.</p>
<p>O estudo do componente aspirina mostrou os seguintes resultados (<a href="#tbl-aspirina" class="quarto-xref">Tabela&nbsp;<span>18.8</span></a>):</p>
<div class="cell" data-layout-align="center">
<div id="tbl-aspirina" class="cell quarto-float quarto-figure quarto-figure-center anchored" data-layout-align="center">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-aspirina-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Tabela&nbsp;18.8: Physicians’ Health Study, componente aspirina e IAM
</figcaption>
<div aria-describedby="tbl-aspirina-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://i.imgur.com/9VbWEsX.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:70.0%"></p>
</figure>
</div>
</div>
</div>
</figure>
</div>
</div>
<p>A incidência cumulativa de Infarto Agudo de Miocárdio (IAM) em ambos os grupos foi:</p>
<p><span class="math display">\[
Incidencia_{aspirina} = \frac{139}{11037} = 0,0126
\]</span></p>
<p><span class="math display">\[
Incidencia_{placebo} = \frac{239}{11034} = 0,0217
\]</span></p>
<p><span class="math display">\[
RR = \frac{0,0126}{0,0217} = 0,58
\]</span></p>
<p>Logo, a RRR é igual a:</p>
<p><span class="math display">\[
RRR = \left(1 - 0,58\right) \times 100 = 42\%
\]</span></p>
<p>Ou seja, houve uma redução de 42% no risco de IAM no grupo que usou aspirina e a conclusão dos autores foi que este ensaio clínico demonstrou, em relação à prevenção primária de doença cardiovascular, uma diminuição no risco de IAM.</p>
<p>Estes cálculos podem ser realizados com a função <code>risks()</code> do pacote <code>MKmisc</code> <span class="citation" data-cites="kohl2019package">(<a href="references.html#ref-kohl2019package" role="doc-biblioref">32</a>)</span>. Esta função calcula o risco relativo (RR), odds ratio (OR), redução relativa do risco (RRR) e outras estatísticas epidemiológicas, como RAR, NNT.</p>
<p>A função <code>risks()</code> usa como argumento:</p>
<ul>
<li><strong>p0</strong> <span class="math inline">\(\longrightarrow\)</span> incidência do desfecho de interesse no grupo não exposto;</li>
<li><strong>p1</strong> <span class="math inline">\(\longrightarrow\)</span> incidência do desfecho de interesse no grupo exposto.</li>
</ul>
<p>Além disso, para o seu funcionamento, deve-se ter instalado o pacote <code>BiocManager</code> para poder instalar o pacote <code>limma</code>, necessário para a execução do pacote <code>MKmisc.</code> Veja início do capítulo em pacotes usados neste capítulo.</p>
<p>A função <code>risks()</code> será usada dentro da função <code>round()</code> para reduzir o número de dígitos decimais:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb91"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a>p0 <span class="ot">&lt;-</span> <span class="fl">0.0217</span></span>
<span id="cb91-2"><a href="#cb91-2" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fl">0.0126</span></span>
<span id="cb91-3"><a href="#cb91-3" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(MKmisc<span class="sc">::</span><span class="fu">risks</span>(p0,p1), <span class="dv">4</span>)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      p0       p1       RR       OR      RRR      ARR      NNT 
  0.0217   0.0126   0.5806   0.5753   0.4194   0.0091 109.8901 </code></pre>
</div>
</div>
</section>
<section id="número-necessário-para-tratar" class="level3" data-number="18.6.3">
<h3 data-number="18.6.3" class="anchored" data-anchor-id="número-necessário-para-tratar"><span class="header-section-number">18.6.3</span> Número Necessário para Tratar</h3>
<p>Os resultados da função <code>risks()</code> entrega junto o <em>Número Necessário para Tratar</em> (NNT) que deve ser arredondado para o número inteiro mais próximo (no caso, 110) e significa a estimativa do número de indivíduos que devem receber uma intervenção terapêutica, durante um período específico de tempo, para evitar um efeito adverso ou produzir um desfecho positivo.</p>
<p>O NNT equivale à recíproca do RAR (Redução Absoluta do Risco ou Diferença de Risco):</p>
<p><span class="math display">\[
NNT = \frac{1}{RAR} = \frac{1}{I_{não \ expostos} - I_{expostos}}
\]</span></p>
<p>No exemplo do <em>Physicians’ Health Study</em> <span class="citation" data-cites="steering1989final">(<a href="references.html#ref-steering1989final" role="doc-biblioref">31</a>)</span>, o RAR igual a:</p>
<p><span class="math display">\[
RA = \left|I_{expostos} - I_{não \ expostos}\right| = \left|0,0126 - 0,0217\right| = 0,0091
\]</span></p>
<p><span class="math display">\[
NNT = \frac{1}{0,0091} = 109,89 \simeq 110
\]</span></p>
<p>Pode-se calcular os IC95%, calculando o NNT para os limites do RAR usando a seguinte equação <span class="citation" data-cites="bender2001calculating">(<a href="references.html#ref-bender2001calculating" role="doc-biblioref">33</a>)</span>:</p>
<p><span class="math display">\[
IC_{95\%} \longrightarrow RAR \pm z_{\left({1 - \frac{\alpha}{2}}\right)} \times EP_{RAR}
\]</span> Onde,</p>
<p><span class="math display">\[
EP_{RAR} = \sqrt{\frac{p0\left(1 - p0\right)}{n_{1}}+\frac{p1\left(1 - p1\right)}{n_{2}}}
\]</span></p>
<p>Usando esses dados, pode-se criar um <em>script</em> no <em>RStudio</em> para os cálculos:</p>
<p><u>Vetor dos dados</u></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb93"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="dv">139</span></span>
<span id="cb93-2"><a href="#cb93-2" aria-hidden="true" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="dv">10898</span></span>
<span id="cb93-3"><a href="#cb93-3" aria-hidden="true" tabindex="-1"></a>c <span class="ot">&lt;-</span> <span class="dv">239</span></span>
<span id="cb93-4"><a href="#cb93-4" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="dv">10795</span></span>
<span id="cb93-5"><a href="#cb93-5" aria-hidden="true" tabindex="-1"></a>dados <span class="ot">&lt;-</span> <span class="fu">c</span> (a, b, c, d)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><u>Matriz dos dados</u><a href="#fn6" class="footnote-ref" id="fnref6" role="doc-noteref"><sup>6</sup></a></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb94"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a>mat_iam <span class="ot">&lt;-</span> <span class="fu">matrix</span> (dados, <span class="at">byrow =</span> <span class="cn">TRUE</span>, <span class="at">nrow =</span> <span class="dv">2</span>)</span>
<span id="cb94-2"><a href="#cb94-2" aria-hidden="true" tabindex="-1"></a>tratamento <span class="ot">&lt;-</span> <span class="fu">c</span> (<span class="st">"aspirina"</span>, <span class="st">"placebo"</span>)</span>
<span id="cb94-3"><a href="#cb94-3" aria-hidden="true" tabindex="-1"></a>desfecho <span class="ot">&lt;-</span> <span class="fu">c</span> (<span class="st">"IAM"</span>, <span class="st">"s/IAM"</span>)</span>
<span id="cb94-4"><a href="#cb94-4" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span> (mat_iam) <span class="ot">&lt;-</span> tratamento</span>
<span id="cb94-5"><a href="#cb94-5" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span> (mat_iam) <span class="ot">&lt;-</span> desfecho</span>
<span id="cb94-6"><a href="#cb94-6" aria-hidden="true" tabindex="-1"></a>mat_iam</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>         IAM s/IAM
aspirina 139 10898
placebo  239 10795</code></pre>
</div>
</div>
<p><u>Cálculo das incidências no grupo tratamento e no grupo placebo</u></p>
<p>Na matriz o que está entre colchetes [1,1] significa: linha 1 e coluna 1, ou seja, o valor 139.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb96"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a>n1 <span class="ot">&lt;-</span>mat_iam [<span class="dv">1</span>,<span class="dv">1</span>] <span class="sc">+</span> mat_iam [<span class="dv">1</span>,<span class="dv">2</span>]</span>
<span id="cb96-2"><a href="#cb96-2" aria-hidden="true" tabindex="-1"></a>n1</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 11037</code></pre>
</div>
<div class="sourceCode cell-code" id="cb98"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb98-1"><a href="#cb98-1" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> mat_iam [<span class="dv">1</span>,<span class="dv">1</span>] <span class="sc">/</span> n1</span>
<span id="cb98-2"><a href="#cb98-2" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span> (p1, <span class="dv">4</span>)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.0126</code></pre>
</div>
<div class="sourceCode cell-code" id="cb100"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb100-1"><a href="#cb100-1" aria-hidden="true" tabindex="-1"></a>n0 <span class="ot">&lt;-</span> mat_iam [<span class="dv">2</span>,<span class="dv">1</span>] <span class="sc">+</span> mat_iam [<span class="dv">2</span>,<span class="dv">2</span>]</span>
<span id="cb100-2"><a href="#cb100-2" aria-hidden="true" tabindex="-1"></a>n0</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 11034</code></pre>
</div>
<div class="sourceCode cell-code" id="cb102"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb102-1"><a href="#cb102-1" aria-hidden="true" tabindex="-1"></a>p0 <span class="ot">&lt;-</span> mat_iam [<span class="dv">2</span>,<span class="dv">1</span>] <span class="sc">/</span> n0</span>
<span id="cb102-2"><a href="#cb102-2" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span> (p0, <span class="dv">4</span>)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.0217</code></pre>
</div>
</div>
<p>Os resultados da matriz de dados e o cálculo das incidências <em>p0</em> (incidência no grupo placebo) e <em>p1</em> (incidência no grupo de tratamento) já eram conhecidos e foram repetidos apenas para entrar na programação do cálculo do IC95%.</p>
<p><u>Cálculo do erro padrão da RAR</u></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb104"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb104-1"><a href="#cb104-1" aria-hidden="true" tabindex="-1"></a>RAR <span class="ot">&lt;-</span> <span class="fu">abs</span>(p0 <span class="sc">-</span> p1)</span>
<span id="cb104-2"><a href="#cb104-2" aria-hidden="true" tabindex="-1"></a>NNT <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">/</span>RAR</span>
<span id="cb104-3"><a href="#cb104-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb104-4"><a href="#cb104-4" aria-hidden="true" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> <span class="fl">0.05</span></span>
<span id="cb104-5"><a href="#cb104-5" aria-hidden="true" tabindex="-1"></a>z <span class="ot">&lt;-</span> <span class="fu">qnorm</span> (<span class="dv">1</span> <span class="sc">-</span> (alpha<span class="sc">/</span><span class="dv">2</span>))</span>
<span id="cb104-6"><a href="#cb104-6" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span> (z, <span class="dv">3</span>)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1.96</code></pre>
</div>
<div class="sourceCode cell-code" id="cb106"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb106-1"><a href="#cb106-1" aria-hidden="true" tabindex="-1"></a>EP_RAR <span class="ot">&lt;-</span> <span class="fu">sqrt</span>((((p0<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>p0)) <span class="sc">/</span> n0)) <span class="sc">+</span> (((p1<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>p1)) <span class="sc">/</span> n1)))</span>
<span id="cb106-2"><a href="#cb106-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb106-3"><a href="#cb106-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Limite inferior</span></span>
<span id="cb106-4"><a href="#cb106-4" aria-hidden="true" tabindex="-1"></a>li_RAR <span class="ot">&lt;-</span> RAR <span class="sc">-</span> (z <span class="sc">*</span> EP_RAR)</span>
<span id="cb106-5"><a href="#cb106-5" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span> (li_RAR, <span class="dv">4</span>)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.0056</code></pre>
</div>
<div class="sourceCode cell-code" id="cb108"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb108-1"><a href="#cb108-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Limite superior</span></span>
<span id="cb108-2"><a href="#cb108-2" aria-hidden="true" tabindex="-1"></a>ls_RAR <span class="ot">&lt;-</span> RAR <span class="sc">+</span> (z <span class="sc">*</span> EP_RAR)</span>
<span id="cb108-3"><a href="#cb108-3" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span> (ls_RAR, <span class="dv">4</span>)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.0125</code></pre>
</div>
<div class="sourceCode cell-code" id="cb110"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb110-1"><a href="#cb110-1" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">print</span>(<span class="fu">c</span>(li_RAR, RAR, ls_RAR), <span class="dv">4</span>))</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.005645 0.009066 0.012488</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0 0 0</code></pre>
</div>
</div>
<p>Portando, ao Redução Absoluta do Risco foi igual a 0,0091 (IC95%: 0,0056-0,0125). A partir destes resultados, pode-se calcular o intervalo de confiança para o NNT:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb113"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb113-1"><a href="#cb113-1" aria-hidden="true" tabindex="-1"></a>li_NNT <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">/</span>ls_RAR</span>
<span id="cb113-2"><a href="#cb113-2" aria-hidden="true" tabindex="-1"></a>ls_NNT <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">/</span>li_RAR</span>
<span id="cb113-3"><a href="#cb113-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-4"><a href="#cb113-4" aria-hidden="true" tabindex="-1"></a>li_NNT </span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 80.07881</code></pre>
</div>
<div class="sourceCode cell-code" id="cb115"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb115-1"><a href="#cb115-1" aria-hidden="true" tabindex="-1"></a>ls_NNT</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 177.1497</code></pre>
</div>
</div>
<p>Concluindo, o uso da aspirina no <em>Physicians’ Health Study</em> reduziu o risco de infarto agudo do miocárdio em 42% (RRR), ou seja, foi eficaz. Por outro lado, para ter este impacto será necessário tratar 110 (IC95%: 80-177) pacientes para que um tenha benefício. Este NNT é grande; o ideal é um NNT &lt; 10. Apesar disso, como a aspirina tem baixo custo e seus benefícios suplantam os efeitos adversos, seu uso pode estar justificado.</p>
</section>
<section id="número-necessário-para-causar-dano" class="level3" data-number="18.6.4">
<h3 data-number="18.6.4" class="anchored" data-anchor-id="número-necessário-para-causar-dano"><span class="header-section-number">18.6.4</span> Número Necessário para Causar Dano</h3>
<p>Deve-se comparar o NNT com o <em>Número Necessário para causar Dano</em> (NND), em inglês, <em>Number Needed to Harm</em> (NNH). Deve ser interpretado como o número de pacientes tratados para que um deles apresente um efeito adverso.</p>
<p>O NND é calculado pela recíproca do aumento absoluto do risco (ARA), equivalente a diferença de risco ou redução absoluta do risco:</p>
<p><span class="math display">\[
NND = \frac{1}{ARA} = \frac{1}{I_{expostos} - I_{não \ expostos}}
\]</span></p>
<section id="exemplo-5" class="level4" data-number="18.6.4.1">
<h4 data-number="18.6.4.1" class="anchored" data-anchor-id="exemplo-5"><span class="header-section-number">18.6.4.1</span> Exemplo</h4>
<p>No <em>Physicians’ Health Study</em> <span class="citation" data-cites="steering1989final">(<a href="references.html#ref-steering1989final" role="doc-biblioref">31</a>)</span> sobre o uso de aspirina na prevenção de IAM, foi verificado também os efeitos colaterais da aspirina, como acidentes vasculares cerebrais (AVC), <a href="#tbl-avc" class="quarto-xref">Tabela&nbsp;<span>18.9</span></a>.</p>
<div class="cell" data-layout-align="center">
<div id="tbl-avc" class="cell quarto-float quarto-figure quarto-figure-center anchored" data-layout-align="center">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-avc-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Tabela&nbsp;18.9: Physicians’ Health Study, componente aspirina e AVC.
</figcaption>
<div aria-describedby="tbl-avc-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://i.imgur.com/MC9RL3J.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:70.0%"></p>
</figure>
</div>
</div>
</div>
</figure>
</div>
</div>
<p><u>Cálculo das incidências</u></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb117"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb117-1"><a href="#cb117-1" aria-hidden="true" tabindex="-1"></a>p0 <span class="ot">&lt;-</span> <span class="dv">98</span><span class="sc">/</span><span class="dv">11034</span></span>
<span id="cb117-2"><a href="#cb117-2" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(p0, <span class="dv">4</span>)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.0089</code></pre>
</div>
<div class="sourceCode cell-code" id="cb119"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb119-1"><a href="#cb119-1" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="dv">119</span><span class="sc">/</span><span class="dv">11037</span></span>
<span id="cb119-2"><a href="#cb119-2" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(p1, <span class="dv">4</span>)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.0108</code></pre>
</div>
</div>
<p>Para o cálculo do NND, usa-se a função <code>risk()</code>, como mencionado antes:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb121"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb121-1"><a href="#cb121-1" aria-hidden="true" tabindex="-1"></a>p0 <span class="ot">&lt;-</span> <span class="fl">0.0089</span></span>
<span id="cb121-2"><a href="#cb121-2" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fl">0.0108</span></span>
<span id="cb121-3"><a href="#cb121-3" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span> (MKmisc<span class="sc">::</span><span class="fu">risks</span> (p0, p1), <span class="dv">4</span>)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      p0       p1       RR       OR      RRI      ARI      NNH 
  0.0089   0.0108   1.2135   1.2158   0.2135   0.0019 526.3158 </code></pre>
</div>
</div>
<p>Os resultados mostram que o NND<a href="#fn7" class="footnote-ref" id="fnref7" role="doc-noteref"><sup>7</sup></a> é igual a 526. Ou seja, para evitar um IAM há necessidade de tratar 110 pacientes e a cada 526 tratados espera-se um caso de AVC, havendo um benefício bem maior quando comparado ao risco de AVC.</p>
</section>
</section>
</section>
<section id="análise-de-sobrevida" class="level2" data-number="18.7">
<h2 data-number="18.7" class="anchored" data-anchor-id="análise-de-sobrevida"><span class="header-section-number">18.7</span> Análise de sobrevida</h2>
<p>A análise de sobrevida é utilizada quando se pretende investigar o tempo entre o início de um estudo e a ocorrência subsequente de um evento que modifica o estado de saúde do indivíduo. É bastante usada em estudos sobre câncer, por exemplo, analisando o tempo desde a cirurgia até a morte, o tempo desde o início do tratamento até a progressão da doença, o tempo desde a resposta até a recorrência da doença. Ela também é usada para medir a ocorrência de outros eventos como o tempo desde a infecção pelo vírus da imunodeficiência humana (HIV) até o desenvolvimento da Síndrome de Imunodeficiência Adquirida (SIDA), o tempo de hospitalização, tempo de amamentação, etc.</p>
<p>O interesse está centrado na verificação do efeito dos fatores de risco ou de prognóstico sobre o tempo de sobrevida de um indivíduo ou de um grupo, bem como definir as probabilidades de sobrevida em diversos momentos no seguimento do grupo. Considera-se tempo de sobrevida, ou simplesmente sobrevida, o tempo a entre a entrada do indivíduo no estudo e a ocorrência do evento de interesse. Com relação aos dados relacionados ao tempo, podem ocorrer problemas. O tempo para um evento geralmente não tem distribuição normal. Além disso, nem sempre se pode esperar até que o evento ocorra em todos os pacientes e alguns pacientes abandonam o estudo mais cedo. Todos devem ser considerados e as análises de sobrevida contornam esses problemas.</p>
<p>Em estudos de sobrevida, os indivíduos são observados até a ocorrência de um evento final que, geralmente, corresponde à morte, ou à variação de um parâmetro biológico ou outro evento que indique a modificação do estado inicial (cura, recorrência, retorno ao trabalho, etc.) O evento final é denominado de <em>falha</em>, por referir-se, em geral, a algo indesejável.</p>
<section id="dados-censurados" class="level3" data-number="18.7.1">
<h3 data-number="18.7.1" class="anchored" data-anchor-id="dados-censurados"><span class="header-section-number">18.7.1</span> Dados Censurados</h3>
<p>Quando, em um estudo de sobrevida, os pacientes que saem do estudo ou que não vivenciam o evento são chamados de observações <em>censuradas</em>.</p>
<p>Esses tempos de sobrevida censurados subestimam o verdadeiro (mas desconhecido) tempo para o evento. Quando o evento (supondo que ocorreria) está além do final do período de acompanhamento, a censura costuma ser chamada de censura à direita.</p>
<p>A censura também pode ocorrer quando se observa a presença de um evento, mas não se sabe onde começou. Por exemplo, considere um estudo que investigue o tempo para a recorrência de um câncer após a remoção cirúrgica do tumor primário. Se os pacientes forem examinados 3 meses após a cirurgia e já tinham recorrência, então o tempo de sobrevida será censurado a esquerda, porque o tempo real (desconhecido) de recorrência ocorreu menos de 3 meses após a cirurgia.</p>
<p>Os dados de tempo do evento também podem ser censurados em intervalos, o que significa que os indivíduos entram e saem da observação. Se considerarmos o exemplo anterior e os pacientes também forem examinados aos 6 meses, aqueles que estão livres da doença aos 3 meses e perdem o acompanhamento entre 3 e 6 meses são considerados censurados no intervalo. A maioria dos dados de sobrevivência incluem observações censuradas à direita <span class="citation" data-cites="clark2003survival">(<a href="references.html#ref-clark2003survival" role="doc-biblioref">34</a>)</span>.</p>
</section>
<section id="método-de-kaplan-meier" class="level3" data-number="18.7.2">
<h3 data-number="18.7.2" class="anchored" data-anchor-id="método-de-kaplan-meier"><span class="header-section-number">18.7.2</span> Método de Kaplan-Meier</h3>
<p>O método de Kaplan-Meier (KM) é um método não paramétrico usado para estimar a probabilidade de sobrevivência a partir dos tempos de sobrevivência observados <span class="citation" data-cites="kaplan1958nonparametric">(<a href="references.html#ref-kaplan1958nonparametric" role="doc-biblioref">35</a>)</span>.</p>
<p>A função de sobrevida é a probabilidade de sobreviver a pelo menos um determinado ponto no tempo e o gráfico desta probabilidade é a curva de sobrevida. O método de sobrevida de Kaplan-Meier pode ser usado para comparar as curvas de sobrevida de dois ou mais grupos, como comparar um grupo tratado a um grupo não tratado (placebo), ou homens comparados a mulheres.</p>
<p>A curva de sobrevida KM, um gráfico da probabilidade de sobrevida de Kaplan-Meier em relação ao tempo, fornece um resumo útil dos dados que podem ser usados para estimar medidas como a <em>mediana de sobrevida</em>.</p>
<section id="pressupostos-do-método-de-kaplan-meier" class="level4" data-number="18.7.2.1">
<h4 data-number="18.7.2.1" class="anchored" data-anchor-id="pressupostos-do-método-de-kaplan-meier"><span class="header-section-number">18.7.2.1</span> Pressupostos do método de Kaplan-Meier</h4>
<p>Os pressupostos para o uso da análise de sobrevida são as seguintes <span class="citation" data-cites="peat2014survival">(<a href="references.html#ref-peat2014survival" role="doc-biblioref">36</a>)</span>:</p>
<ul>
<li>os participantes devem ser independentes, ou seja, cada participante aparece apenas uma vez no grupo;</li>
<li>os grupos devem ser independentes, ou seja, cada participante está apenas em um grupo;</li>
<li>todos os participantes são livres de eventos quando se inscrevem no estudo;</li>
<li>a medição do tempo até o evento deve ser precisa;</li>
<li>o ponto inicial e o evento são claramente definidos;</li>
<li>as perspectivas de sobrevida dos participantes permanecem constantes, ou seja, os participantes inscritos no início ou no final do estudo devem ter as mesmas perspectivas de sobrevida;</li>
<li>a probabilidade de censura não está relacionada à probabilidade do evento.</li>
</ul>
<p>Como em todas as análises, se o número total de pacientes em qualquer grupo for pequeno, digamos menos de 30 participantes em cada grupo, os erros padrão em torno das estatísticas resumidas serão grandes e, portanto, as estimativas de sobrevida serão imprecisas. Para estudos de sobrevida, recomenda-se fazer o cálculo do tamanho amostral previamente. O R dispõe de um pacote que possibilita este cálculo, o <code>powerSurvEpi</code> <span class="citation" data-cites="qiu2015powersurvepi">(<a href="references.html#ref-qiu2015powersurvepi" role="doc-biblioref">37</a>)</span>.</p>
</section>
<section id="exemplo-6" class="level4" data-number="18.7.2.2">
<h4 data-number="18.7.2.2" class="anchored" data-anchor-id="exemplo-6"><span class="header-section-number">18.7.2.2</span> Exemplo</h4>
<p>O arquivo <code>dadosSobrevida.xlsx</code> contém as informações de 60 pacientes selecionados para um ensaio clínico randomizado hipotético de dois tratamentos nos quais 32 pacientes receberam o novo tratamento e 28 pacientes receberam o tratamento padrão. Para obter o arquivo, clique <a href="https://github.com/petronioliveira/Arquivos/blob/main/dadosSobrevida.xlsx"><strong>aqui</strong></a> e salve o mesmo em seu diretório de trabalho.</p>
<p>Destes pacientes, 33 eram mulheres e 27 homens. Durante o estudo (65 meses), um total de 21 pacientes morreram (7 mulheres e 14 homens).</p>
<p><u>Carregar o conjunto de dados</u></p>
<p>A partir do diretório de trabalho, carregue para um objeto que será denominado de <code>sobrevida</code>, usando a função <code>read_excel()</code> do pacote <code>readxl</code> e observe os dados com a função <code>head()</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb123"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb123-1"><a href="#cb123-1" aria-hidden="true" tabindex="-1"></a>sobrevida <span class="ot">&lt;-</span> readxl<span class="sc">::</span><span class="fu">read_excel</span>(<span class="st">"dados/dadosSobrevida.xlsx"</span>)</span>
<span id="cb123-2"><a href="#cb123-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span> (sobrevida)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 5
     id evento tempo sexo  grupo
  &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt;
1    22      0     5 fem   novo 
2    21      0     7 masc  novo 
3    19      0     8 fem   novo 
4    13      0     9 fem   novo 
5    50      1     9 masc  novo 
6    20      1    12 masc  novo </code></pre>
</div>
</div>
<p>A Saída exibe um banco de dados com cinco variáveis:</p>
<ul>
<li><strong>id</strong> <span class="math inline">\(\longrightarrow\)</span> Identificação do indivíduo</li>
<li><strong>evento</strong> <span class="math inline">\(\longrightarrow\)</span> Desfecho. 0 = censurado; 1 = morte</li>
<li><strong>tempo</strong> <span class="math inline">\(\longrightarrow\)</span> Sobrevida em meses</li>
<li><strong>sexo</strong> <span class="math inline">\(\longrightarrow\)</span> 1 = masculino; 2 = feminino</li>
<li><strong>grupo</strong> <span class="math inline">\(\longrightarrow\)</span> Grupo de tratamento: 1 = nova droga; 2 = padrão</li>
</ul>
<p><u>Construir uma tabela tratamento vs evento</u></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb125"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb125-1"><a href="#cb125-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span> (sobrevida<span class="sc">$</span>grupo, </span>
<span id="cb125-2"><a href="#cb125-2" aria-hidden="true" tabindex="-1"></a>       sobrevida<span class="sc">$</span>evento, </span>
<span id="cb125-3"><a href="#cb125-3" aria-hidden="true" tabindex="-1"></a>       <span class="at">dnn =</span> <span class="fu">c</span>(<span class="st">"Tratamento"</span>, <span class="st">"Evento"</span>))</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>          Evento
Tratamento  0  1
    novo   24  8
    padrão 15 13</code></pre>
</div>
</div>
<p>A saída mostra o número em cada grupo, o número de eventos e o número censurados. Houve menos eventos, mas mais pacientes censurados no grupo do tratamento novo.</p>
<p><u>Calcular as estimativas de sobrevida de Kaplan-Meier para a construção da Curva de Sobrevida de cada tratamento</u></p>
<p>Para isso, usa-se a função <code>survfit()</code> do pacote <code>survival</code><span class="citation" data-cites="therneau2015survival">(<a href="references.html#ref-therneau2015survival" role="doc-biblioref">38</a>)</span>. Seus principais argumentos incluem:</p>
<ul>
<li>objeto de sobrevida, criado usando a função <code>Surv()</code>, aninhada na função <code>survfit()</code></li>
<li>e o conjunto de dados contendo as variáveis.</li>
</ul>
<p>Para a construção da tabela e da curva de sobrevida, digite e execute o seguinte:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb127"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb127-1"><a href="#cb127-1" aria-hidden="true" tabindex="-1"></a>tabsurv <span class="ot">&lt;-</span> <span class="fu">survfit</span> (<span class="fu">Surv</span> (tempo, evento) <span class="sc">~</span> grupo, <span class="at">data =</span> sobrevida)</span>
<span id="cb127-2"><a href="#cb127-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb127-3"><a href="#cb127-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(tabsurv) </span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Call: survfit(formula = Surv(tempo, evento) ~ grupo, data = sobrevida)

                grupo=novo 
 time n.risk n.event survival std.err lower 95% CI upper 95% CI
    9     29       1    0.966  0.0339       0.9013        1.000
   12     27       1    0.930  0.0479       0.8404        1.000
   15     26       1    0.894  0.0579       0.7874        1.000
   16     25       1    0.858  0.0657       0.7387        0.997
   32     15       1    0.801  0.0826       0.6545        0.980
   36     13       1    0.739  0.0965       0.5725        0.955
   40     11       1    0.672  0.1086       0.4897        0.923
   58      2       1    0.336  0.2438       0.0811        1.000

                grupo=padrão 
 time n.risk n.event survival std.err lower 95% CI upper 95% CI
    1     28       3    0.893  0.0585       0.7853        1.000
    2     25       1    0.857  0.0661       0.7369        0.997
    3     24       1    0.821  0.0724       0.6911        0.976
    4     23       2    0.750  0.0818       0.6056        0.929
    7     20       1    0.712  0.0859       0.5625        0.902
   17     19       1    0.675  0.0892       0.5210        0.875
   21     17       2    0.596  0.0947       0.4361        0.813
   38      9       1    0.529  0.1048       0.3592        0.780
   52      2       1    0.265  0.1944       0.0628        1.000</code></pre>
</div>
</div>
<p>A <em>Tabela de sobrevida</em> é uma tabela descritiva com a coluna <em>time</em>, indicando o dia em que o evento ocorreu. A coluna <em>n.risk</em> indica o número de pacientes sob risco naquele momento. A coluna denominada <em>n.event</em> indica o número total de pacientes que sofreram o evento desde o início do estudo até o momento avaliado. A coluna <em>survival</em> indica a proporção de pacientes que sobreviveram desde o início do estudo até aquele momento. Por exemplo, a sobrevida cumulativa é de 0,801 aos 32 meses no grupo tratamento novo e de 0,529 aos 38 meses no grupo tratamento padrão.</p>
<p>O método Kaplan-Meier produz uma única estatística resumida do tempo de sobrevida, isto é, a média ou mediana. O <em>tempo médio de sobrevida</em> é estimado a partir dos tempos observados e é mostrado para cada grupo na tabela de médias e medianas para o tempo de sobrevida.</p>
<p>A <em>sobrevida média</em> é calculada como a soma do tempo dividido pelo número de pacientes que permanecem sem censura. Essa estatística pode ser usada para indicar o período de tempo em que um paciente pode sobreviver. O <em>tempo mediano de sobrevida</em> é o ponto em que metade dos pacientes experimentou o evento. Se a curva de sobrevida não cair para 0,5 (ou seja, probabilidade de sobrevida de 50%), o tempo mediano de sobrevida não poderá ser calculado.</p>
<p>Estes dados podem ser visualizados na Saída, obtida com o comando:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb129"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb129-1"><a href="#cb129-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(tabsurv)<span class="sc">$</span>table</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>             records n.max n.start events    rmean se(rmean) median 0.95LCL
grupo=novo        32    32      32      8 49.92533  4.078218     58      40
grupo=padrão      28    28      28     13 36.62437  5.403382     52      21
             0.95UCL
grupo=novo        NA
grupo=padrão      NA</code></pre>
</div>
</div>
<p><u>Visualização da curva de sobrevida</u></p>
<p>Pode-se visualizar a curva (<a href="#fig-survival" class="quarto-xref">Figura&nbsp;<span>18.8</span></a>) de uma maneira simples, utilizando a função <code>plot()</code> do pacote básico do R:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb131"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb131-1"><a href="#cb131-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span> (tabsurv, <span class="at">col =</span> <span class="fu">c</span> (<span class="st">"steelblue"</span>, <span class="st">"rosybrown"</span>), <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb131-2"><a href="#cb131-2" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span> (<span class="at">legend =</span> <span class="fu">c</span> (<span class="st">"Tratamento novo"</span>, <span class="st">"Tratamento padrão"</span>), </span>
<span id="cb131-3"><a href="#cb131-3" aria-hidden="true" tabindex="-1"></a>        <span class="at">fill =</span> <span class="fu">c</span> (<span class="st">"steelblue"</span>, <span class="st">"rosybrown"</span>), </span>
<span id="cb131-4"><a href="#cb131-4" aria-hidden="true" tabindex="-1"></a>        <span class="at">bty=</span><span class="st">"n"</span>, </span>
<span id="cb131-5"><a href="#cb131-5" aria-hidden="true" tabindex="-1"></a>        <span class="at">cex =</span> <span class="dv">1</span>, </span>
<span id="cb131-6"><a href="#cb131-6" aria-hidden="true" tabindex="-1"></a>        <span class="at">y =</span> <span class="fl">0.3</span>,</span>
<span id="cb131-7"><a href="#cb131-7" aria-hidden="true" tabindex="-1"></a>        <span class="at">x =</span> <span class="dv">5</span>)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-survival" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" data-fig-pos="ht">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-survival-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="18-epidemiologia_files/figure-html/fig-survival-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:70.0%" data-fig-pos="ht">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-survival-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figura&nbsp;18.8: Curva de sobrevida comparando dois grupos de tratamento.
</figcaption>
</figure>
</div>
</div>
</div>
<p>Outra maneira, mais sofisticada, de produzir a curva de KM é usando a função <code>ggsurvplot()</code>, incluída no pacote <code>survminer</code> <span class="citation" data-cites="kassambara2021survminer">(<a href="references.html#ref-kassambara2021survminer" role="doc-biblioref">39</a>)</span> que utiliza o pacote <code>ggplot2</code> (<a href="#fig-survival1" class="quarto-xref">Figura&nbsp;<span>18.9</span></a>)</p>
<p>Com essa função é possível mostrar:</p>
<ul>
<li>os intervalos de confiança de 95% da função de sobrevida, usando o argumento <code>conf.int = TRUE</code>;</li>
<li>o número e/ou a porcentagem de indivíduos em risco por tempo, utilizando a opção <code>risk.table</code>. Os valores permitidos para a <code>risk.table</code> incluem:</li>
<li><code>TRUE</code> ou <code>FALSE</code> especificando se deve mostrar ou não a tabela de risco. O padrão é FALSE.</li>
<li><code>absolute</code> ou <code>percentage</code>: para mostrar o número absoluto e o percentual de sujeitos em risco por tempo, respectivamente. Use <code>abs_pct</code> para mostrar o número absoluto e a porcentagem.</li>
<li>o nrisk_cumcensor e nrisk_cumevents . Mostra o número em risco e o número acumulado de censura e eventos, respectivamente.</li>
<li>o valor <em>P</em> do teste <code>Log-Rank</code> comparando os grupos usando <code>pval = TRUE</code>.</li>
<li>linha horizontal/vertical na sobrevida mediana usando o argumento <code>surv.median.line</code>. Os valores permitidos incluem um de <code>c(“nenhum”, “hv”, “h”, “v”)</code>. Onde v = vertical, h = horizontal.</li>
</ul>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb132"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb132-1"><a href="#cb132-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsurvplot</span> (tabsurv,</span>
<span id="cb132-2"><a href="#cb132-2" aria-hidden="true" tabindex="-1"></a>            <span class="at">pval =</span> <span class="cn">TRUE</span>, </span>
<span id="cb132-3"><a href="#cb132-3" aria-hidden="true" tabindex="-1"></a>            <span class="at">conf.int =</span> <span class="cn">FALSE</span>,</span>
<span id="cb132-4"><a href="#cb132-4" aria-hidden="true" tabindex="-1"></a>            <span class="at">risk.table =</span> <span class="st">"abs_pct"</span>,</span>
<span id="cb132-5"><a href="#cb132-5" aria-hidden="true" tabindex="-1"></a>            <span class="at">risk.table.col =</span> <span class="st">"strata"</span>, </span>
<span id="cb132-6"><a href="#cb132-6" aria-hidden="true" tabindex="-1"></a>            <span class="at">surv.median.line =</span> <span class="st">"hv"</span>, </span>
<span id="cb132-7"><a href="#cb132-7" aria-hidden="true" tabindex="-1"></a>            <span class="at">ggtheme =</span> <span class="fu">theme_bw</span> (), </span>
<span id="cb132-8"><a href="#cb132-8" aria-hidden="true" tabindex="-1"></a>            <span class="at">legend.labs =</span> <span class="fu">c</span> (<span class="st">"Tratamento Novo"</span>, </span>
<span id="cb132-9"><a href="#cb132-9" aria-hidden="true" tabindex="-1"></a>                             <span class="st">"Tratamento padrão"</span>),</span>
<span id="cb132-10"><a href="#cb132-10" aria-hidden="true" tabindex="-1"></a>            <span class="at">palette =</span> <span class="fu">c</span> (<span class="st">"steelblue"</span>, <span class="st">"tomato"</span>))</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-survival1" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" data-fig-pos="ht">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-survival1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="18-epidemiologia_files/figure-html/fig-survival1-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:70.0%" data-fig-pos="ht">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-survival1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figura&nbsp;18.9: Curva de sobrevida comparando dois grupos de tratamento, usando ggsurvplot().
</figcaption>
</figure>
</div>
</div>
</div>
<p>O teste <code>Log Rank</code> pondera todos os pontos de tempo igualmente e é a estatística de sobrevida mais usada <span class="citation" data-cites="bland2004logrank">(<a href="references.html#ref-bland2004logrank" role="doc-biblioref">40</a>)</span>. O teste de log rank é um teste não paramétrico, que não faz suposições sobre as distribuições de sobrevivência. Os pressupostos deste teste são os mesmos do método de Kaplan-Meier. No exemplo, o valor <em>P</em> do teste é fornecido na <a href="#fig-survival1" class="quarto-xref">Figura&nbsp;<span>18.9</span></a> e é igual a 0,083, ou seja, acima de 0,05, indicando não rejeição da <span class="math inline">\(H_{0}\)</span>. A hipótese nula diz que não há diferença na sobrevivência entre os dois grupos.</p>
<p>Essencialmente, o teste de log rank compara o número observado de eventos em cada grupo com o que seria esperado se a hipótese nula fosse verdadeira (ou seja, se as curvas de sobrevivência fossem idênticas). A estatística de log rank é aproximadamente distribuída como uma estatística de teste qui-quadrado.</p>
<p>A função <code>survdiff()</code>, também do pacote <code>survival</code>, pode ser usada para calcular o teste de log-rank comparando duas ou mais curvas de sobrevida e pode ser usado da seguinte forma:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb133"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb133-1"><a href="#cb133-1" aria-hidden="true" tabindex="-1"></a>dif_sobrevida <span class="ot">&lt;-</span> <span class="fu">survdiff</span> (<span class="fu">Surv</span> (tempo, evento) <span class="sc">~</span> grupo, <span class="at">data =</span> sobrevida)</span>
<span id="cb133-2"><a href="#cb133-2" aria-hidden="true" tabindex="-1"></a>dif_sobrevida</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Call:
survdiff(formula = Surv(tempo, evento) ~ grupo, data = sobrevida)

              N Observed Expected (O-E)^2/E (O-E)^2/V
grupo=novo   32        8    11.91      1.28      3.01
grupo=padrão 28       13     9.09      1.68      3.01

 Chisq= 3  on 1 degrees of freedom, p= 0.08 </code></pre>
</div>
</div>
<p>A suposição de que o risco de um evento em um grupo em comparação com o outro grupo não muda ao longo do tempo é chamado de risco proporcional. Se as curvas de sobrevida se cruzam, isso sugere que os riscos não são proporcionais. Nessa situação, o teste log rank será menos poderoso e um teste alternativo deve ser considerado, como a <em>Regressão de Cox</em> ou <em>Modelo de Riscos Proporcionais</em>.</p>
</section>
</section>
<section id="regressão-de-cox-ou-modelo-de-riscos-proporcionais" class="level3" data-number="18.7.3">
<h3 data-number="18.7.3" class="anchored" data-anchor-id="regressão-de-cox-ou-modelo-de-riscos-proporcionais"><span class="header-section-number">18.7.3</span> Regressão de Cox ou Modelo de Riscos Proporcionais</h3>
<p>O modelo tem como objetivo a examinar simultaneamente como os fatores especificados influenciam a taxa de ocorrência de um determinado evento (por exemplo, infecção, morte) em um determinado ponto no tempo. Essa taxa é referida como <em>hazard ratio</em>.</p>
<p>Geralmente, as variáveis preditoras (ou fatores) são denominadas covariáveis. O modelo de Cox é expresso pela função de risco denotada por <code>h(t)</code>. Pode ser interpretada como o risco de morrer no tempo <em>t</em> e estimada da seguinte forma:</p>
<p><span class="math display">\[
h\left(t\right) = h_{0} \left(t\right) \times e^{\left( {b_{1}x_{1}+b_{2}x_{2}+...+b_{n}x_{n}} \right)}
\]</span></p>
<p>Onde,</p>
<ul>
<li><em>t</em> é o tempo de sobrevida, indica que o risco varia com o tempo;</li>
<li><em>h(t)</em> é a função de risco (<em>hazard</em>) determinada por um conjunto de <em>n</em> covariáveis (<span class="math inline">\(x_{1}, x_{2}, ..., x_{n}\)</span>);</li>
<li>Os <em>coeficientes</em> (<span class="math inline">\(b_{1}, b_{2}, ..., b_{n}\)</span>) medem o tamanho do efeito das covariáveis;</li>
<li><em>h(0)</em> é o risco basal, o valor do risco se todos os <span class="math inline">\(x_{i}\)</span> fossem iguais a zero (<span class="math inline">\(exp(0) = 1\)</span>).</li>
</ul>
<p>As quantidades exp(<span class="math inline">\(b_{i}\)</span>) são chamadas de <em>hazard ratio</em> (HR). Uma hazard ratio acima de 1 indica uma covariável que está positivamente associada à probabilidade do evento e, portanto, negativamente associada ao tempo de sobrevida.</p>
<p>Resumindo,</p>
<ul>
<li>HR = 1: Sem efeito</li>
<li>HR &lt;1: Redução do risco</li>
<li>HR&gt; 1: Aumento do risco</li>
</ul>
<p>Para calcular o modelo de Cox no R serão utilizados os mesmos dados da do arquivo <code>dadosSobrevida.xlsx</code>.</p>
<p>O pacote <code>survival</code> tem uma função para calcular o modelo de Cox, <code>coxph()</code>, que usa os argumentos:</p>
<ul>
<li><em>formula</em> <span class="math inline">\(\longrightarrow\)</span> é o modelo linear com um objeto de sobrevivida como variável desfecho. O objeto de sobrevida é criado usando a função <code>Surv()</code> como segue: <code>Surv(tempo, evento)</code>.</li>
<li><em>data</em> <span class="math inline">\(\longrightarrow\)</span> um banco de dados contendo as variáveis.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb135"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb135-1"><a href="#cb135-1" aria-hidden="true" tabindex="-1"></a>mod.cox <span class="ot">&lt;-</span> <span class="fu">coxph</span> (<span class="fu">Surv</span> (tempo, evento) <span class="sc">~</span> grupo, <span class="at">data =</span> sobrevida)</span>
<span id="cb135-2"><a href="#cb135-2" aria-hidden="true" tabindex="-1"></a>mod.cox</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Call:
coxph(formula = Surv(tempo, evento) ~ grupo, data = sobrevida)

              coef exp(coef) se(coef)     z      p
grupopadrão 0.7698    2.1593   0.4505 1.709 0.0875

Likelihood ratio test=3.03  on 1 df, p=0.08171
n= 60, number of events= 21 </code></pre>
</div>
</div>
<p>A função <code>summary()</code> fornece um relatório mais completo:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb137"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb137-1"><a href="#cb137-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mod.cox)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Call:
coxph(formula = Surv(tempo, evento) ~ grupo, data = sobrevida)

  n= 60, number of events= 21 

              coef exp(coef) se(coef)     z Pr(&gt;|z|)  
grupopadrão 0.7698    2.1593   0.4505 1.709   0.0875 .
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

            exp(coef) exp(-coef) lower .95 upper .95
grupopadrão     2.159     0.4631     0.893     5.221

Concordance= 0.637  (se = 0.054 )
Likelihood ratio test= 3.03  on 1 df,   p=0.08
Wald test            = 2.92  on 1 df,   p=0.09
Score (logrank) test = 3.06  on 1 df,   p=0.08</code></pre>
</div>
</div>
<p>Os resultados da regressão de Cox, podem ser interpretados da seguinte forma:</p>
<ul>
<li><p><em>Significância estatística</em>. A coluna marcada com <em>z</em> fornece o valor da estatística Wald. Corresponde à razão de cada coeficiente de regressão para seu erro padrão (<span class="math inline">\(z = \frac{coef}{EP_{coef}}\)</span>). A estatística Wald avalia se o coeficiente beta (<span class="math inline">\(\beta\)</span>) de uma determinada variável é estatisticamente diferente de 0. A partir da saída, pode-se concluir que não há diferença estatisticamente significativa entre os grupos (<em>P</em> = 0,0875).</p></li>
<li><p><em>Coeficientes de regressão</em>. A seguir deve-se observar, no modelo de Cox, o sinal dos coeficientes de regressão (coef). Um sinal positivo significa que o <em>hazard</em> (risco) é maior e, portanto, pior o prognóstico, para sujeitos com valores mais elevados dessa variável. No exemplo, a variável grupo é codificada como 1=novo, 2=padrão. O resumo do modelo de Cox fornece a <em>hazard ratio</em> (HR) para o segundo grupo em relação ao primeiro grupo, ou seja, tratamento padrão versus tratamento novo. O coeficiente beta para grupo = 0,7698 indica que os indivíduos do tratamento padrão têm maior risco de morte (taxas de sobrevivência mais baixas) do que os do grupo tratamento novo, nesses dados. Entretanto, esta diferença não é estatisticamente significativa.</p></li>
<li><p><em>Hazard ratios</em>. Os coeficientes exponenciados (exp(coef) = exp(0,7698) = 2,1593), também conhecidos como <em>hazard ratio</em>, fornecem o tamanho do efeito das covariáveis. Por exemplo, ser do grupo padrão aumenta o risco por um fator de 2,1593. Se esta diferença fosse significativa (P &lt; 0,05), pertencer ao grupo padrão estaria associado a um mau prognóstico.</p></li>
<li><p><em>Intervalos de confiança das taxas de risco</em>. O resultado do resumo também fornece intervalos de confiança de 95% para a razão de risco (exp(coef)), limite inferior de 95% = 0,893, limite superior de 95% = 5,221, mostrando a não significância estatística, pois cruza o 1.</p></li>
<li><p><em>Significância estatística global do modelo</em>. Finalmente, a saída fornece valores de <em>P</em> para três testes alternativos para significância geral do modelo: O teste de razão de verossimilhança (<em>Likelihood ratio test</em>), teste de Wald e a estatística <em>logrank</em>. Esses três métodos são equivalentes. Para um tamanho amostral grande, eles darão resultados semelhantes. Para <em>n</em> pequeno, eles podem diferir um pouco. O teste de razão de verossimilhança tem melhor comportamento para tamanhos de amostra pequenos, por isso é geralmente preferido.</p></li>
</ul>
</section>
</section>
<section id="regressão-logística-binária" class="level2" data-number="18.8">
<h2 data-number="18.8" class="anchored" data-anchor-id="regressão-logística-binária"><span class="header-section-number">18.8</span> Regressão logística binária</h2>
<p>A <strong>regressão logística</strong> (também conhecida como <em>regressão logit</em> ou <em>modelo logit</em>) foi desenvolvida como um a extensão do modelo linear pelo estatístico David Cox em 1958 <span class="citation" data-cites="cox1958regression">(<a href="references.html#ref-cox1958regression" role="doc-biblioref">41</a>)</span>. Pertence a uma família, denominada <em>Modelo Linear Generalizado</em> (GLM) e é um modelo de regressão em que o desfecho <em>Y</em> é categórico.</p>
<p>A regressão logística permite estimar a probabilidade de uma resposta categórica com base em uma ou mais variáveis preditoras (<em>X</em>). Possibilita informar se a presença de um preditor aumenta (ou diminui) a probabilidade de um determinado desfecho em uma porcentagem específica. No caso em que <em>Y</em> é binário - ou seja, assume apenas dois valores, <code>0</code> e <code>1</code>, que representam desfechos como aprovação/reprovação, sim/não, vivo/morto ou saudável/doente, tem-se a <strong>regressão logística binária</strong>.</p>
<p>Na regressão logística binária, as variáveis que afetam a probabilidade do resultado são medidas como <em>Odds Ratio</em>, que são chamadas de <strong>Odds Ratios ajustadas</strong> <span class="citation" data-cites="peat2014adjusted">(<a href="references.html#ref-peat2014adjusted" role="doc-biblioref">42</a>)</span>.</p>
<p>Na regressão linear, os valores das variáveis desfecho são preditos a partir de uma ou mais variáveis explicativas. Na regressão logística, uma vez que o desfecho é binário, a probabilidade de o desfecho ocorrer é calculada com base nos valores das variáveis explicativas. A regressão logística é semelhante à regressão linear na medida em que uma equação de regressão pode ser usada para prever a probabilidade de ocorrência de um desfecho. No entanto, a equação de regressão logística é expressa em termos logarítmicos (ou logits) e, portanto, os coeficientes de regressão devem ser convertidos para serem interpretados.</p>
<p>Embora as variáveis explicativas ou preditores no modelo possam ser variáveis contínuas ou categóricas, a regressão logística é mais adequada para medir os efeitos das exposições ou variáveis explicativas que são variáveis binárias. Variáveis contínuas podem ser incluídas, mas a regressão logística produzirá uma estimativa de risco para cada unidade de medida. Assim, a suposição de que o efeito de risco é linear sobre cada unidade da variável deve ser atendida e a relação não deve ser curva ou ter um ponto de corte sobre o qual o efeito ocorre. Além disso, as interações entre variáveis explicativas podem ser incluídas <span class="citation" data-cites="peat2014adjusted">(<a href="references.html#ref-peat2014adjusted" role="doc-biblioref">42</a>)</span>. Os casos em que a variável dependente tem mais de duas categorias de resultados podem ser analisados com <em>regressão logística multinomial</em>, não mostrada neste livro.</p>
<section id="sec-logisticfunction" class="level3" data-number="18.8.1">
<h3 data-number="18.8.1" class="anchored" data-anchor-id="sec-logisticfunction"><span class="header-section-number">18.8.1</span> Função Logistica</h3>
<p>Na regressão logística, para a estimação dos coeficientes (coeficientes <span class="math inline">\(\beta\)</span>) das variáveis independentes, utiliza-se o modelo logit <span class="citation" data-cites="hair2009analise">(<a href="references.html#ref-hair2009analise" role="doc-biblioref">43</a>)</span>:</p>
<p><span class="math display">\[
logit_{i} = ln(\frac{p}{1-p})=b_{0} + b_{1}x_{1} +...+ b_{n}x_{n}
\]</span> ou</p>
<p><span class="math display">\[
logit_{i} = ln(\frac{p}{1-p})=e^{b_{0} + b_{1}x_{1} +...+ b_{n}x_{n}}
\]</span></p>
<p>onde <em>p</em> é a probabilidade de desfecho.</p>
<p>A <strong>função logística</strong> transforma valores entre <span class="math inline">\(-\infty\)</span> a <span class="math inline">\(+\infty\)</span> em valores entre 0 e 1, de modo que os números que especificam as probabilidades estarão entre 0 e 1. Esse termo logarítmico é chamado de <span class="math inline">\(log_{OR}\)</span> (razão de chances logarítmica) ou <em>logit</em>. As chances (<em>odds</em>) associadas a alguma probabilidade são <span class="math inline">\(p/(1-p)\)</span>, o que é evidente se for entendido que um evento com chances <em>a</em> para <em>b</em> significa que em <span class="math inline">\(a+b\)</span> tentativas independentes e identicamente distribuídas, espera-se um sucesso. Portanto, a probabilidade de sucesso deve ser <span class="math inline">\(a/(a+b)\)</span>.</p>
<p>Invertendo, se a probabilidade de sucesso é <span class="math inline">\(a/(a+b)\)</span>, então a razão se torna <span class="math inline">\([a/(a+b)]/[1-a/(a+b)]\)</span> ou <span class="math inline">\(a/b\)</span>, que é a razão de chances ou <em>odds ratio</em>.</p>
<p>Para concluir o modelo, é necesário especificar a distribuição do desfecho <span class="math inline">\(Y_{i}\)</span>. Ela é binomial com probabilidade de sucesso <em>p</em>, de modo que nenhum parâmetro extra, como um desvio padrão, é necessário <span class="citation" data-cites="verzani2014reglog">(<a href="references.html#ref-verzani2014reglog" role="doc-biblioref">44</a>)</span>.</p>
<p>A regressão logística frequentemente utiliza a curva logística (<a href="#fig-curvalog" class="quarto-xref">Figura&nbsp;<span>18.10</span></a>) para assim representar a relação entre a variável dependente e as independentes. Os valores previstos, portanto permanecem entre 0 e 1, sendo definidos pelos coeficientes estimados.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-curvalog" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" data-fig-pos="H">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-curvalog-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="https://imgur.com/mBRglgO.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:50.0%" data-fig-pos="H">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-curvalog-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figura&nbsp;18.10: Curva logística geral
</figcaption>
</figure>
</div>
</div>
</div>
<p>A estimação dos coeficientes na regressão logística, diferentemente da regressão múltipla que utiliza o método dos mínimos quadrados, é realizada através da <strong>máxima verossimilhança</strong>. Este método busca encontrar as estimativas mais prováveis dos coeficientes e maximizar a probabilidade de ocorrência de um evento. A qualidade do ajuste do modelo é avaliada pelo “pseudo” <span class="math inline">\(R^2\)</span> e pela análise da precisão preditiva (matriz de confusão).</p>
<p>O valor da verossimilhança (<em>likelihood</em>) é semelhante ao procedimento das somas dos quadrados na regressão múltipla, estimando o quão bem o método de máxima verossimilhança se ajusta ao modelo. O ajuste da estimação do modelo é dado pelo valor de -2 vezes o logaritmo da verossimilhança (-2LL), sendo que, quanto menor este valor, melhor o modelo <span class="citation" data-cites="stoltzfus2011logistic">(<a href="references.html#ref-stoltzfus2011logistic" role="doc-biblioref">45</a>)</span>.</p>
</section>
<section id="pressupostos-da-regressão-logística" class="level3" data-number="18.8.2">
<h3 data-number="18.8.2" class="anchored" data-anchor-id="pressupostos-da-regressão-logística"><span class="header-section-number">18.8.2</span> Pressupostos da regressão logística</h3>
<p>Para garantir que a regressão seja adequada, para melhorar a precisão do modelo, assumimos quatro pressupostos principais:</p>
<ol type="1">
<li><strong>Independência dos dados</strong>: o valor de uma observação não influencia ou afeta o valor de outras observações. Este é o pressuposto básico.</li>
<li><strong>Linearidade dos dados</strong>: a relação entre as variáveis independentes e a curva logística da variável dependente é considerada linear (quanto mais/menos de uma, mais/menos de outra). Linearidade dos Dados pode ser verificada graficamente observando a dispersão dos resíduos com os valores previstos pela regressão.</li>
<li><strong>Independência dos erros/resíduos</strong>: os erros (também chamados de resíduos) não devem possuir correlação. Este pressuposto pode ser testado pelo teste de Durbin-Watson (veja a <a href="15-correlacao-regressao.html#sec-dw" class="quarto-xref"><span>Seção 15.3.2.5</span></a>) e observando o gráfico quantil-quantil (Q-Q) dos resíduos padronizados.</li>
<li><strong>Homogeneidade de Variância dos erros/resíduos</strong>: os erros devem ter média zero e desvio padrão constante ao longo das observações. Similar ao teste de Levene, mas aplicado aos resíduos da regressão. Pode ser testado usando o Teste de Breusch-Pagan (veja a <a href="15-correlacao-regressao.html#sec-BP" class="quarto-xref"><span>Seção 15.3.2.4</span></a>).</li>
<li><strong>Ausência de Multicolinearidade</strong>: multicolinearidade é a ocorrência de alta correlação entre duas ou mais variáveis independentes e pode levar a resultados distorcidos. Em geral, a multicolinearidade pode fazer com que os intervalos de confiança se ampliem, ou até mudar o sinal de influência das variáveis independentes (de positivo para negativo, por exemplo). Portanto, as inferências estatísticas de uma regressão com multicolinearidade não são confiáveis. Pode ser testado usando o Fator de Inflação de Variância (<em>Variance Inflation Factor</em> – VIF, veja a <a href="#sec-vif" class="quarto-xref"><span>Seção 18.8.5.3</span></a>).</li>
</ol>
</section>
<section id="dados-para-a-regressão-logística" class="level3" data-number="18.8.3">
<h3 data-number="18.8.3" class="anchored" data-anchor-id="dados-para-a-regressão-logística"><span class="header-section-number">18.8.3</span> Dados para a regressão logística</h3>
<p>O RMS Titanic (<a href="#fig-titanic" class="quarto-xref">Figura&nbsp;<span>18.11</span></a>), considerado o navio inafundável de sua época, sofreu um trágico destino em sua viagem inaugural com destino a Nova Iorque. Construído com o intuito de ser o maior e mais luxuoso transatlântico, o Titanic colidiu com um iceberg na noite de 14 de abril de 1912, no Oceano Atlântico Norte, afundando rapidamente e causando a morte de inúmeras pessoas.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-titanic" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" data-fig-pos="H">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-titanic-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="https://imgur.com/54il14d.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:50.0%" data-fig-pos="H">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-titanic-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figura&nbsp;18.11: Titanic parado em Queenstown, 11 de abril.de 1912
</figcaption>
</figure>
</div>
</div>
</div>
<p>O Titanic partiu em sua primeira e única viagem com 1 316 passageiros a bordo: 325 na primeira classe, 285 na segunda e 706 na terceira. Deles, 922 embarcaram em Southampton, 274 em Cherbourg-Octeville na França e 120 em Queenstown na Irlanda. Além desses passageiros, havia 908 tripulantes, totalizando m 2224 pessoas. O número total de mortos mais aceito é 1514, quase 70% dos que embarcaram na viagem <span class="citation" data-cites="wiki:xxx">(<a href="references.html#ref-wiki:xxx" role="doc-biblioref">46</a>)</span>. Os dados de 1309 passageiros estão em um arquivo denominado <code>dadosTitanic.xlsx</code>, obtido no pacote titanic, modificado estruturalmente e traduzido, sem alterar os dados, para chegar a este arquivo que pode ser baixado <a href="https://github.com/petronioliveira/Arquivos/blob/main/dadosTitanic.xlsx">aqui</a>. Possui 1309 observações e 12 variáveis:</p>
<p>• <strong>id</strong> <span class="math inline">\(\longrightarrow\)</span> identificação do passageiro<br>
• <strong>sobreviveu</strong> <span class="math inline">\(\longrightarrow\)</span> 0 = não; 1 = sim<br>
• <strong>classe</strong> <span class="math inline">\(\longrightarrow\)</span> classe do passageiro (categórica): 1 = 1ª classe; 2 = 2ª classe e 3 = 3ª classe (qualitativa)<br>
• <strong>nome</strong> <span class="math inline">\(\longrightarrow\)</span> nome do passageiro (nominal)<br>
• <strong>sexo</strong> <span class="math inline">\(\longrightarrow\)</span> masc = masculino; fem = feminino (binária)<br>
• <strong>idade</strong> <span class="math inline">\(\longrightarrow\)</span> idade em anos (numérica contínua)<br>
• <strong>irco</strong> <span class="math inline">\(\longrightarrow\)</span> número de irmãos/cônjuges a bordo (numérica discreta)<br>
• <strong>pafi</strong> <span class="math inline">\(\longrightarrow\)</span> número de pais/filhos a bordo (numérica discreta)<br>
• <strong>ticket</strong> <span class="math inline">\(\longrightarrow\)</span> número do bilhete de embarque (nominal)<br>
• <strong>tarifa</strong> <span class="math inline">\(\longrightarrow\)</span> valor pago pela passagem em dólares (numérica contínua)<br>
• <strong>cabine</strong> <span class="math inline">\(\longrightarrow\)</span> número de identificação da cabine (nominal)<br>
• <strong>porto_embarque</strong> <span class="math inline">\(\longrightarrow\)</span> porto de embarque: C = Cherbourg, Q = Queenstown, S = Southampton</p>
<section id="leitura-dos-dados" class="level4" data-number="18.8.3.1">
<h4 data-number="18.8.3.1" class="anchored" data-anchor-id="leitura-dos-dados"><span class="header-section-number">18.8.3.1</span> Leitura dos dados</h4>
<p>Após fazer o download do banco de dados em seu diretório <a href="#fn8" class="footnote-ref" id="fnref8" role="doc-noteref"><sup>8</sup></a>, carregue-o no <em>RStudio</em>, usando a função <code>read_excel()</code> do pacote <code>readxl</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb139"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb139-1"><a href="#cb139-1" aria-hidden="true" tabindex="-1"></a>dadosTitanic <span class="ot">&lt;-</span> readxl<span class="sc">::</span><span class="fu">read_excel</span>(<span class="st">"dados/dadosTitanic.xlsx"</span>)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="explorando-e-preparando-os-dados" class="level4" data-number="18.8.3.2">
<h4 data-number="18.8.3.2" class="anchored" data-anchor-id="explorando-e-preparando-os-dados"><span class="header-section-number">18.8.3.2</span> Explorando e preparando os dados</h4>
<p>Dê uma olhada nas variáveis do banco de dados. Para essa ação, pode-se usar a função <code>str()</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb140"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb140-1"><a href="#cb140-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(dadosTitanic)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>tibble [1,309 × 12] (S3: tbl_df/tbl/data.frame)
 $ id            : num [1:1309] 1 2 3 4 5 6 7 8 9 10 ...
 $ sobreviveu    : num [1:1309] 0 1 1 1 0 0 0 0 1 1 ...
 $ classe        : num [1:1309] 3 1 3 1 3 3 1 3 3 2 ...
 $ nome          : chr [1:1309] "Braund, Mr. Owen Harris" "Cumings, Mrs. John Bradley (Florence Briggs Thayer)" "Heikkinen, Miss. Laina" "Futrelle, Mrs. Jacques Heath (Lily May Peel)" ...
 $ sexo          : chr [1:1309] "masc" "fem" "fem" "fem" ...
 $ idade         : num [1:1309] 22 38 26 35 35 NA 54 2 27 14 ...
 $ irco          : num [1:1309] 1 1 0 1 0 0 0 3 0 1 ...
 $ pafi          : num [1:1309] 0 0 0 0 0 0 0 1 2 0 ...
 $ ticket        : chr [1:1309] "A/5 21171" "PC 17599" "STON/O2. 3101282" "113803" ...
 $ tarifa        : num [1:1309] 7.25 71.28 7.92 53.1 8.05 ...
 $ cabine        : chr [1:1309] NA "C85" NA "C123" ...
 $ porto_embarque: chr [1:1309] "S" "C" "S" "S" ...</code></pre>
</div>
</div>
<p>Observa-se que se tem um <em>tibble</em> com 1309 linhas (casos = passageiros) e 12 colunas (variáveis). Algumas dessas variáveis não terão utilidade para a análise de regressão logística: por exemplo, a coluna índice (<code>id</code>), o nome do passageiro, o número do ticket de embarque, a tarifa, o número da cabine e o porto de embarque. Elas serão removidas do banco de dados, usando a função <code>select()</code> do pacote <code>dplyr</code> (veja a <a href="05-manipulandoDados.html#sec-mater" class="quarto-xref"><span>Seção 5.3</span></a>):</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb142"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb142-1"><a href="#cb142-1" aria-hidden="true" tabindex="-1"></a>dadosTitanic <span class="ot">&lt;-</span> dplyr<span class="sc">::</span><span class="fu">select</span>(dadosTitanic, </span>
<span id="cb142-2"><a href="#cb142-2" aria-hidden="true" tabindex="-1"></a>                              <span class="sc">-</span><span class="fu">c</span>(id, nome, ticket, tarifa, cabine, porto_embarque))</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="verificando-e-tratando-os-dados-omissos" class="level4" data-number="18.8.3.3">
<h4 data-number="18.8.3.3" class="anchored" data-anchor-id="verificando-e-tratando-os-dados-omissos"><span class="header-section-number">18.8.3.3</span> Verificando e tratando os dados omissos</h4>
<p>Para verificar os NAs no banco de dados, pode-se usar o comando que soma os dados faltantes em cada coluna do banco de dados:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb143"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb143-1"><a href="#cb143-1" aria-hidden="true" tabindex="-1"></a><span class="fu">colSums</span>(<span class="fu">is.na</span>(dadosTitanic))</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>sobreviveu     classe       sexo      idade       irco       pafi 
         0          0          0        263          0          0 </code></pre>
</div>
</div>
<p>A coluna da variável <code>idade</code> contém 263 valores faltantes, ou seja, 20% estão ausentes. A melhor forma de tratar dados faltantes depende de diversos fatores, como <span class="citation" data-cites="Prabhakaran_2016">(<a href="references.html#ref-Prabhakaran_2016" role="doc-biblioref">47</a>)</span> :</p>
<ul>
<li><em>Mecanismo de geração dos dados faltantes</em>: Por que os dados estão faltando? É aleatório, relacionado a outras variáveis ou a alguma característica da população?<br>
</li>
<li><em>Quantidade de dados faltantes</em>: 263 valores faltantes representam uma proporção considerável dos dados (20%).<br>
</li>
<li><em>Impacto na análise</em>: Como a presença de dados faltantes pode afetar os resultados da sua análise?</li>
</ul>
<p>O que fazer?</p>
<ol type="1">
<li><strong>Exclusão de casos</strong>:</li>
</ol>
<!-- -->
<ol type="a">
<li><em>Listwise deletion</em>: Remover todas as observações com algum dado faltante. Não recomendado neste caso, pois você perderia uma quantidade significativa de dados.</li>
<li><em>Pairwise deletion</em>: Utilizar todas as observações disponíveis para cada análise. Pode gerar resultados inconsistentes.</li>
</ol>
<!-- -->
<ol start="2" type="1">
<li><strong>Imputação</strong>:</li>
</ol>
<!-- -->
<ol type="a">
<li><em>Imputação por média, mediana ou moda</em>: Substituir os valores faltantes pela média, mediana ou moda da variável. Simples, mas pode subestimar a variância.<br>
</li>
<li><em>Imputação por regressão</em>: Utilizar um modelo de regressão para prever os valores faltantes com base em outras variáveis. Mais preciso, mas pode ser enviesado se o modelo não for adequado.<br>
</li>
<li><em>Imputação múltipla</em>: Criar múltiplos conjuntos de dados, cada um com diferentes valores imputados, e combinar os resultados das análises. Método mais robusto e permite estimar a incerteza.<br>
</li>
<li><em>Imputação por K-Nearest Neighbors</em>: Substituir os valores faltantes pela média dos <em>k</em> vizinhos mais próximos. Útil para dados numéricos e pode capturar padrões locais.</li>
</ol>
<p>Considerando a quantidade de dados faltantes e a natureza da variável <code>idade</code>, a imputação múltipla é uma excelente opção. Ela permite lidar com a incerteza associada aos valores imputados e fornece uma estimativa mais precisa dos parâmetros do modelo. Para isso, será usada a função <code>mice()</code> do pacote <code>mice</code> (<em>Multivariate Imputation by Chained Equations</em>) <span class="citation" data-cites="van2011mice">(<a href="references.html#ref-van2011mice" role="doc-biblioref">48</a>)</span> para fazer a imputação múltipla. O argumento <code>m = 5</code> se refere ao número de múltiplas imputações (cinco é o padrão); <code>method = “pmm”</code> é o método de imputação, onde se usa a correspondência da média preditiva (predictive mean matching – dados numéricos) como método de imputação. O método <code>pmm</code> garante que os valores imputados sejam próximos de valores reais do conjunto de dados, mantendo a coerência estatística. A função <code>mice()</code> produz várias cópias completas de <em>dataframe</em>, cada uma com diferentes imputações dos dados ausentes. Essa transformação será atribuída a um objeto de nome <code>dados</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb145"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb145-1"><a href="#cb145-1" aria-hidden="true" tabindex="-1"></a>dados <span class="ot">&lt;-</span> mice<span class="sc">::</span><span class="fu">mice</span>(dadosTitanic, <span class="at">m=</span><span class="dv">5</span>, <span class="at">method=</span><span class="st">"pmm"</span>)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
 iter imp variable
  1   1  idade
  1   2  idade
  1   3  idade
  1   4  idade
  1   5  idade
  2   1  idade
  2   2  idade
  2   3  idade
  2   4  idade
  2   5  idade
  3   1  idade
  3   2  idade
  3   3  idade
  3   4  idade
  3   5  idade
  4   1  idade
  4   2  idade
  4   3  idade
  4   4  idade
  4   5  idade
  5   1  idade
  5   2  idade
  5   3  idade
  5   4  idade
  5   5  idade</code></pre>
</div>
</div>
<p>A seguir, cria-se um novo dataframe com os dados imputados, usando a função <code>complete()</code>, também do pacote <code>mice</code>. Essa função retorna um ou vários desses conjuntos de dados, sendo que o padrão é o primeiro. Este novo conjunto de dados será atribuído ao objeto <code>dados_completos</code>. O comando escolhe a primeira imputação:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb147"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb147-1"><a href="#cb147-1" aria-hidden="true" tabindex="-1"></a>dados_completos <span class="ot">&lt;-</span> mice<span class="sc">::</span><span class="fu">complete</span>(dados, <span class="dv">1</span>) </span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><u>Analizando os <code>dados_completos</code></u></p>
<p>Novamente, se usará as funções <code>colSums(is.na())</code> e <code>str()</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb148"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb148-1"><a href="#cb148-1" aria-hidden="true" tabindex="-1"></a><span class="fu">colSums</span>(<span class="fu">is.na</span>(dados_completos))</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>sobreviveu     classe       sexo      idade       irco       pafi 
         0          0          0          0          0          0 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb150"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb150-1"><a href="#cb150-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(dados_completos)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>'data.frame':   1309 obs. of  6 variables:
 $ sobreviveu: num  0 1 1 1 0 0 0 0 1 1 ...
 $ classe    : num  3 1 3 1 3 3 1 3 3 2 ...
 $ sexo      : chr  "masc" "fem" "fem" "fem" ...
 $ idade     : num  22 38 26 35 35 48 54 2 27 14 ...
 $ irco      : num  1 1 0 1 0 0 0 3 0 1 ...
 $ pafi      : num  0 0 0 0 0 0 0 1 2 0 ...</code></pre>
</div>
</div>
<p>Agora, existem 1309 observações e 7 variáveis. Os dados faltantes não estão mais presentes, foram substituídos.</p>
</section>
<section id="outras-transformações-necessárias" class="level4" data-number="18.8.3.4">
<h4 data-number="18.8.3.4" class="anchored" data-anchor-id="outras-transformações-necessárias"><span class="header-section-number">18.8.3.4</span> Outras transformações necessárias</h4>
<p>Ainda há necessidade de outras transformações, pois verifica-se que existem variáveis classificadas como numéricas (<code>classe</code>, <code>sexo</code> e a variável desfecho <code>sobreviveu</code>), mas que são fatores. Esta modificação será realizada, usando a função <code>mutate()</code> do pacote <code>dplyr</code>(veja a <a href="05-manipulandoDados.html#sec-mater" class="quarto-xref"><span>Seção 5.3</span></a>):</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb152"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb152-1"><a href="#cb152-1" aria-hidden="true" tabindex="-1"></a>dados_completos <span class="ot">&lt;-</span> dados_completos <span class="sc">%&gt;%</span></span>
<span id="cb152-2"><a href="#cb152-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">sexo =</span> <span class="fu">factor</span>(sexo)) <span class="sc">%&gt;%</span></span>
<span id="cb152-3"><a href="#cb152-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">classe =</span> <span class="fu">factor</span>(classe)) <span class="sc">%&gt;%</span> </span>
<span id="cb152-4"><a href="#cb152-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">sobreviveu =</span> <span class="fu">factor</span>(sobreviveu))</span>
<span id="cb152-5"><a href="#cb152-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb152-6"><a href="#cb152-6" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(dados_completos)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>'data.frame':   1309 obs. of  6 variables:
 $ sobreviveu: Factor w/ 2 levels "0","1": 1 2 2 2 1 1 1 1 2 2 ...
 $ classe    : Factor w/ 3 levels "1","2","3": 3 1 3 1 3 3 1 3 3 2 ...
 $ sexo      : Factor w/ 2 levels "fem","masc": 2 1 1 1 2 2 2 2 1 1 ...
 $ idade     : num  22 38 26 35 35 48 54 2 27 14 ...
 $ irco      : num  1 1 0 1 0 0 0 3 0 1 ...
 $ pafi      : num  0 0 0 0 0 0 0 1 2 0 ...</code></pre>
</div>
</div>
<p>Finalmente, os dados estão prontos para se iniciar a análise de regressão logística <a href="#fn9" class="footnote-ref" id="fnref9" role="doc-noteref"><sup>9</sup></a>.</p>
</section>
</section>
<section id="construção-do-modelo-de-regressão-logística" class="level3" data-number="18.8.4">
<h3 data-number="18.8.4" class="anchored" data-anchor-id="construção-do-modelo-de-regressão-logística"><span class="header-section-number">18.8.4</span> Construção do Modelo de Regressão Logística</h3>
<section id="divisão-dos-dados-em-treino-e-teste" class="level4" data-number="18.8.4.1">
<h4 data-number="18.8.4.1" class="anchored" data-anchor-id="divisão-dos-dados-em-treino-e-teste"><span class="header-section-number">18.8.4.1</span> Divisão dos dados em Treino e Teste</h4>
<p>A divisão dos dados em conjuntos de <em>treino</em> e <em>teste</em> é uma prática frequente em aprendizado de regressão logística. Serve para avaliar a performance de um modelo de forma imparcial precisa. O conjunto de Treino é a parte dos dados que o modelo utiliza para aprender as relações entre as variáveis independentes e a variável dependente. O modelo analisa esses dados para encontrar os melhores coeficientes que descrevem a relação entre as variáveis. O conjunto de Teste é a parte dos dados que o modelo não analisou durante o treinamento. Ele é utilizado para avaliar a capacidade do modelo de fazer previsões em novos dados. Ao comparar as previsões do modelo com os valores reais no conjunto de teste, podemos medir a sua precisão e generalização. Essa técnica é utilizada para evitar o excesso de ajuste dos dados (<em>overfitting</em>) <span class="citation" data-cites="subramanian2013over">(<a href="references.html#ref-subramanian2013over" role="doc-biblioref">49</a>)</span>, estimar a acurácia do modelo e comparação de modelos. A divisão mais comum é 70% para treinamento e 30% para teste, mas essa proporção pode variar dependendo do tamanho do conjunto de dados e da complexidade do problema.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb154"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb154-1"><a href="#cb154-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Definindo a semente para reprodutibilidade</span></span>
<span id="cb154-2"><a href="#cb154-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb154-3"><a href="#cb154-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb154-4"><a href="#cb154-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Embaralhando os dados</span></span>
<span id="cb154-5"><a href="#cb154-5" aria-hidden="true" tabindex="-1"></a>dados_completos <span class="ot">&lt;-</span> dados_completos <span class="sc">%&gt;%</span> <span class="fu">sample_frac</span>(<span class="at">size =</span> <span class="dv">1</span>)</span>
<span id="cb154-6"><a href="#cb154-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb154-7"><a href="#cb154-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Definindo o ponto de corte para treino</span></span>
<span id="cb154-8"><a href="#cb154-8" aria-hidden="true" tabindex="-1"></a>split_index <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fl">0.7</span> <span class="sc">*</span> <span class="fu">nrow</span>(dados_completos))</span>
<span id="cb154-9"><a href="#cb154-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb154-10"><a href="#cb154-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Dividindo os dados</span></span>
<span id="cb154-11"><a href="#cb154-11" aria-hidden="true" tabindex="-1"></a>dadosTreino <span class="ot">&lt;-</span> dados_completos <span class="sc">%&gt;%</span> <span class="fu">slice</span>(<span class="dv">1</span><span class="sc">:</span>split_index)</span>
<span id="cb154-12"><a href="#cb154-12" aria-hidden="true" tabindex="-1"></a>dadosTeste <span class="ot">&lt;-</span> dados_completos <span class="sc">%&gt;%</span> <span class="fu">slice</span>((split_index <span class="sc">+</span> <span class="dv">1</span>)<span class="sc">:</span><span class="fu">n</span>())</span>
<span id="cb154-13"><a href="#cb154-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb154-14"><a href="#cb154-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualizando o tamanho das amostras</span></span>
<span id="cb154-15"><a href="#cb154-15" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(dadosTreino)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 916   6</code></pre>
</div>
<div class="sourceCode cell-code" id="cb156"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb156-1"><a href="#cb156-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(dadosTeste)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 393   6</code></pre>
</div>
<div class="sourceCode cell-code" id="cb158"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb158-1"><a href="#cb158-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Explorando a estrutura dos dadosTreino</span></span>
<span id="cb158-2"><a href="#cb158-2" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span> (dadosTreino)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>'data.frame':   916 obs. of  6 variables:
 $ sobreviveu: Factor w/ 2 levels "0","1": 2 1 1 1 2 1 2 2 2 1 ...
 $ classe    : Factor w/ 3 levels "1","2","3": 3 1 2 3 1 1 2 2 3 1 ...
 $ sexo      : Factor w/ 2 levels "fem","masc": 2 2 2 2 1 2 1 1 1 2 ...
 $ idade     : num  44 47 30 40.5 44 45 0.92 24 22 36 ...
 $ irco      : num  0 0 0 0 0 0 1 1 2 0 ...
 $ pafi      : num  0 0 0 0 0 0 2 1 0 0 ...</code></pre>
</div>
<div class="sourceCode cell-code" id="cb160"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb160-1"><a href="#cb160-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(dadosTeste)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>'data.frame':   393 obs. of  6 variables:
 $ sobreviveu: Factor w/ 2 levels "0","1": 1 2 1 2 2 1 1 2 1 1 ...
 $ classe    : Factor w/ 3 levels "1","2","3": 1 3 3 3 1 2 3 1 3 3 ...
 $ sexo      : Factor w/ 2 levels "fem","masc": 2 1 2 2 1 2 1 1 2 1 ...
 $ idade     : num  30 18 7 25 60 30 8 22 51 28 ...
 $ irco      : num  1 0 4 0 1 1 3 0 0 0 ...
 $ pafi      : num  2 0 1 0 0 1 1 2 0 0 ...</code></pre>
</div>
</div>
<p>A função <code>sample_frac()</code> do pacote <code>dplyr</code> tem a função de embaralhar os dados para garantir a aleatoriedade; o argumento <code>size =1</code> significa a fração de linhas selecionadas (0 e 1), sendo 1 (u)m equivalente a 100% das linhas. A função <code>slice()</code>, também do pacote <code>dplyr</code>, primeiro seleciona as primeiras 70% observações para treino e as últimas 30% para teste. Por último, a função <code>str()</code>, visualiza os <code>dadosTreino</code> que serão utilizados na construção do modelo de regressão logística.</p>
</section>
<section id="sec-modreglog" class="level4" data-number="18.8.4.2">
<h4 data-number="18.8.4.2" class="anchored" data-anchor-id="sec-modreglog"><span class="header-section-number">18.8.4.2</span> Criação do Modelo de Regressão Logística</h4>
<p>Inicialmente, serão usados os <code>dadosTreino</code> para criar o modelo de regressão logística.</p>
<p>No modelo, a variável resposta ou desfecho é representada por <code>sobreviveu</code>; todas as outras variáveis são variáveis explicativas.</p>
<p>A função nativa <code>glm()</code> – <em><strong>g</strong>eneralized <strong>l</strong>inear <strong>m</strong>odel - é usada</em> para aplicar uma regressão logística no <em>R</em>. Sua funcionalidade é idêntica à função <code>lm()</code> da regressão linear. Necessita alguns argumentos:</p>
<ul>
<li><p><strong>formula</strong> <span class="math inline">\(\to\)</span> objeto da classe <em>formula</em>. Um preditor típico tem o formato <code>resposta \~ preditor</code> em que <code>resposta</code>, na regressão logística binária, é uma variável dicotômica e o <code>preditor</code> pode ser uma série de variáveis numéricas ou categóricas;</p></li>
<li><p><strong>family</strong> <span class="math inline">\(\to\)</span> uma descrição da distribuição de erro e função de <em>link</em> a ser usada no modelo <code>glm</code>, pode ser uma <em>string</em> que nomeia uma função de <em>family</em>. O padrão é <code>family = gaussian()</code>. No caso da regressão logística binária, <code>family = binomial()</code> ou <code>family = binomial (link =”logit”)</code>. Para outras informações, use <code>help(glm)</code> ou <code>help(family)</code>;</p></li>
<li><p><strong>data</strong> <span class="math inline">\(\to\)</span> banco de dados.</p></li>
<li><p><strong>…</strong> <span class="math inline">\(\to\)</span> ………….</p></li>
</ul>
<p>Dentro dos parênteses da função <code>glm()</code>, são fornecidas informações essenciais sobre o modelo. À esquerda do til <code>(~)</code>, encontra-se a variável dependente, que deve ser codificada como 0 e 1 para que a função a interprete corretamente como binária. Após o til, são listadas as variáveis preditoras. Quando se utiliza um ponto (<code>~.</code>), isso indica a inclusão de todas as variáveis preditoras disponíveis. Já o uso do asterisco (<code>*</code>) entre duas variáveis preditoras especifica que, além dos efeitos principais, também deve ser considerado um termo de interação entre elas. No exemplo apresentado, essa análise, inicialmente, não será solicitada. Por fim, após a vírgula, define-se que a distribuição utilizada é a binomial. Como a função <code>glm</code> usa <code>logit</code> como link padrão para uma variável de desfecho binomial, não há necessidade de especificá-lo explicitamente no modelo.</p>
<p>O modelo inicial de regressão logística do tipo entrada forçada (<code>enter</code>), método padrão de conduzir uma regressão, que consiste em simplesmente colocar todos os preditores no modelo de regressão em um bloco e estimar parâmetros para cada um <span class="citation" data-cites="field2012logit">(<a href="references.html#ref-field2012logit" role="doc-biblioref">50</a>)</span>. O dataframe <code>dadosTreino.xlsx</code> será usado com todos os preditores dentro da função. O objeto criado será denominado de <code>modelo1</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb162"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb162-1"><a href="#cb162-1" aria-hidden="true" tabindex="-1"></a>modelo1 <span class="ot">&lt;-</span> <span class="fu">glm</span>(sobreviveu <span class="sc">~</span>., </span>
<span id="cb162-2"><a href="#cb162-2" aria-hidden="true" tabindex="-1"></a>               <span class="at">data =</span> dadosTreino, </span>
<span id="cb162-3"><a href="#cb162-3" aria-hidden="true" tabindex="-1"></a>               <span class="at">family =</span> <span class="fu">binomial</span>(<span class="at">link =</span> <span class="st">"logit"</span>))</span>
<span id="cb162-4"><a href="#cb162-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-5"><a href="#cb162-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(modelo1)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = sobreviveu ~ ., family = binomial(link = "logit"), 
    data = dadosTreino)

Coefficients:
             Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)  3.705414   0.386251   9.593  &lt; 2e-16 ***
classe2     -1.040567   0.272522  -3.818 0.000134 ***
classe3     -2.035809   0.256852  -7.926 2.26e-15 ***
sexomasc    -3.567786   0.219514 -16.253  &lt; 2e-16 ***
idade       -0.022291   0.006916  -3.223 0.001268 ** 
irco        -0.385627   0.112853  -3.417 0.000633 ***
pafi        -0.074808   0.116112  -0.644 0.519396    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 1210.4  on 915  degrees of freedom
Residual deviance:  722.4  on 909  degrees of freedom
AIC: 736.4

Number of Fisher Scoring iterations: 5</code></pre>
</div>
</div>
</section>
<section id="interpretação-dos-coeficientes" class="level4" data-number="18.8.4.3">
<h4 data-number="18.8.4.3" class="anchored" data-anchor-id="interpretação-dos-coeficientes"><span class="header-section-number">18.8.4.3</span> Interpretação dos Coeficientes</h4>
<p>Em uma regressão logística, a resposta que está sendo modelada é o <code>log(odds)</code> ou <code>logit</code> de que o desfecho é igual a 1. Os coeficientes de regressão fornecem a mudança no <code>log(odds)</code> no desfecho para a mudança de uma unidade na variável preditora, mantendo todas as outras variáveis preditivas constantes <span class="citation" data-cites="hosmer2013applied">(<a href="references.html#ref-hosmer2013applied" role="doc-biblioref">51</a>)</span>.</p>
<p>Na saída da função <code>summary()</code>, são produzidos os coeficientes da regressão na coluna <code>Estimate</code>, associados ao respectivos desvio padrão dos resíduos (<code>Std. Error</code>), o valor <code>z</code> (estatística de Wald) e os valores do <em>P</em> (<code>Pr(&gt;|t|</code>). Importante destacar que a hipótese nula dos coeficientes da regressão é de que “os coeficientes são nulos/zeros”. Então, os valores <em>P</em> devem ser interpretados como a probabilidade de se observar valores de coeficientes tão extremos dado que a hipótese nula é verdadeira. Estes coeficientes estão modelando a probabilidade do evento desfecho (<code>sobreviveu</code>) ocorrer com base nas variáveis explicativas (<code>sexo</code>, <code>idade</code>, <code>classe</code> do passageiro, número de irmãos/conjuges [<code>irco</code>] a bordo e número de pais/filhos [<code>pafi</code>] a bordo). Os coeficientes da regressão representam o impacto de cada variável explicativa na probabilidade de sobrevivência.</p>
<p>Nas <em>variáveis contínuas</em> , para cada aumento de uma unidade na <code>idade</code>, por exemplo, o <span class="math inline">\(log(odds)\)</span> de sobreviver <code>1 = sim</code> (versus <code>0 = não</code>) diminui, pois o coeficiente é negativo, em -0.0222909.</p>
<p>Para <em>variáveis categóricas</em>, o desempenho de cada categoria é avaliado em relação a uma categoria de base. A categoria de base para a variável <code>sexo</code> é o sexo feminino (primeira categoria que aparece quando se observa os níveis) e para a classe do passageiro é a 1ª classe.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb164"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb164-1"><a href="#cb164-1" aria-hidden="true" tabindex="-1"></a><span class="fu">levels</span>(dadosTreino<span class="sc">$</span>sexo)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "fem"  "masc"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb166"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb166-1"><a href="#cb166-1" aria-hidden="true" tabindex="-1"></a><span class="fu">levels</span>(dadosTreino<span class="sc">$</span>classe)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "1" "2" "3"</code></pre>
</div>
</div>
<p>Resumindo:</p>
<ul>
<li><strong>(Intercept)</strong>: Representa o <code>log(odds)</code> de sobreviver para um indivíduo com todas as variáveis explicativas iguais a zero (ou a sua categoria de referência). No contexto do Titanic, seria um indivíduo do sexo feminino, com idade zero e da 1ª classe. Não tem interpretação prática direta, nesse caso, pois não há passageiros com idade zero. Serve como ponto de partida para comparar os outros coeficientes.<br>
</li>
<li><strong>classe2</strong>: O coeficiente negativo indica que os passageiros da segunda classe tinham menor probabilidade de sobreviver comparados aos da primeira classe (a categoria de referência).<br>
</li>
<li><strong>classe3</strong>: O coeficiente negativo) indica que os passageiros da terceira classe tinham muito menor probabilidade de sobreviver comparados aos da primeira classe.</li>
<li><strong>sexomasc</strong>: O coeficiente negativo indica que ser do sexo masculino diminui significativamente a probabilidade de sobreviver, comparado a ser do sexo feminino (a categoria de referência). Ou seja, os homens tinham menos chances de sobreviver.<br>
</li>
<li><strong>idade</strong>: O coeficiente negativo indica que cada aumento de um ano na idade diminui ligeiramente a probabilidade de sobreviver. Isso sugere que as crianças tinham mais chances de sobreviver do que os adultos.<br>
</li>
<li><strong>irco</strong> : Ter mais irmãos ou cônjuges a bordo reduziu a chance de sobrevivência.</li>
<li><strong>pafi</strong>: O número de pais ou filhos a bordo não teve um efeito estatisticamente significativo na sobrevivência (valor <em>P</em> alto).</li>
</ul>
<p><u>Outras métricas da saída do sumário do modelo</u></p>
<ul>
<li><strong>Significância estatística</strong>: o <em>R</em>, para facilitar, informa com asteriscos quais variáveis possuem coeficientes estatisticamente significativos: * para <em>P &lt; 0,05, ** para</em> P* &lt; 0,01, e *** para <em>P</em> &lt; 0,001.<br>
</li>
<li><strong>Deviance residual</strong>: Indica o ajuste do modelo; quanto menor, melhor.<br>
</li>
<li><strong>AIC (Critério de Informação de Akaike)</strong> <a href="#fn10" class="footnote-ref" id="fnref10" role="doc-noteref"><sup>10</sup></a>: Ajuda a comparar modelos; quanto menor, melhor o ajuste e a simplicidade.</li>
</ul>
</section>
<section id="avaliação-do-impacto-com-a-função-anova" class="level4" data-number="18.8.4.4">
<h4 data-number="18.8.4.4" class="anchored" data-anchor-id="avaliação-do-impacto-com-a-função-anova"><span class="header-section-number">18.8.4.4</span> Avaliação do impacto com a função anova()</h4>
<p>Além de interpretar os coeficientes, mostrados na saída do sumário do modelo gerado pela função <code>glm()</code>, pode-se usar a função <code>anova()</code> para observar o impacto da adição de cada variável no modelo:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb168"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb168-1"><a href="#cb168-1" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(modelo1, <span class="at">test=</span><span class="st">'Chisq'</span>)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Deviance Table

Model: binomial, link: logit

Response: sobreviveu

Terms added sequentially (first to last)

       Df Deviance Resid. Df Resid. Dev  Pr(&gt;Chi)    
NULL                     915    1210.44              
classe  2    63.38       913    1147.06 1.728e-14 ***
sexo    1   401.14       912     745.92 &lt; 2.2e-16 ***
idade   1     6.25       911     739.66   0.01239 *  
irco    1    16.85       910     722.82 4.049e-05 ***
pafi    1     0.42       909     722.40   0.51835    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<p><u>Principais pontos</u></p>
<ul>
<li><strong>NULL Deviance</strong>: Representa o desvio do modelo sem preditores (modelo apenas com o intercepto).</li>
<li><strong>Residual Deviance</strong>: Indica o desvio do modelo conforme as variáveis são adicionadas. Um menor valor de deviance indica um melhor ajuste.</li>
<li><strong>Pr(&gt;Chi)</strong>: Valor <em>P</em> do teste qui-quadrado para cada variável, verificando se sua inclusão melhora significativamente o modelo.</li>
</ul>
<p><u>Interpretação das variáveis</u></p>
<ul>
<li><strong>classe</strong>: A inclusão da classe do passageiro reduz significativamente o desvio (<em>deviance</em>), indicando que a classe é um preditor importante.</li>
<li><strong>sexo</strong>: O sexo é a variável que mais reduz o desvio, confirmando que ser mulher aumentava a chance de sobrevivência.</li>
<li><strong>idade</strong>: A idade tem um efeito significativo na sobrevivência, mas menor que classe e sexo</li>
<li><strong>irco</strong>: Número de irmãos/cônjuges tem um impacto relevante.</li>
<li><strong>pafi</strong>: O número de pais/filhos a bordo não melhora significativamente o modelo (<em>P</em> &gt; 0.05), sugerindo que essa variável não tem grande impacto na sobrevivência.</li>
</ul>
<p><u>Conclusão</u></p>
<p>O modelo sugere que <code>classe</code>, <code>sexo</code>, <code>idade</code> e <code>irco</code> (número de irmãos/cônjuges) são fatores relevantes para prever a sobrevivência. Por outro lado, número de pais/filhos não tem um impacto significativo. Isso pode indicar que ter viajado com crianças não afetou tanto a probabilidade de sobrevivência.</p>
</section>
<section id="uso-do-odds-ratio-or-na-interpretação-dos-coeficientes" class="level4" data-number="18.8.4.5">
<h4 data-number="18.8.4.5" class="anchored" data-anchor-id="uso-do-odds-ratio-or-na-interpretação-dos-coeficientes"><span class="header-section-number">18.8.4.5</span> Uso do Odds Ratio (OR) na interpretação dos coeficientes</h4>
<p>Numericamente, os coeficientes de regressão logística não são facilmente interpretáveis em escala bruta, pois estão representados como <code>log (odds)</code> ou <code>logit</code> . Para tornar mais simples, pode-se inverter a transformação logística exponenciando os coeficientes (<span class="math inline">\(e^x\)</span>). Isso faz com que os coeficientes se transformem em razões de chance (<em>odds ratio</em>), ficando mais intuitivos facilitando a interpretação. Isso é realizado pela função <code>exp()</code> e pela função <code>confint()</code>, que retorna os intervalos de confiança de 95%:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb170"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb170-1"><a href="#cb170-1" aria-hidden="true" tabindex="-1"></a>odds_ratio1 <span class="ot">&lt;-</span> <span class="fu">round</span> (<span class="fu">exp</span>(<span class="fu">cbind</span>(<span class="at">OR =</span> <span class="fu">coef</span>(modelo1), <span class="fu">confint</span>(modelo1))), <span class="dv">3</span>)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Waiting for profiling to be done...</code></pre>
</div>
<div class="sourceCode cell-code" id="cb172"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb172-1"><a href="#cb172-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(odds_ratio1)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                OR  2.5 % 97.5 %
(Intercept) 40.667 19.427 88.459
classe2      0.353  0.206  0.599
classe3      0.131  0.078  0.214
sexomasc     0.028  0.018  0.043
idade        0.978  0.965  0.991
irco         0.680  0.538  0.839
pafi         0.928  0.737  1.163</code></pre>
</div>
</div>
<p>Observando, novamente, a variável <code>idade</code>, vê-se que à medida que ela aumenta, reduz a chance de sobrevivência no naufrágio do Titanic. A <em>OR</em> nos informa que a cada aumento de uma unidade na <code>idade</code>, há uma diminuição na chance de sobrevivência (<code>sobreviveu = 1</code>) de <span class="math inline">\(1 – OR \times 100\)</span>%, ou seja, uma diminuição de 2.2%.<br>
Para o sexo masculino, há uma diminuição (coeficiente negativo) na chance de sobrevivência. O fato de ser homem reduz em 97.2% a chance de sobreviver.<br>
Para a 3ª classe, comparada à 1ª classe, há uma diminuição de 86.9% na chance de sobrevivência. Da mesma forma a 2ª classe, comparada à 1ª classe, tem uma diminuição de 64.7%% na chance de sobrevivência <a href="#fn11" class="footnote-ref" id="fnref11" role="doc-noteref"><sup>11</sup></a>.</p>
</section>
<section id="visualização-da-regressão-logística" class="level4" data-number="18.8.4.6">
<h4 data-number="18.8.4.6" class="anchored" data-anchor-id="visualização-da-regressão-logística"><span class="header-section-number">18.8.4.6</span> Visualização da regressão logística</h4>
<p>Uma maneira interessante de visualizar a regressão logística, pode ser feita usando a função <code>plot_model()</code> do pacote <code>sjPlot</code> <span class="citation" data-cites="ludecke2018sjplot">(<a href="references.html#ref-ludecke2018sjplot" role="doc-biblioref">52</a>)</span>. Essa função, como padrão, produz um gráfico de floresta (<em>forest plot</em>), onde é possível visualizar as variáveis no eixo vertical e o tamanho do efeito (OR), os coeficientes, no eixo horizontal (<a href="#fig-forest" class="quarto-xref">Figura&nbsp;<span>18.12</span></a>). Além disso, coeficientes positivos são representados com a cor azul e negativos em vermelho; e os intervalos de confiança 95% como uma linha ao redor do valor médio do coeficiente (ponto). Ao se especificar o tipo como <code>std</code> em plot_model(), o gráfico de floresta produzido utiliza os valores padronizados em desvios padrões.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb174"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb174-1"><a href="#cb174-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sjPlot)</span>
<span id="cb174-2"><a href="#cb174-2" aria-hidden="true" tabindex="-1"></a>forest_raw <span class="ot">&lt;-</span> <span class="fu">plot_model</span>(modelo1)</span>
<span id="cb174-3"><a href="#cb174-3" aria-hidden="true" tabindex="-1"></a>forest_std <span class="ot">&lt;-</span> <span class="fu">plot_model</span>(modelo1, <span class="at">type =</span> <span class="st">"std"</span>)</span>
<span id="cb174-4"><a href="#cb174-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb174-5"><a href="#cb174-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(patchwork)</span>
<span id="cb174-6"><a href="#cb174-6" aria-hidden="true" tabindex="-1"></a><span class="fu">wrap_plots</span>(forest_raw, forest_std, <span class="at">nrow =</span> <span class="dv">2</span>)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-forest" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" data-fig-pos="H">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-forest-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="18-epidemiologia_files/figure-html/fig-forest-1.png" class="quarto-figure quarto-figure-center figure-img" style="width:80.0%;height:80.0%" data-fig-pos="H">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-forest-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figura&nbsp;18.12: Gráfico de Floresta dos Coeficientes de uma Regressão Logística em formato Odds Ratio
</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="remoção-de-variáveis-não-significativas" class="level4" data-number="18.8.4.7">
<h4 data-number="18.8.4.7" class="anchored" data-anchor-id="remoção-de-variáveis-não-significativas"><span class="header-section-number">18.8.4.7</span> Remoção de variáveis não significativas</h4>
<p>A variável <code>pafi</code> mostrou-se não significativa no ajuste do <code>modelo1</code> e será removida da análise:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb175"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb175-1"><a href="#cb175-1" aria-hidden="true" tabindex="-1"></a>modelo2 <span class="ot">&lt;-</span> <span class="fu">glm</span>(sobreviveu <span class="sc">~</span> classe <span class="sc">+</span> sexo <span class="sc">+</span> idade <span class="sc">+</span> irco, <span class="at">family =</span> <span class="fu">binomial</span>(<span class="at">link =</span> <span class="st">'logit'</span>), <span class="at">data=</span>dadosTreino)</span>
<span id="cb175-2"><a href="#cb175-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(modelo2)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = sobreviveu ~ classe + sexo + idade + irco, family = binomial(link = "logit"), 
    data = dadosTreino)

Coefficients:
             Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)  3.650122   0.375713   9.715  &lt; 2e-16 ***
classe2     -1.036232   0.272403  -3.804 0.000142 ***
classe3     -2.027471   0.256308  -7.910 2.57e-15 ***
sexomasc    -3.537566   0.213552 -16.565  &lt; 2e-16 ***
idade       -0.021943   0.006888  -3.186 0.001445 ** 
irco        -0.405917   0.108946  -3.726 0.000195 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 1210.44  on 915  degrees of freedom
Residual deviance:  722.82  on 910  degrees of freedom
AIC: 734.82

Number of Fisher Scoring iterations: 5</code></pre>
</div>
</div>
<p>Da mesma forma que com o <code>modelo1</code>, pode-se calcular, para tornar a interpretação mais intutiva, as <em>OR</em>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb177"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb177-1"><a href="#cb177-1" aria-hidden="true" tabindex="-1"></a>odds.ratio2 <span class="ot">=</span> <span class="fu">exp</span>(<span class="fu">cbind</span>(<span class="at">OddsRatio =</span> <span class="fu">coef</span>(modelo2),<span class="fu">confint</span>(modelo2)))</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Waiting for profiling to be done...</code></pre>
</div>
<div class="sourceCode cell-code" id="cb179"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb179-1"><a href="#cb179-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(odds.ratio2)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>              OddsRatio       2.5 %      97.5 %
(Intercept) 38.47934893 18.75841672 81.95938113
classe2      0.35478917  0.20659099  0.60186653
classe3      0.13166810  0.07888462  0.21578590
sexomasc     0.02908405  0.01889416  0.04369283
idade        0.97829590  0.96503498  0.99148346
irco         0.66636523  0.53152001  0.81573981</code></pre>
</div>
</div>
<p>Quando se compara os dois modelos para ver se houve uma melhora no ajuste, é interessante observar os AICs.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb181"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb181-1"><a href="#cb181-1" aria-hidden="true" tabindex="-1"></a>aic <span class="ot">&lt;-</span> <span class="fu">AIC</span>(modelo1, modelo2)</span>
<span id="cb181-2"><a href="#cb181-2" aria-hidden="true" tabindex="-1"></a>aic</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>        df      AIC
modelo1  7 736.3994
modelo2  6 734.8166</code></pre>
</div>
</div>
<p>O <code>modelo1</code> tem uma AIC (736.4) discretamente maior que a do <code>modelo2</code> (734.82). Isto indica que o ajuste do <code>modelo2</code> é um pouco melhor (teve menos informação perdida no ajuste), entretanto, esta ligeira melhora não modifica a interpretação.A função <code>anova()</code>, que a diferença entre os modelos não é significativa (<em>P</em> &gt; 0.05):</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb183"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb183-1"><a href="#cb183-1" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(modelo1, modelo2, <span class="at">test =</span> <span class="st">"Chisq"</span>)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Deviance Table

Model 1: sobreviveu ~ classe + sexo + idade + irco + pafi
Model 2: sobreviveu ~ classe + sexo + idade + irco
  Resid. Df Resid. Dev Df Deviance Pr(&gt;Chi)
1       909     722.40                     
2       910     722.82 -1 -0.41717   0.5184</code></pre>
</div>
</div>
<p>Os dois modelo têm a mesma interpretação, mas o <code>modelo2</code> ajusta melhor os dados.</p>
</section>
<section id="construção-do-modelo-e-interação" class="level4" data-number="18.8.4.8">
<h4 data-number="18.8.4.8" class="anchored" data-anchor-id="construção-do-modelo-e-interação"><span class="header-section-number">18.8.4.8</span> Construção do modelo e interação</h4>
<p>A interação entre variáveis pode ser crucial em modelos de regressão logística, pois pode revelar padrões que não são evidentes ao analisar cada variável separadamente. Usar interações pode tornar o modelo mais informativo, mas também mais complexo. Por isso, é sempre bom verificar métricas como AIC ou testes estatísticos para ver se a inclusão da interação realmente melhora a previsão.</p>
<p>Será construído um gráfico (<a href="#fig-interacao" class="quarto-xref">Figura&nbsp;<span>18.13</span></a>)), usando o pacote <code>ggeffects</code> e sua função <code>ggpredict()</code> <span class="citation" data-cites="ludecke2018ggeffects">(<a href="references.html#ref-ludecke2018ggeffects" role="doc-biblioref">53</a>)</span>. Este calcula os efeitos marginais a partir de modelos estatísticos e retorna o resultado como estruturas de dados organizadas. Essas estruturas de dados estão prontas para serem usadas com o pacote <code>ggplot2</code>. Os efeitos marginais podem ser calculados para muitos modelos diferentes, incluindo termos de interação. Junto será criado o modelo de interação (<code>modelo3</code>)</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb185"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb185-1"><a href="#cb185-1" aria-hidden="true" tabindex="-1"></a>titanic_df <span class="ot">&lt;-</span> dadosTreino <span class="sc">%&gt;%</span></span>
<span id="cb185-2"><a href="#cb185-2" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span> pafi) <span class="sc">%&gt;%</span></span>
<span id="cb185-3"><a href="#cb185-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">classe =</span> <span class="fu">factor</span>(classe, <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>), </span>
<span id="cb185-4"><a href="#cb185-4" aria-hidden="true" tabindex="-1"></a>                         <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"1ª Classe"</span>, <span class="st">"2ª Classe"</span>, <span class="st">"3ª Classe"</span>))) </span>
<span id="cb185-5"><a href="#cb185-5" aria-hidden="true" tabindex="-1"></a>titanic_df <span class="ot">&lt;-</span> dadosTreino <span class="sc">%&gt;%</span></span>
<span id="cb185-6"><a href="#cb185-6" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span> pafi) <span class="sc">%&gt;%</span></span>
<span id="cb185-7"><a href="#cb185-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">classe =</span> <span class="fu">factor</span>(classe, <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>), </span>
<span id="cb185-8"><a href="#cb185-8" aria-hidden="true" tabindex="-1"></a>                         <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"1ª Classe"</span>, <span class="st">"2ª Classe"</span>, <span class="st">"3ª Classe"</span>))) </span>
<span id="cb185-9"><a href="#cb185-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb185-10"><a href="#cb185-10" aria-hidden="true" tabindex="-1"></a>modelo3 <span class="ot">&lt;-</span> <span class="fu">glm</span>(sobreviveu <span class="sc">~</span> sexo <span class="sc">*</span> classe <span class="sc">+</span> idade <span class="sc">+</span> irco, <span class="at">data =</span> titanic_df, <span class="at">family =</span> <span class="st">"binomial"</span>)</span>
<span id="cb185-11"><a href="#cb185-11" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(modelo3)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = sobreviveu ~ sexo * classe + idade + irco, family = "binomial", 
    data = titanic_df)

Coefficients:
                          Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)               4.466967   0.661859   6.749 1.49e-11 ***
sexomasc                 -4.463273   0.623370  -7.160 8.07e-13 ***
classe2ª Classe          -0.671057   0.785028  -0.855 0.392651    
classe3ª Classe          -3.186429   0.624252  -5.104 3.32e-07 ***
idade                    -0.022705   0.007084  -3.205 0.001351 ** 
irco                     -0.379739   0.110176  -3.447 0.000568 ***
sexomasc:classe2ª Classe -0.803877   0.862622  -0.932 0.351389    
sexomasc:classe3ª Classe  1.691644   0.669402   2.527 0.011501 *  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 1210.44  on 915  degrees of freedom
Residual deviance:  700.01  on 908  degrees of freedom
AIC: 716.01

Number of Fisher Scoring iterations: 6</code></pre>
</div>
<div class="sourceCode cell-code" id="cb187"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb187-1"><a href="#cb187-1" aria-hidden="true" tabindex="-1"></a>pred_effects <span class="ot">&lt;-</span> <span class="fu">ggpredict</span>(modelo3, <span class="at">terms =</span> <span class="fu">c</span>(<span class="st">"classe"</span>, <span class="st">"sexo"</span>))</span>
<span id="cb187-2"><a href="#cb187-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb187-3"><a href="#cb187-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb187-4"><a href="#cb187-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(pred_effects, <span class="at">show_data =</span> <span class="cn">FALSE</span>, <span class="at">connect_lines =</span> T) <span class="sc">+</span></span>
<span id="cb187-5"><a href="#cb187-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Classe do Passageiro"</span>,</span>
<span id="cb187-6"><a href="#cb187-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Probabilidade Predita de Sobrevivência"</span>,</span>
<span id="cb187-7"><a href="#cb187-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">"Interação entre Sexo e Classe na Sobrevivência do Titanic"</span>, </span>
<span id="cb187-8"><a href="#cb187-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">color =</span> <span class="st">"Sexo"</span>) <span class="sc">+</span></span>
<span id="cb187-9"><a href="#cb187-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb187-10"><a href="#cb187-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb187-11"><a href="#cb187-11" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="st">"right"</span>) <span class="sc">+</span></span>
<span id="cb187-12"><a href="#cb187-12" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Ajustar limites do eixo Y para probabilidades (0 a 1)</span></span>
<span id="cb187-13"><a href="#cb187-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="fl">0.1</span>),</span>
<span id="cb187-14"><a href="#cb187-14" aria-hidden="true" tabindex="-1"></a>                     <span class="at">expand =</span> <span class="fu">expansion</span>(<span class="at">add =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">0.05</span>)))</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-interacao" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" data-fig-pos="H">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-interacao-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="18-epidemiologia_files/figure-html/fig-interacao-1.png" class="quarto-figure quarto-figure-center figure-img" style="width:80.0%;height:80.0%" data-fig-pos="H">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-interacao-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figura&nbsp;18.13: Gráfico de linha da interação sexo:classe
</figcaption>
</figure>
</div>
</div>
</div>
<p>O gráfico da <a href="#fig-interacao" class="quarto-xref">Figura&nbsp;<span>18.13</span></a> sugere uma interação entre <code>classe</code> e <code>sexo</code> na taxa de sobrevivência.</p>
<p>Interpretação dos coeficientes gerados no modelo com interação</p>
<p>Interpretar os coeficientes do modelo de interação em conjunto com o gráfico da <a href="#fig-interacao" class="quarto-xref">Figura&nbsp;<span>18.13</span></a> é fundamental. Os coeficentes são em escala <strong>logit</strong> e, para melhor interpretá-lo, há necessidade de exponenciá-los:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb188"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb188-1"><a href="#cb188-1" aria-hidden="true" tabindex="-1"></a>odds_ratios <span class="ot">&lt;-</span> <span class="fu">exp</span>(<span class="fu">cbind</span>(<span class="at">OddsRatio =</span> <span class="fu">coef</span>(modelo3), <span class="fu">confint</span>(modelo3)))</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Waiting for profiling to be done...</code></pre>
</div>
</div>
<p>O modelo com interação (<code>modelo3</code>) apresentou uma ajuste um pouco melhor, comparado com modelo sem interação (<code>modelo2</code>). Para a comparação, pode-se usar o AIC de ambos os modelos:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb190"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb190-1"><a href="#cb190-1" aria-hidden="true" tabindex="-1"></a>aic <span class="ot">&lt;-</span> <span class="fu">AIC</span>(modelo2, modelo3)</span>
<span id="cb190-2"><a href="#cb190-2" aria-hidden="true" tabindex="-1"></a>aic</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>        df      AIC
modelo2  6 734.8166
modelo3  8 716.0065</code></pre>
</div>
</div>
<p>A saída mostra que existe uma diferença de 18.81 pontos. Isso é uma forte evidência que o modelo com a interação melhora o ajuste.<br>
O coeficiente de interação positivo como 1.6916435 não significa que homens da 3ª classe têm alta probabilidade de sobreviver. Significa que o efeito negativo de ser homem na 3ª classe é menos grave (ou a relação da classe com a sobrevivência é diferente para homens) do que seria previsto apenas pelos efeitos principais <code>sexomasc</code> e 3ª Classe somados linearmente. É uma correção para a relação aditiva simples.<br>
O gráfico mostra claramente que homens da 3ª classe têm uma probabilidade predita de sobrevivência bem baixa, que é a mais baixa de todas as categorias.</p>
<p>Desta forma, a interpretação é semelhante a que foi mostrada com o modelo sem interação:</p>
<ul>
<li>Ser mulher é um fator de sobrevivência extremamente forte.<br>
</li>
<li>Ser da 1ª classe é um fator de sobrevivência positivo.<br>
</li>
<li>Idade avançada e ter mais irmãos/cônjuges são fatores negativos para a sobrevivência.<br>
</li>
<li>Existe uma interação significativa onde a penalidade de ser homem (em termos de chances de sobrevivência) é diferente entre as classes, sendo muito mais forte nas classes superiores e menos acentuada (mas ainda presente) na 3ª classe (onde as chances já são globalmente baixas para todos, mas a queda de chances para mulheres da 3ª classe é mais drástica que para homens entre 2ª e 3ª).</li>
</ul>
<p>Portanto, deve-se manter o modelo com a interação (<code>modelo3</code>). Ele é mais preciso e oferece uma compreensão mais detalhada das complexas relações entre sexo, classe e sobrevivência (ajustado por <code>idade</code> e <code>irco</code>).</p>
<p>Para finalizar, será mostrada, na <a href="#fig-taxas" class="quarto-xref">Figura&nbsp;<span>18.14</span></a>, as taxas reais de sobrevivência, para comparar com a <a href="#fig-interacao" class="quarto-xref">Figura&nbsp;<span>18.13</span></a>, indicando que os homens da 3ª classe tiveram uma baixa taxa de sobrevivência, mesmo com o modelo de interação tenha mostrado um coeficiente positivo. Isto apenas mostra que atenuou o efeito.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb192"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb192-1"><a href="#cb192-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Converter a variável "sobreviveu" para numérica, se necessário</span></span>
<span id="cb192-2"><a href="#cb192-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(dadosTreino, </span>
<span id="cb192-3"><a href="#cb192-3" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> classe, </span>
<span id="cb192-4"><a href="#cb192-4" aria-hidden="true" tabindex="-1"></a>           <span class="at">fill =</span> <span class="fu">factor</span>(sobreviveu))) <span class="sc">+</span></span>
<span id="cb192-5"><a href="#cb192-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">position =</span> <span class="st">"fill"</span>) <span class="sc">+</span></span>
<span id="cb192-6"><a href="#cb192-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> sexo) <span class="sc">+</span></span>
<span id="cb192-7"><a href="#cb192-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Proporção de sobrevivência por sexo e classe"</span>,</span>
<span id="cb192-8"><a href="#cb192-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Classe do passageiro"</span>, </span>
<span id="cb192-9"><a href="#cb192-9" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Proporção"</span>,</span>
<span id="cb192-10"><a href="#cb192-10" aria-hidden="true" tabindex="-1"></a>       <span class="at">fill =</span> <span class="st">"Sobrevivência"</span>) <span class="sc">+</span></span>
<span id="cb192-11"><a href="#cb192-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-taxas" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" data-fig-pos="H">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-taxas-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="18-epidemiologia_files/figure-html/fig-taxas-1.png" class="quarto-figure quarto-figure-center figure-img" style="width:60.0%;height:60.0%" data-fig-pos="H">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-taxas-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figura&nbsp;18.14: Proporção de sobrevivência por sexo e classe
</figcaption>
</figure>
</div>
</div>
</div>
<p>Para comparar os modelos, estatisticamente, pode-se usar a função <code>anova()</code> do pacote <code>car</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb193"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb193-1"><a href="#cb193-1" aria-hidden="true" tabindex="-1"></a>anova <span class="ot">&lt;-</span> <span class="fu">anova</span>(modelo2, modelo3, <span class="at">test =</span> <span class="st">"Chisq"</span>)</span>
<span id="cb193-2"><a href="#cb193-2" aria-hidden="true" tabindex="-1"></a>anova</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Deviance Table

Model 1: sobreviveu ~ classe + sexo + idade + irco
Model 2: sobreviveu ~ sexo * classe + idade + irco
  Resid. Df Resid. Dev Df Deviance  Pr(&gt;Chi)    
1       910     722.82                          
2       908     700.01  2    22.81 1.114e-05 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<p>A ANOVA mostra um valor <em>P</em> muito baixo, indicando uma diferença estatisricamente signficativa entre os modelos.</p>
</section>
<section id="sec-compararoc" class="level4" data-number="18.8.4.9">
<h4 data-number="18.8.4.9" class="anchored" data-anchor-id="sec-compararoc"><span class="header-section-number">18.8.4.9</span> Curva ROC para comparar os modelos</h4>
<p>A curva ROC é um gráfico permite explicar o desempenho do modelo avaliando a taxa de verdadeiros positivos (sensibilidade) versus a taxa de falsos positivos (<span class="math inline">\(1 - especificidade\)</span>). A AUC (Área sob a Curva ROC) indica a qualidade do modelo (veja também a <a href="#sec-rocurve" class="quarto-xref"><span>Seção 18.2.4</span></a>):</p>
<ul>
<li><span class="math inline">\(AUC \approx 0.5\)</span> <span class="math inline">\(\to\)</span> O modelo não tem poder preditivo (equivalente ao puro acaso).<br>
</li>
<li><span class="math inline">\(AUC \gt 0.7\)</span> <span class="math inline">\(\to\)</span> Modelo razoável.<br>
</li>
<li><span class="math inline">\(AUC \gt 0.8\)</span> <span class="math inline">\(\to\)</span> Modelo muito bom.</li>
<li><span class="math inline">\(AUC \gt 0.9\)</span> <span class="math inline">\(\to\)</span> Excelebte desempenho.</li>
</ul>
<p><u>Predição da variável desfecho nos modelos</u></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb195"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb195-1"><a href="#cb195-1" aria-hidden="true" tabindex="-1"></a>prob_pred <span class="ot">&lt;-</span> <span class="fu">predict</span>(modelo2, <span class="at">type =</span> <span class="st">"response"</span>)</span>
<span id="cb195-2"><a href="#cb195-2" aria-hidden="true" tabindex="-1"></a>prob_pred_int <span class="ot">&lt;-</span> <span class="fu">predict</span>(modelo3, <span class="at">type =</span> <span class="st">"response"</span>)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><u>Crição de um objeto ROC</u></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb196"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb196-1"><a href="#cb196-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(pROC)</span>
<span id="cb196-2"><a href="#cb196-2" aria-hidden="true" tabindex="-1"></a>roc2<span class="ot">&lt;-</span> <span class="fu">roc</span>(<span class="at">response =</span> dadosTreino<span class="sc">$</span>sobreviveu, <span class="at">predictor =</span> prob_pred) </span>
<span id="cb196-3"><a href="#cb196-3" aria-hidden="true" tabindex="-1"></a>roc3 <span class="ot">&lt;-</span> <span class="fu">roc</span>(<span class="at">response =</span> dadosTreino<span class="sc">$</span>sobreviveu, <span class="at">predictor =</span> prob_pred_int)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><u>Plotar a curva ROC</u></p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb197"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb197-1"><a href="#cb197-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(roc2, </span>
<span id="cb197-2"><a href="#cb197-2" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">"Curva ROC"</span>, </span>
<span id="cb197-3"><a href="#cb197-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">print.auc =</span> <span class="cn">TRUE</span>, </span>
<span id="cb197-4"><a href="#cb197-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">legacy.axes=</span><span class="cn">TRUE</span>,</span>
<span id="cb197-5"><a href="#cb197-5" aria-hidden="true" tabindex="-1"></a>     <span class="at">print.auc.y =</span> <span class="fl">0.2</span>,</span>
<span id="cb197-6"><a href="#cb197-6" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab=</span><span class="st">"Sensibilidade"</span>,</span>
<span id="cb197-7"><a href="#cb197-7" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab=</span><span class="st">"1 - Especificidade"</span>)</span>
<span id="cb197-8"><a href="#cb197-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb197-9"><a href="#cb197-9" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(roc3, </span>
<span id="cb197-10"><a href="#cb197-10" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">""</span>,</span>
<span id="cb197-11"><a href="#cb197-11" aria-hidden="true" tabindex="-1"></a>     <span class="at">col=</span><span class="st">"tomato"</span>,</span>
<span id="cb197-12"><a href="#cb197-12" aria-hidden="true" tabindex="-1"></a>     <span class="at">print.auc =</span> <span class="cn">TRUE</span>, </span>
<span id="cb197-13"><a href="#cb197-13" aria-hidden="true" tabindex="-1"></a>     <span class="at">legacy.axes=</span><span class="cn">TRUE</span>,</span>
<span id="cb197-14"><a href="#cb197-14" aria-hidden="true" tabindex="-1"></a>     <span class="at">print.auc.y =</span> <span class="fl">0.1</span>,</span>
<span id="cb197-15"><a href="#cb197-15" aria-hidden="true" tabindex="-1"></a>     <span class="at">add =</span><span class="cn">TRUE</span>)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-comparemod" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" data-fig-pos="H">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-comparemod-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="18-epidemiologia_files/figure-html/fig-comparemod-1.png" class="quarto-figure quarto-figure-center figure-img" style="width:60.0%;height:60.0%" data-fig-pos="H">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-comparemod-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figura&nbsp;18.15: Comparação das curvas ROC(modelo sem interação = preto; modelo com interação vermelho)
</figcaption>
</figure>
</div>
</div>
</div>
<p>As curvas ROC são praticamente muito semelhantes, com AUCs muito próximos.</p>
</section>
</section>
<section id="avaliação-do-modelo-de-regressão-logística" class="level3" data-number="18.8.5">
<h3 data-number="18.8.5" class="anchored" data-anchor-id="avaliação-do-modelo-de-regressão-logística"><span class="header-section-number">18.8.5</span> Avaliação do Modelo de Regressão Logística</h3>
<section id="matriz-de-confusão" class="level4" data-number="18.8.5.1">
<h4 data-number="18.8.5.1" class="anchored" data-anchor-id="matriz-de-confusão"><span class="header-section-number">18.8.5.1</span> Matriz de Confusão</h4>
<p>Primeiro foi feito o treinamento com o conjunto de dados dadosTreino. Agora, comparam-se as previsões (<code>pred_class</code>) com os valores reais (<code>dadosTeste$sobreviveu</code>). Para isso será necessário a função <code>confusionMatrix()</code> do pacote <code>caret</code>.</p>
<p><u>Fazendo previsões (probabilidades)</u></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb198"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb198-1"><a href="#cb198-1" aria-hidden="true" tabindex="-1"></a>dadosTeste <span class="ot">&lt;-</span> dadosTeste <span class="sc">%&gt;%</span></span>
<span id="cb198-2"><a href="#cb198-2" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span> pafi) <span class="sc">%&gt;%</span></span>
<span id="cb198-3"><a href="#cb198-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">classe =</span> <span class="fu">factor</span>(classe, <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>), </span>
<span id="cb198-4"><a href="#cb198-4" aria-hidden="true" tabindex="-1"></a>                         <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"1ª Classe"</span>, <span class="st">"2ª Classe"</span>, <span class="st">"3ª Classe"</span>))) </span>
<span id="cb198-5"><a href="#cb198-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb198-6"><a href="#cb198-6" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">234</span>)</span>
<span id="cb198-7"><a href="#cb198-7" aria-hidden="true" tabindex="-1"></a>pred_prob <span class="ot">&lt;-</span> <span class="fu">predict</span>(modelo3, <span class="at">newdata =</span> dadosTeste, <span class="at">type =</span> <span class="st">"response"</span>)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>A seguir, converte-se as probabilidades em classes (fatores):</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb199"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb199-1"><a href="#cb199-1" aria-hidden="true" tabindex="-1"></a>pred_class <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(pred_prob <span class="sc">&gt;</span> <span class="fl">0.5</span>, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb199-2"><a href="#cb199-2" aria-hidden="true" tabindex="-1"></a>pred_class <span class="ot">&lt;-</span> <span class="fu">factor</span>(pred_class, <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>))</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><u>Criando a matriz de confusão</u></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb200"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb200-1"><a href="#cb200-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(caret)</span>
<span id="cb200-2"><a href="#cb200-2" aria-hidden="true" tabindex="-1"></a>conf_matrix <span class="ot">&lt;-</span> <span class="fu">confusionMatrix</span>(pred_class, </span>
<span id="cb200-3"><a href="#cb200-3" aria-hidden="true" tabindex="-1"></a>                               dadosTeste<span class="sc">$</span>sobreviveu, </span>
<span id="cb200-4"><a href="#cb200-4" aria-hidden="true" tabindex="-1"></a>                               <span class="at">positive =</span><span class="st">"1"</span>)</span>
<span id="cb200-5"><a href="#cb200-5" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(conf_matrix)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Confusion Matrix and Statistics

          Reference
Prediction   0   1
         0 232  26
         1  20 115
                                        
               Accuracy : 0.883         
                 95% CI : (0.847, 0.913)
    No Information Rate : 0.6412        
    P-Value [Acc &gt; NIR] : &lt;2e-16        
                                        
                  Kappa : 0.7432        
                                        
 Mcnemar's Test P-Value : 0.461         
                                        
            Sensitivity : 0.8156        
            Specificity : 0.9206        
         Pos Pred Value : 0.8519        
         Neg Pred Value : 0.8992        
             Prevalence : 0.3588        
         Detection Rate : 0.2926        
   Detection Prevalence : 0.3435        
      Balanced Accuracy : 0.8681        
                                        
       'Positive' Class : 1             
                                        </code></pre>
</div>
</div>
<p>A tabela de contingência do início da matriz de confusão, mostra a comparação dos dados preditos e os dados reais (reference) e o significado de cada célula, onde <em>Classe 0</em> representa negativo e <em>Classe 1</em>, positivo.</p>
<p>A <strong>Acurácia</strong> (88.3%) é a proporção de previsões corretas. O modelo tem uma alta acurácia, isso indica um bom desempenho geral. Um modelo é considerado razoavelmente bom se a precisão do modelo for superior a 70%.<br>
A <strong>Sensibilidade (Recall)</strong> é a proporção de verdadeiros positivos (VP) identificados corretamente. O modelo o modelo identifica corretamete 81.6% dos verdadeiros positivos.<br>
A <strong>Especificidade</strong> é a proporção de verdadeiros negativos(VN). O modelo reconhece 92.1% dos verdadeiros negativos.<br>
O <strong>Valor P</strong> (<em>McNemar’s Test</em>) testa se há viés significativo na classificação dos erros. O valor alto (<em>P</em> = 0.461) sugere que os erros entre classes não são estatisticamente diferentes.<br>
O <strong>Kappa</strong> mede concordância ajustada para a distribuição dos dados. Um valor próximo de 1 indica boa concordância entre previsões e valores reais.<br>
O <strong>escore F1</strong> (não listado diretamente) representa o equilíbrio entre precisão e recall. Pode ser obtido pela equação: <span class="math display">\[F1 = 2 \times \frac{VPN \times sensibilidade}{VPN + sensibilidade}\]</span><br>
Ou consultando <code>conf_matrix$byClass[7]</code> (83.3%).</p>
<p>A <strong>Precisão (VPP)</strong> é a proporção de previsões positivas que estavam corretas, também denomonada de valor preditivo positivo (VPP). A precisão do modelo é igual 85.2, é considerada um valor alto.</p>
</section>
<section id="uso-da-curva-roc-para-avaliar-o-modelo" class="level4" data-number="18.8.5.2">
<h4 data-number="18.8.5.2" class="anchored" data-anchor-id="uso-da-curva-roc-para-avaliar-o-modelo"><span class="header-section-number">18.8.5.2</span> Uso da curva ROC para avaliar o modelo</h4>
<p>Avaliar um modelo de Regressão Logística no R, usando a curva ROC/AUC também é bem direto (veja <a href="#sec-compararoc" class="quarto-xref"><span>Seção 18.8.4.9</span></a> e <a href="#sec-rocurve" class="quarto-xref"><span>Seção 18.2.4</span></a>). É uma abordagem bastante poderosa que permite visualizar os grupos no mesmo gráfico.</p>
<p><u>Obtenção das probabilidades de predição</u></p>
<p>Para se obter uma curva ROC, há necessidade das probabilidades previstas pelo modelo para a classe positiva (no exemplo, o nível 1 da variável <code>sobreviveu</code>).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb202"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb202-1"><a href="#cb202-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Probabilidades de predição no conjunto de teste</span></span>
<span id="cb202-2"><a href="#cb202-2" aria-hidden="true" tabindex="-1"></a><span class="co"># O argumento 'type = "response"' garante que serão obtidas as probabilidades</span></span>
<span id="cb202-3"><a href="#cb202-3" aria-hidden="true" tabindex="-1"></a>prob_pred_teste <span class="ot">&lt;-</span> <span class="fu">predict</span>(modelo3, <span class="at">newdata =</span> dadosTeste, <span class="at">type =</span> <span class="st">"response"</span>)</span>
<span id="cb202-4"><a href="#cb202-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb202-5"><a href="#cb202-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Probabilidades de predição no conjunto de treino</span></span>
<span id="cb202-6"><a href="#cb202-6" aria-hidden="true" tabindex="-1"></a>prob_pred_treino <span class="ot">&lt;-</span> <span class="fu">predict</span>(modelo3,<span class="at">type =</span> <span class="st">"response"</span>)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><u>Criação de objetos ROC</u></p>
<p>A seguir, serão criados os objetos ROC necessários para a construção das curvas ROC e calcular a área sob a curva (AUC):</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb203"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb203-1"><a href="#cb203-1" aria-hidden="true" tabindex="-1"></a>roc_obj_treino <span class="ot">&lt;-</span> <span class="fu">roc</span>(<span class="at">response =</span> dadosTreino<span class="sc">$</span>sobreviveu, <span class="at">predictor =</span> prob_pred_treino) </span>
<span id="cb203-2"><a href="#cb203-2" aria-hidden="true" tabindex="-1"></a>roc_obj_teste <span class="ot">&lt;-</span> <span class="fu">roc</span>(<span class="at">response =</span> dadosTeste<span class="sc">$</span>sobreviveu, <span class="at">predictor =</span> prob_pred_teste) </span>
<span id="cb203-3"><a href="#cb203-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb203-4"><a href="#cb203-4" aria-hidden="true" tabindex="-1"></a>auc_valor_treino <span class="ot">&lt;-</span> <span class="fu">auc</span>(roc_obj_treino)</span>
<span id="cb203-5"><a href="#cb203-5" aria-hidden="true" tabindex="-1"></a>auc_valor_teste <span class="ot">&lt;-</span> <span class="fu">auc</span>(roc_obj_teste)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><u>Visualização da curva ROC</u></p>
<p>Com as informações obtidas, pode-se visualizar a curva ROC. Para criar um gráfico mais atraente, será usado, agora, o pacote <code>ggplot2</code>.<br>
inicialmente, serão criados dataframes com os dados para serem usados na função <code>ggplot()</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb204"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb204-1"><a href="#cb204-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Uma coluna chamada Model é adicionada para identificar qual curva pertence a qual modelo</span></span>
<span id="cb204-2"><a href="#cb204-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb204-3"><a href="#cb204-3" aria-hidden="true" tabindex="-1"></a><span class="co"># # Dataframe dos dados treino</span></span>
<span id="cb204-4"><a href="#cb204-4" aria-hidden="true" tabindex="-1"></a>dados_roc_treino <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb204-5"><a href="#cb204-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">TFP =</span> <span class="dv">1</span> <span class="sc">-</span> roc_obj_treino<span class="sc">$</span>specificities,</span>
<span id="cb204-6"><a href="#cb204-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">TVP =</span> roc_obj_treino<span class="sc">$</span>sensitivities,</span>
<span id="cb204-7"><a href="#cb204-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">Model =</span> <span class="st">"Treino"</span>)</span>
<span id="cb204-8"><a href="#cb204-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb204-9"><a href="#cb204-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Dataframe dos dados teste</span></span>
<span id="cb204-10"><a href="#cb204-10" aria-hidden="true" tabindex="-1"></a>dados_roc_teste <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb204-11"><a href="#cb204-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">TFP =</span> <span class="dv">1</span> <span class="sc">-</span> roc_obj_teste<span class="sc">$</span>specificities,</span>
<span id="cb204-12"><a href="#cb204-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">TVP =</span> roc_obj_teste<span class="sc">$</span>sensitivities,</span>
<span id="cb204-13"><a href="#cb204-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">Model =</span> <span class="st">"Teste"</span>)</span>
<span id="cb204-14"><a href="#cb204-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb204-15"><a href="#cb204-15" aria-hidden="true" tabindex="-1"></a>dados_roc_combinados <span class="ot">&lt;-</span> <span class="fu">rbind</span>(dados_roc_treino, dados_roc_teste)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Usando estes dois dataframes, obtemos a <a href="#fig-compareroc" class="quarto-xref">Figura&nbsp;<span>18.16</span></a></p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb205"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb205-1"><a href="#cb205-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(dados_roc_combinados, </span>
<span id="cb205-2"><a href="#cb205-2" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> TFP, <span class="at">y =</span> TVP, <span class="at">color =</span> Model)) <span class="sc">+</span></span>
<span id="cb205-3"><a href="#cb205-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">size =</span> <span class="fl">1.2</span>) <span class="sc">+</span></span>
<span id="cb205-4"><a href="#cb205-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">intercept =</span> <span class="dv">0</span>, <span class="at">slope =</span> <span class="dv">1</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">color =</span> <span class="st">"navy"</span>, <span class="at">size =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb205-5"><a href="#cb205-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Comparação de Curvas ROC"</span>,</span>
<span id="cb205-6"><a href="#cb205-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Taxa de Falsos Positivos (TFP)"</span>,</span>
<span id="cb205-7"><a href="#cb205-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Taxa de Verdadeiros Positivos (TVP)"</span>,</span>
<span id="cb205-8"><a href="#cb205-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">color =</span> <span class="st">"Dados"</span>) <span class="sc">+</span> <span class="co"># Legenda para as cores</span></span>
<span id="cb205-9"><a href="#cb205-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> <span class="fl">0.6</span>, <span class="at">y =</span> <span class="fl">0.2</span>, <span class="at">label =</span> <span class="fu">paste</span>(<span class="st">"AUC Teste ="</span>, <span class="fu">round</span>(auc_valor_teste, <span class="dv">2</span>)),</span>
<span id="cb205-10"><a href="#cb205-10" aria-hidden="true" tabindex="-1"></a>           <span class="at">color =</span> <span class="st">"tomato"</span>, <span class="at">size =</span> <span class="dv">4</span>) <span class="sc">+</span></span>
<span id="cb205-11"><a href="#cb205-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> <span class="fl">0.6</span>, <span class="at">y =</span> <span class="fl">0.1</span>, <span class="at">label =</span> <span class="fu">paste</span>(<span class="st">"AUC Treino ="</span>, <span class="fu">round</span>(auc_valor_treino, <span class="dv">2</span>)),</span>
<span id="cb205-12"><a href="#cb205-12" aria-hidden="true" tabindex="-1"></a>           <span class="at">color =</span> <span class="st">"steelblue"</span>, <span class="at">size =</span> <span class="dv">4</span>) <span class="sc">+</span></span>
<span id="cb205-13"><a href="#cb205-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"Teste"</span> <span class="ot">=</span> <span class="st">"tomato"</span>,</span>
<span id="cb205-14"><a href="#cb205-14" aria-hidden="true" tabindex="-1"></a>                                <span class="st">"Treino"</span> <span class="ot">=</span> <span class="st">"steelblue"</span>)) <span class="sc">+</span></span>
<span id="cb205-15"><a href="#cb205-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb205-16"><a href="#cb205-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>))</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-compareroc" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" data-fig-pos="H">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-compareroc-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="18-epidemiologia_files/figure-html/fig-compareroc-1.png" class="quarto-figure quarto-figure-center figure-img" style="width:60.0%;height:60.0%" data-fig-pos="H">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-compareroc-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figura&nbsp;18.16: Desempenho do modelo treino e do modelo teste)
</figcaption>
</figure>
</div>
</div>
</div>
<p>A <strong>Curva ROC</strong> mostra o quão bem seu modelo distingue entre as classes positiva e negativa em diferentes limites de classificação. Uma curva que se aproxima do canto superior esquerdo indica um modelo com bom poder de discriminação.</p>
<p>A <strong>AUC (Area Under the Curve)</strong> é um resumo numérico desse desempenho. Um valor de AUC de 1 significa um modelo perfeito, enquanto 0.5 indica um modelo que se comporta aleatoriamente (como jogar uma moeda para classificar). Quanto maior a AUC, melhor o desempenho geral do seu modelo em separar as classes. Em geral, uma AUC acima de 0.7 é considerada razoável, acima de 0.8 é boa e acima de 0.9 é excelente.</p>
<p>A AUC Teste = 0.91 é considerada <strong>excelente</strong>. Isso significa que o modelo tem uma capacidade muito alta de distinguir entre as classes positiva e negativa no conjunto de dados não visto (teste). Uma AUC Treino = 0.89 também é um desempenho muito forte. A diferença entre as duas é mínima (0.02). Isso é um sinal extremamente positivo. Significa que o modelo não está sofrendo de:</p>
<ul>
<li><strong>Overfitting</strong> (sobreajuste): Se houvesse <em>overfitting</em>, a AUC de treino seria significativamente mais alta que a AUC de teste, indicando que o modelo “memorizou” os dados de treino e não generaliza bem para dados novos.<br>
</li>
<li><strong>Underfitting</strong> (subajuste): Se houvesse <em>underfitting</em>, ambas as AUCs seriam baixas, indicando que o modelo não aprendeu os padrões nos dados.</li>
</ul>
<p>Concluindo o modelo de regressão logística apresentou um excelente desempenho e está generalizando muito bem para novos dados. A performance consistente entre treino e teste é um indicativo de um modelo robusto e confiável para a tarefa de classificação.</p>
</section>
<section id="sec-vif" class="level4" data-number="18.8.5.3">
<h4 data-number="18.8.5.3" class="anchored" data-anchor-id="sec-vif"><span class="header-section-number">18.8.5.3</span> Outras avaliações do modelo</h4>
<p><u>Linearidade e Colinearidade</u></p>
<p>Esta suposição pode ser testada de diversas maneiras. O pacote <code>performance</code> (moderno e abrangente), usando a função <code>check_model()</code> faz várias verificações que inclui a linearidade de forma visual (<a href="#fig-linearidade" class="quarto-xref">Figura&nbsp;<span>18.17</span></a>) e <a href="#fig-linearidade2" class="quarto-xref">Figura&nbsp;<span>18.18</span></a>), para preditores contínuos através de resíduos parciais. Serão avaliados os dois modelos (<code>modelo2</code> e <code>modelo3</code>)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb206"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb206-1"><a href="#cb206-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(performance)</span>
<span id="cb206-2"><a href="#cb206-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">check_model</span>(modelo2, <span class="at">residual_type =</span> <span class="st">"normal"</span>))</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-linearidade" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" data-fig-pos="H">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-linearidade-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="https://imgur.com/t4WqHJA.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%" data-fig-pos="H">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-linearidade-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figura&nbsp;18.17: Avaliação do modelo com foco na linearidade
</figcaption>
</figure>
</div>
</div>
</div>
<p>O <code>modelo3</code> (com interação sexo:classe) que em outras testagens ele teve um melhor ajuste, será avaliado:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb207"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb207-1"><a href="#cb207-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(performance)</span>
<span id="cb207-2"><a href="#cb207-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">check_model</span>(modelo3, <span class="at">residual_type =</span> <span class="st">"normal"</span>))</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-linearidade2" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" data-fig-pos="H">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-linearidade2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="https://i.imgur.com/hH8aPw7.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%" data-fig-pos="H">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-linearidade2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figura&nbsp;18.18: Avaliação do modelo com interação com foco na linearidade
</figcaption>
</figure>
</div>
</div>
</div>
<p>Os gráficos gerados incluem diversas verificações fundamentais que devem ser observadas comparativamente nas <a href="#fig-linearidade" class="quarto-xref">Figura&nbsp;<span>18.17</span></a> e <a href="#fig-linearidade2" class="quarto-xref">Figura&nbsp;<span>18.18</span></a>.</p>
<ul>
<li><p><strong>Verificação preditiva posterior</strong> (<em>Posterior Predictive Check</em>) – Compara os dados observados com os preditos pelo modelo. Os intervalos do modelo devem incluir os pontos observados. Comparando os dois modelos, os pontos observados os parecem ter um alinhamento dos intervalos preditivos semelhantes.</p></li>
<li><p><strong>Resíduos agrupados</strong> (<em>Binned Residuals</em>) – Avalia se há padrões nos resíduos. Pontos vermelhos indicam desvios que podem sugerir problemas de ajuste. Aqui, o modelo de interação tem uma maior quantidade de pontos fora do intervalo de erro.</p></li>
<li><p><strong>Observações Influentes</strong> (<em>Influential Observations</em>) – Identifica pontos com alta influência no modelo, o que pode indicar necessidade de ajustes ou remoção de <em>outliers</em>. Ambos os modelos não parecem ter pontos pontos influentes. A inclusão da interação não impactou muito quais observações têm maior peso sobre o modelo.</p></li>
<li><p><strong>Colinearidade</strong> – Exibe o VIF (Fator de Inflação da Variância) das variáveis preditoras. Valores altos (acima de 5) podem indicar problemas de multicolinearidade. Na comparação dos dois modelos, este é um ponto importante, pois com a introdução da interação, os VIFs ficaram elevados. Pode significar que as variáveis interagem de forma redundante, prejudicando a interpretação dos coeficientes. O VIF pode ser também obtido para cada variável, usando a função <code>vif()</code> do pacote <code>car</code>:</p></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb208"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb208-1"><a href="#cb208-1" aria-hidden="true" tabindex="-1"></a>vif_valores <span class="ot">&lt;-</span> car<span class="sc">::</span><span class="fu">vif</span>(modelo2)</span>
<span id="cb208-2"><a href="#cb208-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(vif_valores)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>           GVIF Df GVIF^(1/(2*Df))
classe 1.336849  2        1.075278
sexo   1.232028  1        1.109967
idade  1.221055  1        1.105013
irco   1.128565  1        1.062340</code></pre>
</div>
<div class="sourceCode cell-code" id="cb210"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb210-1"><a href="#cb210-1" aria-hidden="true" tabindex="-1"></a>vif_valores2 <span class="ot">&lt;-</span> car<span class="sc">::</span><span class="fu">vif</span>(modelo3)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>there are higher-order terms (interactions) in this model
consider setting type = 'predictor'; see ?vif</code></pre>
</div>
<div class="sourceCode cell-code" id="cb212"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb212-1"><a href="#cb212-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(vif_valores2)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                 GVIF Df GVIF^(1/(2*Df))
sexo         9.826704  1        3.134757
classe      28.580915  2        2.312166
idade        1.222732  1        1.105772
irco         1.120413  1        1.058496
sexo:classe 37.637060  2        2.476874</code></pre>
</div>
</div>
<ul>
<li><strong>Normalidade dos Resíduos</strong> (<em>Normality of Residuals</em>) – Usa um gráfico Q-Q para verificar se os resíduos seguem uma distribuição normal. Desvios sistemáticos podem sinalizar problemas. Ambos, como era de esperar, parecem não ter uma distribuição normal. Entretanto, ao contrário da regressão linear, a regressão logística não assume a normalidade dos resíduos. Os resíduos de um modelo de regressão logística não se distribuem normalmente, pois a variável resposta é binária (0 ou 1) e o modelo prediz probabilidades.</li>
</ul>
<p>Concluindo, com esses resultados, parece que a interação <code>sexo:classe</code> não agregou muito ao modelo. Ela aumentou a colinearidade e fez os resíduos se tornarem menos confiáveis, sem impacto positivo claro nas previsões.</p>
<p><u>Razão de Verossimilhança</u></p>
<p>Em estatística, a verossimilhança (<strong>Likelihood</strong>) de um modelo é uma medida da probabilidade de observar os dados amostrais que temos, dada uma certa configuração dos parâmetros do modelo. Em outras palavras, ela nos diz quão “provável” é que o modelo, com seus coeficientes estimados, tenha gerado os dados que observamos.</p>
<p>No contexto da regressão logística, os parâmetros do modelo (os coeficientes <span class="math inline">\(\beta\)</span>) são estimados usando o método de <strong>máxima verossimilhança</strong> (veja também <a href="#sec-logisticfunction" class="quarto-xref"><span>Seção 18.8.1</span></a>). Esse método busca encontrar os valores dos coeficientes que maximizam a probabilidade de que os eventos observados (por exemplo, “sucesso” ou “fracasso” da variável dependente) tenham ocorrido.</p>
<p>A <strong>razão de verossimilhança (-2LL)</strong>, ou mais precisamente, <strong>-2 vezes o logaritmo da verossimilhança</strong>, é uma medida de desajuste do modelo. É uma transformação do valor da verossimilhança que é mais conveniente para cálculos e interpretação.</p>
<p>Matematicamente, ela é expressa como:<span class="math display">\[-2LL=-2 \times ln(L)\]</span> Onde:</p>
<ul>
<li>L é a verossimilhança do modelo</li>
<li>ln é o logaritmo natural</li>
</ul>
<p>Quanto <strong>menor</strong> o valor de -2LL, <strong>melhor</strong> é o ajuste do modelo aos dados. Isso ocorre porque um modelo com um bom ajuste tem uma verossimilhança (L) maior, e como -2LL envolve o logaritmo negativo da verossimilhança, um L maior resulta em um -2LL menor.</p>
<p>A importância do -2LL reside principalmente em sua utilização para realizar o <strong>Teste da Razão de Verossimilhança (Likelihood Ratio Test)</strong>. Este teste compara a qualidade do ajuste de dois modelos:</p>
<ol type="1">
<li><strong>Modelo Nulo (ou Modelo Base)</strong>: Um modelo mais simples, geralmente contendo apenas a constante (intercepto), sem as variáveis preditoras de interesse.</li>
<li><strong>Modelo Proposto</strong>: O modelo completo que se está testando, que inclui as variáveis preditoras.</li>
</ol>
<p>O teste da razão de verossimilhança calcula a diferença entre o -2LL do modelo nulo e o -2LL do modelo proposto:</p>
<p><span class="math display">\[G = (-2LL _{Modelo \ Nulo}) - (-2LL_{Modelo \ Proposto})\]</span> Essa estatística G segue uma distribuição qui-quadrado (<span class="math inline">\(\chi^2\)</span>) com graus de liberdade iguais à diferença no número de parâmetros entre os dois modelos.Um valor G grande e estatisticamente significativo (com um p-valor baixo), indica que o modelo proposto se ajusta significativamente melhor aos dados do que o modelo nulo (sem as variáveis preditoras). Isso sugere que as variáveis independentes no modelo contribuem para explicar a variável dependente.<br>
O -2LL do modelo nulo (<code>Null deviance</code>) e do modelo proposto (<code>Residual deviance</code>) podem ser verificados através de:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb214"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb214-1"><a href="#cb214-1" aria-hidden="true" tabindex="-1"></a>modelo2<span class="sc">$</span>null.deviance</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1210.441</code></pre>
</div>
<div class="sourceCode cell-code" id="cb216"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb216-1"><a href="#cb216-1" aria-hidden="true" tabindex="-1"></a>modelo2<span class="sc">$</span>deviance</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 722.8166</code></pre>
</div>
</div>
<p>O cálculo da estatística G (Teste da Razão de Verossimilhança) pode ser obtido, como visto pela diferença entre deviance do modelo nulo e do modelo ajustado:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb218"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb218-1"><a href="#cb218-1" aria-hidden="true" tabindex="-1"></a>estatistica_G <span class="ot">&lt;-</span> modelo2<span class="sc">$</span>null.deviance <span class="sc">-</span> modelo2<span class="sc">$</span>deviance </span>
<span id="cb218-2"><a href="#cb218-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(estatistica_G)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 487.6243</code></pre>
</div>
<div class="sourceCode cell-code" id="cb220"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb220-1"><a href="#cb220-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Graus de liberdade para o teste G</span></span>
<span id="cb220-2"><a href="#cb220-2" aria-hidden="true" tabindex="-1"></a>df_G <span class="ot">&lt;-</span> modelo2<span class="sc">$</span>df.null <span class="sc">-</span> modelo2<span class="sc">$</span>df.residual</span>
<span id="cb220-3"><a href="#cb220-3" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(df_G)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 5</code></pre>
</div>
<div class="sourceCode cell-code" id="cb222"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb222-1"><a href="#cb222-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Teste de significância </span></span>
<span id="cb222-2"><a href="#cb222-2" aria-hidden="true" tabindex="-1"></a>valor_P <span class="ot">&lt;-</span> <span class="fu">format</span>(<span class="dv">1</span> <span class="sc">-</span> <span class="fu">pchisq</span>(estatistica_G, </span>
<span id="cb222-3"><a href="#cb222-3" aria-hidden="true" tabindex="-1"></a>                             <span class="at">df =</span> df_G), </span>
<span id="cb222-4"><a href="#cb222-4" aria-hidden="true" tabindex="-1"></a>                  <span class="at">sientific =</span> <span class="cn">TRUE</span>)</span>
<span id="cb222-5"><a href="#cb222-5" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(valor_P)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "0"</code></pre>
</div>
</div>
<p>O valor <em>P</em> é extremamente baixo, isso é interpretado como uma diferença altamente significativa entre os modelos. No contexto de teste de verossimilhança, isso sugere que o modelo mais complexo se ajusta significativamente melhor do que o modelo nulo.</p>
<p><u>Estatística <span class="math inline">\(R^2\)</span></u></p>
<p><strong>R ao quadrado</strong> é uma métrica útil para a avaliação da regressão linear simples e múltipla, mas não tem o mesmo significado na regressão logística.<br>
Os estatísticos criaram análogos do <span class="math inline">\(R^2\)</span> para regressão logística referidas, coletivamente, como <strong>pseudo R ao quadrado</strong>. Este não tem a mesma interpretação, na medida em que não é simplesmente a proporção da variância explicada pelo modelo.<br>
Existem muitas maneiras diferentes de calcular um <span class="math inline">\(R^2\)</span> para regressão logística e nenhum consenso sobre qual é a melhor. Os dois métodos mais frequentemente relatados em softwares estatísticos são um proposto por McFadden <span class="citation" data-cites="mcfadden1974conditional">(<a href="references.html#ref-mcfadden1974conditional" role="doc-biblioref">54</a>)</span> e outro por Cox-Snell <span class="citation" data-cites="CoxSnell1989analysis">(<a href="references.html#ref-CoxSnell1989analysis" role="doc-biblioref">55</a>)</span>. Também é bastante relatado o de Nagelkerke <span class="citation" data-cites="nagelkerke1991note">(<a href="references.html#ref-nagelkerke1991note" role="doc-biblioref">56</a>)</span>. Os valores mais altos indicam um melhor ajuste do modelo.</p>
<p>O <span class="math inline">\(R^2\)</span> de McFadden é uma versão, baseada no <em>log-likelihood</em> para o modelo somente com o intercepto e o modelo estimado completo. O <span class="math inline">\(R^2\)</span> de Cox e Snell é baseado no l<em>og-likelihood</em> para o modelo em comparação com o <em>log-likelihood</em> para um modelo basal. No entanto, com resultados categóricos, tem um valor máximo teórico inferior a 1, mesmo para um modelo “perfeito”.<br>
O <span class="math inline">\(R^2\)</span> de Nagelkerke é uma versão ajustada do <span class="math inline">\(R^2\)</span> de Cox e Snell que ajusta a escala da estatística para cobrir todo o intervalo de 0 a 1.<br>
Pode-se obter os vários valores de <span class="math inline">\(R^2\)</span>, usando a função <code>PseudoR2()</code> do pacote <code>DescTools</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb224"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb224-1"><a href="#cb224-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(DescTools)</span>
<span id="cb224-2"><a href="#cb224-2" aria-hidden="true" tabindex="-1"></a><span class="fu">PseudoR2</span>(modelo2, <span class="at">which =</span><span class="fu">c</span>(<span class="st">"Nagelkerke"</span>, <span class="st">"McFadden"</span>, <span class="st">"CoxSnell"</span>))</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Nagelkerke   McFadden   CoxSnell 
 0.5629342  0.4028485  0.4127713 </code></pre>
</div>
</div>
<p>Como se verifica, na Saída do código, todos os valores de <span class="math inline">\(R^2\)</span> diferem ligeiramente, mas podem ser usados como medidas de tamanho de efeito para o modelo. Então, basicamente, o pseudo R quadrado pode ser interpretado como <span class="math inline">\(R^2\)</span>, mas não se espera que seja tão grande. Uma regra prática, bastante útil é que o pseudo R quadrado de McFadden variando de 0,2 a 0,4 indica um ajuste muito bom do modelo <span class="citation" data-cites="mcfadden2021quantitative">(<a href="references.html#ref-mcfadden2021quantitative" role="doc-biblioref">57</a>)</span>.</p>
<p><u>Pesquisa de valores atípicos e pontos de alavancagem</u></p>
<p>Um <em>outlier</em> é uma observação que não é bem prevista pelo modelo de regressão ajustado (ou seja, tem um grande resíduo positivo ou negativo). Uma observação com um alto valor de alavancagem possui uma combinação incomum de valores preditores. Ou seja, é um <em>outlier</em> no espaço do preditor.<br>
Uma observação influente é uma observação que tem um impacto desproporcional na determinação dos parâmetros do modelo. As observações influentes são identificadas usando uma estatística chamada <em>distância de Cook</em> ou <em>D de Cook</em>.</p>
<p>A identificação dos <em>outliers</em> é feita essencialmente através dos resíduos padronizados <span class="citation" data-cites="bobbitt2020residuals">(<a href="references.html#ref-bobbitt2020residuals" role="doc-biblioref">58</a>)</span>, com a função <code>rstandard()</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb226"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb226-1"><a href="#cb226-1" aria-hidden="true" tabindex="-1"></a>residuos_p <span class="ot">&lt;-</span> <span class="fu">rstandard</span>(modelo2)</span>
<span id="cb226-2"><a href="#cb226-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(residuos_p)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
-2.5513 -0.5440 -0.3651 -0.0538  0.5175  2.7016 </code></pre>
</div>
</div>
<p>Em uma amostra normalmente distribuída, ao redor de 95% dos valores estão entre –1,96 e +1,96, 99% deve estar entre –2,58 e +2,58 e quase todos (99,9%) devem situar-se entre –3,09 e +3,09. Portanto, resíduos padronizados com um valor absoluto maior que 3 são motivo de preocupação porque em uma amostra média é improvável que aconteça um valor tão alto por acaso <span class="citation" data-cites="field2012outliers">(<a href="references.html#ref-field2012outliers" role="doc-biblioref">59</a>)</span>. Na Saída da função <code>rstandard()</code>, observa-se que os valores estão dentro de –3 e +3.</p>
<p>Essa avaliação pode ser acompanhada de um gráfico diagnóstico, usando a função <code>plot()</code> para o modelo <code>modelo2</code>(para maiores detalhes veja as <a href="15-correlacao-regressao.html#sec-graphdiag" class="quarto-xref"><span>Seção 15.3.2.1</span></a> e <a href="15-correlacao-regressao.html#sec-BP" class="quarto-xref"><span>Seção 15.3.2.4</span></a>).</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb228"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb228-1"><a href="#cb228-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span> (modelo2, <span class="at">which =</span> <span class="dv">5</span>)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-graph5" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" data-fig-pos="H">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-graph5-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="18-epidemiologia_files/figure-html/fig-graph5-1.png" class="quarto-figure quarto-figure-center figure-img" style="width:60.0%;height:60.0%" data-fig-pos="H">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-graph5-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figura&nbsp;18.19: Gráfico diagnóstico dos resíduos e pontos de alavancagem.
</figcaption>
</figure>
</div>
</div>
</div>
<p>São produzidos vários gráficos com a função <code>plot()</code>, mas o foco é o gráfico 5 (<a href="#fig-graph5" class="quarto-xref">Figura&nbsp;<span>18.19</span></a>) que confirma os achados de não existirem valores atípicos que comprometam o ajuste do modelo. A <a href="#fig-linearidade" class="quarto-xref">Figura&nbsp;<span>18.17</span></a> exibe um gráfico igual, sem mostrar as distância s de Cook.</p>
<p>Para a análise dos pontos influentes, pode-se verificar os pontos de alavancagem (<code>leverage</code>) com a função <code>hatvalues()</code> do pacote <code>stats</code>, incluído no R base.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb229"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb229-1"><a href="#cb229-1" aria-hidden="true" tabindex="-1"></a>hat <span class="ot">&lt;-</span> <span class="fu">hatvalues</span>(modelo2)</span>
<span id="cb229-2"><a href="#cb229-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span> (hat)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    Min.  1st Qu.   Median     Mean  3rd Qu.     Max. 
0.002009 0.002894 0.006226 0.006550 0.007706 0.078849 </code></pre>
</div>
</div>
<p>Os valores de alavancagem podem estar entre 0 (indicando que o caso não tem qualquer influência) e 1 (indicando que o caso tem grande influência). Se nenhum caso exercer influência indevida sobre o modelo, se espera que todos os valores de alavancagem estivessem próximos do valor médio. Alguns autores <span class="citation" data-cites="hoaglin1978hat">(<a href="references.html#ref-hoaglin1978hat" role="doc-biblioref">60</a>)</span>, recomendam investigar casos com valores superiores a duas vezes a média (0.0131004) como ponto de corte para identificar casos com influência indevida. Alguns valores (<span class="math inline">\(\sim\)</span> 5%) estão acima de duas vezes a média, o que se pode considerar pouco. Principalmente, porque o maior valor está bem longe do valor igual a 1 (0.0788494). É interessante fazer a análise, observando junto a <em>distância de Cook</em> para ver se um ponto é um <em>outlier</em> significativo.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb231"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb231-1"><a href="#cb231-1" aria-hidden="true" tabindex="-1"></a>cook <span class="ot">&lt;-</span> <span class="fu">cooks.distance</span>(modelo2)</span>
<span id="cb231-2"><a href="#cb231-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span> (cook)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     Min.   1st Qu.    Median      Mean   3rd Qu.      Max. 
2.089e-06 3.885e-05 1.684e-04 1.043e-03 5.462e-04 3.074e-02 </code></pre>
</div>
</div>
<p>Se a distância de Cook é <span class="math inline">\(\lt\)</span> 1, não há necessidade real de excluir esses valores, uma vez que não tem um grande efeito na análise de regressão <span class="citation" data-cites="stevens1984outliers">(<a href="references.html#ref-stevens1984outliers" role="doc-biblioref">61</a>)</span>. Na <a href="#fig-graph5" class="quarto-xref">Figura&nbsp;<span>18.19</span></a>), verifica-se que os casos mais distantes não alcançam a distância de Cook.</p>


<div id="refs" class="references csl-bib-body" role="list" style="display: none">
<div id="ref-straus2019screening" class="csl-entry" role="listitem">
<div class="csl-left-margin">1. </div><div class="csl-right-inline">Straus SE, Glasziou P, et al. Diagnosis and screening. Em: Evidence-Based Medicine: How to Practice and Teach EBM. Fifth Edition. Edinburgh: Elsevier; 2019. p. 185–218. </div>
</div>
<div id="ref-altman1994diagnostic" class="csl-entry" role="listitem">
<div class="csl-left-margin">2. </div><div class="csl-right-inline">Altman DG, Bland JM. Diagnostic tests. 1: Sensitivity and specificity. BMJ: British Medical Journal. 1994;308(6943):1552. </div>
</div>
<div id="ref-peixoto2011indices" class="csl-entry" role="listitem">
<div class="csl-left-margin">3. </div><div class="csl-right-inline">Peixoto R de O, Nunes TA, Gomes CA. Indices diagnósticos da ultrassonografia abdominal na apendicite aguda: influência do genero e constituição física, tempo evolutivo da doença e experiencia do radiologista. Revista do Colégio Brasileiro de Cirurgiões. 2011;38:105–11. </div>
</div>
<div id="ref-stevenson2022epir" class="csl-entry" role="listitem">
<div class="csl-left-margin">4. </div><div class="csl-right-inline">Mark, Sergeant E, et al. epiR: Tools for the Analysis of Epidemiological Data [Internet]. 2022. Disponível em: <a href="https://CRAN.R-project.org/package=epiR">https://CRAN.R-project.org/package=epiR</a></div>
</div>
<div id="ref-altman1994predictive" class="csl-entry" role="listitem">
<div class="csl-left-margin">5. </div><div class="csl-right-inline">Altman DG, Bland JM. Diagnostic tests 2: predictive values. Bmj. 1994;309(6947):102. </div>
</div>
<div id="ref-lima2016perfil" class="csl-entry" role="listitem">
<div class="csl-left-margin">6. </div><div class="csl-right-inline">Pereira Lima A, Vieira FJ, Oliveira GP de M, et al. Perfil clinico-epidemiologico da apendicite aguda: analise retrospectiva de 638 casos. Revista do Colegio Brasileiro de Cirurgiões. 2016;43:248–53. </div>
</div>
<div id="ref-halkin1998likelihood" class="csl-entry" role="listitem">
<div class="csl-left-margin">7. </div><div class="csl-right-inline">Halkin A, Reichman J, Schwaber M, Paltiel O, Brezis M. Likelihood ratios: getting diagnostic testing into perspective. QJM: monthly journal of the Association of Physicians. 1998;91(4):247–58. </div>
</div>
<div id="ref-deeks2004likelihood" class="csl-entry" role="listitem">
<div class="csl-left-margin">8. </div><div class="csl-right-inline">Deeks JJ, Altman DG. Diagnostic tests 4: likelihood ratios. Bmj. 2004;329(7458):168–9. </div>
</div>
<div id="ref-guyatt2015diagnostic" class="csl-entry" role="listitem">
<div class="csl-left-margin">9. </div><div class="csl-right-inline">Guyatt G, Rennie D, et al. Diagnostic Tests. Em: User’s Guides to Medical Literature: A Manual for Evidence-Based Clinical Practice. 3rd Edition. New York: JAMA; 2015. p. 607–31. </div>
</div>
<div id="ref-oliveira2022diagnostico" class="csl-entry" role="listitem">
<div class="csl-left-margin">10. </div><div class="csl-right-inline">Oliveira Filho PF de. Testes Diagnósticos. Em: Epidemiologia e Bioestatística: Fundamentos para a leitura crítica. Segunda Edição. Rio de Janeiro: Editora Rubio; 2022. p. 89–105. </div>
</div>
<div id="ref-fagan1975nomogram" class="csl-entry" role="listitem">
<div class="csl-left-margin">11. </div><div class="csl-right-inline">Fagan T. Nomogram for Bayes’s theorem. New England Journal of Medicine. 1975;293:257. </div>
</div>
<div id="ref-caraguel2013fagan" class="csl-entry" role="listitem">
<div class="csl-left-margin">12. </div><div class="csl-right-inline">Caraguel CG, Vanderstichel R. The two-step Fagan’s nomogram: ad hoc interpretation of a diagnostic test result without calculation. BMJ Evidence-Based Medicine. 2013;18(4):125–8. </div>
</div>
<div id="ref-altman1994roc" class="csl-entry" role="listitem">
<div class="csl-left-margin">13. </div><div class="csl-right-inline">Altman DG, Bland JM. Diagnostic tests 3: receiver operating characteristic plots. BMJ: British Medical Journal. 1994;309(6948):188. </div>
</div>
<div id="ref-robin2011proc" class="csl-entry" role="listitem">
<div class="csl-left-margin">14. </div><div class="csl-right-inline">Robin X, Turck N, Hainard A, et al. pROC: an open-source package for R and S+ to analyze and compare ROC curves. BMC Bioinformatics. 2011;12(1):1–8. </div>
</div>
<div id="ref-borges2016accuracy" class="csl-entry" role="listitem">
<div class="csl-left-margin">15. </div><div class="csl-right-inline">Borges LSR. Diagnostic accuracy measures in cardiovascular research. Int J Cardiovasc Sci. 2016;29(3):218–22. </div>
</div>
<div id="ref-delong1988comparing" class="csl-entry" role="listitem">
<div class="csl-left-margin">16. </div><div class="csl-right-inline">DeLong ER, DeLong DM, Clarke-Pearson DL. Comparing the areas under two or more correlated receiver operating characteristic curves: a nonparametric approach. Biometrics. 1988;44:837–45. </div>
</div>
<div id="ref-youden1950index" class="csl-entry" role="listitem">
<div class="csl-left-margin">17. </div><div class="csl-right-inline">Youden WJ. Index for rating diagnostic tests. Cancer. 1950;3(1):32–5. </div>
</div>
<div id="ref-cohen1960coefficient" class="csl-entry" role="listitem">
<div class="csl-left-margin">18. </div><div class="csl-right-inline">Cohen J. A coefficient of agreement for nominal scales. Educational and Psychological Measurement. 1960;20(1):37–46. </div>
</div>
<div id="ref-landis1977measurement" class="csl-entry" role="listitem">
<div class="csl-left-margin">19. </div><div class="csl-right-inline">Landis JR, Koch GG. The measurement of observer agreement for categorical data. Biometrics. 1977;159–74. </div>
</div>
<div id="ref-zeileis2007residual" class="csl-entry" role="listitem">
<div class="csl-left-margin">20. </div><div class="csl-right-inline">Zeileis A, Meyer D, Hornik K. Residual-based shadings for visualizing (conditional) independence. Journal of Computational and Graphical Statistics. 2007;16(3):507–25. </div>
</div>
<div id="ref-feychting1998reduced" class="csl-entry" role="listitem">
<div class="csl-left-margin">21. </div><div class="csl-right-inline">Feychting M, Osterlund B, Ahlbom A. Reduced cancer incidence among the blind. Epidemiology. 1998;9(5):490–4. </div>
</div>
<div id="ref-szklo2019measuring" class="csl-entry" role="listitem">
<div class="csl-left-margin">22. </div><div class="csl-right-inline">Szklo M, Nieto FJ. Measuring Disease Occurrence. Em: Epidemiology: beyond the basics. Fourth Edition. Burlington, MA: Jones &amp; Bartlett Learning; 2019. p. 80–1. </div>
</div>
<div id="ref-gross1976oswego" class="csl-entry" role="listitem">
<div class="csl-left-margin">23. </div><div class="csl-right-inline">Gross M. Oswego County revisited. Public health reports. 1976;91(2):168. </div>
</div>
<div id="ref-aragon2020epitools" class="csl-entry" role="listitem">
<div class="csl-left-margin">24. </div><div class="csl-right-inline">Aragon TJ. epitools: Epidemiology Tools [Internet]. 2020. Disponível em: <a href="https://CRAN.R-project.org/package=epitools">https://CRAN.R-project.org/package=epitools</a></div>
</div>
<div id="ref-szklo2019associations" class="csl-entry" role="listitem">
<div class="csl-left-margin">25. </div><div class="csl-right-inline">Szklo M, Nieto FJ. Measuring Associations Between Exposures and Outcomes. Em: Epidemiology: beyond the basics. Fourth Edition. Burlington, MA: Jones &amp; Bartlett Learning; 2019. p. 88–94. </div>
</div>
<div id="ref-davies1998can" class="csl-entry" role="listitem">
<div class="csl-left-margin">26. </div><div class="csl-right-inline">Davies HTO, Crombie IK, Tavakoli M. When can odds ratios mislead? BMJ. 1998;316(7136):989–91. </div>
</div>
<div id="ref-hopkins2016scales" class="csl-entry" role="listitem">
<div class="csl-left-margin">27. </div><div class="csl-right-inline">Hopkins WG. A Scale of Magnitudes for Effect Statistics [Internet]. A New View of Statistics. Sportscience; 2016. Disponível em: <a href="http://www.sportsci.org/resource/stats/index.html">http://www.sportsci.org/resource/stats/index.html</a></div>
</div>
<div id="ref-madi2010prevalence" class="csl-entry" role="listitem">
<div class="csl-left-margin">28. </div><div class="csl-right-inline">Madi JM, Souza R da S de, Araujo BF de, Oliveira Filho PF, et al. Prevalence of toxoplasmosis, HIV, syphilis and rubella in a population of puerperal women using Whatman 903<span></span> filter paper. The Brazilian Journal of Infectious Diseases. 2010;14(1):24–9. </div>
</div>
<div id="ref-szklo2019ar" class="csl-entry" role="listitem">
<div class="csl-left-margin">29. </div><div class="csl-right-inline">Szklo M, Nieto FJ. Measuring Associations Between Exposures and Outcomes. Em: Epidemiology: beyond the basics. Fourth Edition. Burlington, MA: Jones &amp; Bartlett Learning; 2019. p. 84–102. </div>
</div>
<div id="ref-szklo2019rrr" class="csl-entry" role="listitem">
<div class="csl-left-margin">30. </div><div class="csl-right-inline">Szklo M, Nieto FJ. Measuring Associations Between Exposures and Outcomes. Em: Epidemiology: beyond the basics. Fourth Edition. Burlington, MA: Jones &amp; Bartlett Learning; 2019. p. 97–8. </div>
</div>
<div id="ref-steering1989final" class="csl-entry" role="listitem">
<div class="csl-left-margin">31. </div><div class="csl-right-inline">Physicians’ Health Study Research Group* SC of the. Final report on the aspirin component of the ongoing Physicians’ Health Study. New England Journal of Medicine. 1989;321(3):129–35. </div>
</div>
<div id="ref-kohl2019package" class="csl-entry" role="listitem">
<div class="csl-left-margin">32. </div><div class="csl-right-inline">Kohl M. Package <span>«MKmisc»</span> [Internet]. 2019. Disponível em: <a href="https://github.com/stamats/MKmisc">https://github.com/stamats/MKmisc</a></div>
</div>
<div id="ref-bender2001calculating" class="csl-entry" role="listitem">
<div class="csl-left-margin">33. </div><div class="csl-right-inline">Bender R. Calculating confidence intervals for the number needed to treat. Controlled clinical trials. 2001;22(2):102–10. </div>
</div>
<div id="ref-clark2003survival" class="csl-entry" role="listitem">
<div class="csl-left-margin">34. </div><div class="csl-right-inline">Clark TG, Bradburn MJ, Love SB, Altman DG. Survival analysis Part I: basic concepts and first analyses. British Journal of Cancer. 2003;89(2):232–8. </div>
</div>
<div id="ref-kaplan1958nonparametric" class="csl-entry" role="listitem">
<div class="csl-left-margin">35. </div><div class="csl-right-inline">Kaplan EL, Meier P. Nonparametric Estimation from Incomplete Observations. Journal of the American Statistical Association. 1958;53(282):457–81. </div>
</div>
<div id="ref-peat2014survival" class="csl-entry" role="listitem">
<div class="csl-left-margin">36. </div><div class="csl-right-inline">Peat J, Barton B. Survival analyses. Em: Medical statistics : a guide to SPSS, data analysis, and critical appraisal. New York, NY: John Wiley &amp; Sons; 2014. p. 352–3. </div>
</div>
<div id="ref-qiu2015powersurvepi" class="csl-entry" role="listitem">
<div class="csl-left-margin">37. </div><div class="csl-right-inline">Qiu W, Chavarro J, Lazarus R, Rosner B, Ma J. powerSurvEpi: Power and Sample Size Calculation for Survival Analysis of Epidemiological Studies. R package version 00. 2015;9. </div>
</div>
<div id="ref-therneau2015survival" class="csl-entry" role="listitem">
<div class="csl-left-margin">38. </div><div class="csl-right-inline">Therneau T et al. A package for Survival Analysis in R. R package version. 2015;2(7). </div>
</div>
<div id="ref-kassambara2021survminer" class="csl-entry" role="listitem">
<div class="csl-left-margin">39. </div><div class="csl-right-inline">Kassambara A, Kosinski M, Biecek P, Fabian S. Survminer: Drawing Survival Curves Using ggplot2. URL https://CRAN R-project org/package= survminer R package version 04. 2021;9. </div>
</div>
<div id="ref-bland2004logrank" class="csl-entry" role="listitem">
<div class="csl-left-margin">40. </div><div class="csl-right-inline">Bland JM, Altman DG. The logrank test. BMJ. 2004;328(7447):1073. </div>
</div>
<div id="ref-cox1958regression" class="csl-entry" role="listitem">
<div class="csl-left-margin">41. </div><div class="csl-right-inline">Cox DR. The regression analysis of binary sequences. Journal of the Royal Statistical Society Series B: Statistical Methodology. 1958;20(2):215–32. </div>
</div>
<div id="ref-peat2014adjusted" class="csl-entry" role="listitem">
<div class="csl-left-margin">42. </div><div class="csl-right-inline">Peat J, Barton B. Adjusted odds ratios. Em: Medical statistics : a guide to SPSS, data analysis, and critical appraisal. New York, NY: John Wiley &amp; Sons; 2014. p. 298–308. </div>
</div>
<div id="ref-hair2009analise" class="csl-entry" role="listitem">
<div class="csl-left-margin">43. </div><div class="csl-right-inline">Hair JF, Black WC, Babin BJ, Anderson RE, Tatham RL. Regressão logística: Regressão com uma variável dependente binária. Em: Análise Multivariada de Dados. 6a Edição. bookman; 2009. p. 283–302. </div>
</div>
<div id="ref-verzani2014reglog" class="csl-entry" role="listitem">
<div class="csl-left-margin">44. </div><div class="csl-right-inline">Verzani J. Extensions to linear model. Em: Using R for Introductory Statistics. Second Edition. Chapman &amp; Hall/CRC; 2014. p. 440–8. </div>
</div>
<div id="ref-stoltzfus2011logistic" class="csl-entry" role="listitem">
<div class="csl-left-margin">45. </div><div class="csl-right-inline">Stoltzfus JC. Logistic regression: a brief primer. Academic emergency medicine. 2011;18(10):1099–104. </div>
</div>
<div id="ref-wiki:xxx" class="csl-entry" role="listitem">
<div class="csl-left-margin">46. </div><div class="csl-right-inline">Wikipédia. RMS Titanic — Wikipédia<span>,</span> a enciclopédia livre [Internet]. 2025. Disponível em: <a href="https://pt.wikipedia.org/w/index.php?title=RMS_Titanic&amp;oldid=69869298">https://pt.wikipedia.org/w/index.php?title=RMS_Titanic&amp;oldid=69869298</a></div>
</div>
<div id="ref-Prabhakaran_2016" class="csl-entry" role="listitem">
<div class="csl-left-margin">47. </div><div class="csl-right-inline">Prabhakaran S. Missing Value Treatment [Internet]. datascienceplus. 2016. Disponível em: <a href="https://datascienceplus.com/missing-value-treatment/">https://datascienceplus.com/missing-value-treatment/</a></div>
</div>
<div id="ref-van2011mice" class="csl-entry" role="listitem">
<div class="csl-left-margin">48. </div><div class="csl-right-inline">Van Buuren S, Groothuis-Oudshoorn K. mice: Multivariate imputation by chained equations in R. Journal of statistical software. 2011;45:1–67. </div>
</div>
<div id="ref-subramanian2013over" class="csl-entry" role="listitem">
<div class="csl-left-margin">49. </div><div class="csl-right-inline">Subramanian J, Simon R. Overfitting in prediction models–is it a problem only in high dimensions? Contemporary clinical trials. 2013;36(2):636–41. </div>
</div>
<div id="ref-field2012logit" class="csl-entry" role="listitem">
<div class="csl-left-margin">50. </div><div class="csl-right-inline">Field A, Miles J, Field Z. Logistic regression. Em: Discovering statistics using R. Sage Publications, Ltd; 2012. p. 320. </div>
</div>
<div id="ref-hosmer2013applied" class="csl-entry" role="listitem">
<div class="csl-left-margin">51. </div><div class="csl-right-inline">Hosmer Jr DW, Lemeshow S, Sturdivant RX. Interpretation of Fitted Logistic Regression Model. Em: Applied logistic regression. Third Edition. John Wiley &amp; Sons; 2013. p. 49–64. </div>
</div>
<div id="ref-ludecke2018sjplot" class="csl-entry" role="listitem">
<div class="csl-left-margin">52. </div><div class="csl-right-inline">Lüdecke D. sjPlot: Data Visualization for Statistics in Social Science [Internet]. 2024. Disponível em: <a href="https://CRAN.R-project.org/package=sjPlot">https://CRAN.R-project.org/package=sjPlot</a></div>
</div>
<div id="ref-ludecke2018ggeffects" class="csl-entry" role="listitem">
<div class="csl-left-margin">53. </div><div class="csl-right-inline">Lüdecke D. <a href="https://doi.org/10.21105/joss.00772">ggeffects: Tidy Data Frames of Marginal Effects from Regression Models.</a> Journal of Open Source Software. 2018;3(26):772. </div>
</div>
<div id="ref-mcfadden1974conditional" class="csl-entry" role="listitem">
<div class="csl-left-margin">54. </div><div class="csl-right-inline">McFadden D. Conditional Logit Analysis of Qualitative Choice Behavior. Em: Zarembka P, editor. Frontiers in econometrics. Academic Press; 1974. p. 105-142-142. </div>
</div>
<div id="ref-CoxSnell1989analysis" class="csl-entry" role="listitem">
<div class="csl-left-margin">55. </div><div class="csl-right-inline">Cox DR, Snell EJ. Analysis of Binary Data. Second Edition. Chapman; Hall/CRC; 1989. </div>
</div>
<div id="ref-nagelkerke1991note" class="csl-entry" role="listitem">
<div class="csl-left-margin">56. </div><div class="csl-right-inline">Nagelkerke NJ et al. A note on a general definition of the coefficient of determination. Biometrika. 1991;78(3):691–2. </div>
</div>
<div id="ref-mcfadden2021quantitative" class="csl-entry" role="listitem">
<div class="csl-left-margin">57. </div><div class="csl-right-inline">McFadden D. Quantitative methods for analysing travel behaviour of individuals: some recent developments. Em: Behavioural travel modelling. Routledge; 2021. p. 279–318. </div>
</div>
<div id="ref-bobbitt2020residuals" class="csl-entry" role="listitem">
<div class="csl-left-margin">58. </div><div class="csl-right-inline">Bobbitt Z. How to Calculate Standardized Residuals in R [Internet]. Statology. 2020. Disponível em: <a href="https://www.statology.org/standardized-residuals-in-r/">https://www.statology.org/standardized-residuals-in-r/</a></div>
</div>
<div id="ref-field2012outliers" class="csl-entry" role="listitem">
<div class="csl-left-margin">59. </div><div class="csl-right-inline">Field A, Miles J, Field Z. Outliers and influential cases. Em: Discovering statistics using R. Sage Publications, Ltd; 2012. p. 288–92. </div>
</div>
<div id="ref-hoaglin1978hat" class="csl-entry" role="listitem">
<div class="csl-left-margin">60. </div><div class="csl-right-inline">Hoaglin DC, Welsch RE. The hat matrix in regression and ANOVA. The American Statistician. 1978;32(1):17–22. </div>
</div>
<div id="ref-stevens1984outliers" class="csl-entry" role="listitem">
<div class="csl-left-margin">61. </div><div class="csl-right-inline">Stevens JP. Outliers and influential data points in regression analysis. Psychological bulletin. 1984;95(2):334. </div>
</div>
</div>
</section>
</section>
</section>
<section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes">
<hr>
<ol>
<li id="fn1"><p>Verossimilhança no sentido de a qualidade de algo que parece verdadeiro ou provável, que não contraria a verdade<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn2"><p>Existem duas maneiras de descrever uma estimativa de odds: ou como um número isolado, por exemplo, 0,25, subentendendo que expressa uma razão, 0,25:1,0, ou de forma clara como uma razão 1:4. Ou seja, para cada indivíduo com o fator existem quatro sem o fator. Tradicional e comumente usados no mundo das apostas em corridas de cavalos.<a href="#fnref2" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn3"><p>Foi mantido o nome das variáveis em inglês, pois no banco de dados <code>oswego</code> elas estão nessa língua.<a href="#fnref3" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn4"><p>em inglês, <em>built-in bias</em><a href="#fnref4" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn5"><p>Observem que todo o intervalo de confiança de 95% encontra-se abaixo de 1, indicando que existe significância estatística.<a href="#fnref5" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn6"><p>Aproveite para revisar como construir matriz<a href="#fnref6" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn7"><p>Em inglês, NNH (number needed to harm).<a href="#fnref7" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn8"><p>Lembre-se que o diretório mostrado no comando é o do autor, você deverá usar o do seu computador<a href="#fnref8" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn9"><p>Todo esse processo foi realizado com objetivo didático, para revisar a realização de manipulação de dados no R<a href="#fnref9" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn10"><p>É fundamentado na <em>teoria da informação</em>, teoria matemática da informação que estuda a quantificação, armazenamento e comunicação da informação. Quando um modelo estatístico é usado para representar um determinado processo, a representação nunca será exata, ou seja, o modelo nunca será perfeito e certamente algumas informações serão perdidas. O AIC estima a quantidade relativa de informação perdida por um determinado modelo: quanto menos informações um modelo perde, maior a qualidade desse modelo e menor a pontuação AIC.<a href="#fnref10" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn11"><p>Veja mais detalhes sobre <em>Odds Ratio</em> na <a href="#sec-or" class="quarto-xref"><span>Seção 18.5.1</span></a>.<a href="#fnref11" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copiada");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copiada");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./17-testes-naoParametricos.html" class="pagination-link" aria-label="Métodos não paramétricos">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Métodos não paramétricos</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./references.html" class="pagination-link" aria-label="References">
        <span class="nav-page-text">References</span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




</body></html>