<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="pt" xml:lang="pt"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.42">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>10&nbsp; Estimação – Bioestatística Usando o R</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./11-testeHipoteses.html" rel="next">
<link href="./09-distAmostrais.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-2f5df379a58b258e96c21c0638c20c03.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-8da5b4427184b79ecddefad3d342027e.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "Nenhum resultado",
    "search-matching-documents-text": "documentos correspondentes",
    "search-copy-link-title": "Copiar link para a busca",
    "search-hide-matches-text": "Esconder correspondências adicionais",
    "search-more-match-text": "mais correspondência neste documento",
    "search-more-matches-text": "mais correspondências neste documento",
    "search-clear-button-title": "Limpar",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancelar",
    "search-submit-button-title": "Enviar",
    "search-label": "Procurar"
  }
}</script>
<script src="site_libs/kePrint-0.0.1/kePrint.js"></script>

<link href="site_libs/lightable-0.0.1/lightable.css" rel="stylesheet">


  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="style.css">
</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Alternar barra lateral" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./10-estimacao.html"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Estimação</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Alternar barra lateral" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Procurar" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Bioestatística Usando o R</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Procurar"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Prefácio</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introdução</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02-dados.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Natureza dos Dados</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./03-producaoDados.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Produção dos Dados</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./04-ambienteR.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Ambiente do <em>R</em></span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./05-manipulandoDados.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Manipulando os dados no <em>RStudio</em></span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./06-descrevendoDados.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Descrevendo os dados</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./07-probabilidades.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Introdução à Teoria das Probabilidades</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./08-assimetria_curtose.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Assimetria e Curtose</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./09-distAmostrais.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Distribuições Amostrais</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./10-estimacao.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Estimação</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./11-testeHipoteses.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Teste de Hipóteses</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./summary.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Summary</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Índice</h2>
   
  <ul>
  <li><a href="#pacotes-necessários-neste-capítulo" id="toc-pacotes-necessários-neste-capítulo" class="nav-link active" data-scroll-target="#pacotes-necessários-neste-capítulo"><span class="header-section-number">10.1</span> Pacotes necessários neste capítulo</a></li>
  <li><a href="#sec-dadoscap10" id="toc-sec-dadoscap10" class="nav-link" data-scroll-target="#sec-dadoscap10"><span class="header-section-number">10.2</span> Dados</a></li>
  <li><a href="#introdução" id="toc-introdução" class="nav-link" data-scroll-target="#introdução"><span class="header-section-number">10.3</span> Introdução</a></li>
  <li><a href="#estimativa-pontual-e-intervalo-de-confiança" id="toc-estimativa-pontual-e-intervalo-de-confiança" class="nav-link" data-scroll-target="#estimativa-pontual-e-intervalo-de-confiança"><span class="header-section-number">10.4</span> Estimativa Pontual e Intervalo de Confiança</a></li>
  <li><a href="#estimação-da-média-populacional-sigma-conhecido" id="toc-estimação-da-média-populacional-sigma-conhecido" class="nav-link" data-scroll-target="#estimação-da-média-populacional-sigma-conhecido"><span class="header-section-number">10.5</span> Estimação da média populacional: <span class="math inline">\(\sigma\)</span> conhecido</a>
  <ul class="collapse">
  <li><a href="#cálculo-do-intervalo-de-confiança-com-sigma-conhecido" id="toc-cálculo-do-intervalo-de-confiança-com-sigma-conhecido" class="nav-link" data-scroll-target="#cálculo-do-intervalo-de-confiança-com-sigma-conhecido"><span class="header-section-number">10.5.1</span> Cálculo do intervalo de confiança com <span class="math inline">\(\sigma\)</span> conhecido</a></li>
  <li><a href="#função-para-calcular-ic-com-sigma-conhecido" id="toc-função-para-calcular-ic-com-sigma-conhecido" class="nav-link" data-scroll-target="#função-para-calcular-ic-com-sigma-conhecido"><span class="header-section-number">10.5.2</span> Função para calcular IC com <span class="math inline">\(\sigma\)</span> conhecido</a></li>
  <li><a href="#interpretação-do-intervalo-de-confiança" id="toc-interpretação-do-intervalo-de-confiança" class="nav-link" data-scroll-target="#interpretação-do-intervalo-de-confiança"><span class="header-section-number">10.5.3</span> Interpretação do intervalo de confiança</a></li>
  </ul></li>
  <li><a href="#estimação-da-média-populacional-sigma-desconhecido" id="toc-estimação-da-média-populacional-sigma-desconhecido" class="nav-link" data-scroll-target="#estimação-da-média-populacional-sigma-desconhecido"><span class="header-section-number">10.6</span> Estimação da média populacional: <span class="math inline">\(\sigma\)</span> desconhecido</a>
  <ul class="collapse">
  <li><a href="#distribuição-t" id="toc-distribuição-t" class="nav-link" data-scroll-target="#distribuição-t"><span class="header-section-number">10.6.1</span> Distribuição <em>t</em></a></li>
  <li><a href="#cálculo-do-intervalo-de-confiança-com-sigma-desconhecido" id="toc-cálculo-do-intervalo-de-confiança-com-sigma-desconhecido" class="nav-link" data-scroll-target="#cálculo-do-intervalo-de-confiança-com-sigma-desconhecido"><span class="header-section-number">10.6.2</span> Cálculo do intervalo de confiança com <span class="math inline">\(\sigma\)</span> desconhecido</a></li>
  </ul></li>
  <li><a href="#intervalo-de-confiança-para-uma-proporção-populacional" id="toc-intervalo-de-confiança-para-uma-proporção-populacional" class="nav-link" data-scroll-target="#intervalo-de-confiança-para-uma-proporção-populacional"><span class="header-section-number">10.7</span> Intervalo de Confiança para uma proporção populacional</a>
  <ul class="collapse">
  <li><a href="#dados-para-estimar-a-proporção-populacional" id="toc-dados-para-estimar-a-proporção-populacional" class="nav-link" data-scroll-target="#dados-para-estimar-a-proporção-populacional"><span class="header-section-number">10.7.1</span> Dados para estimar a proporção populacional</a></li>
  <li><a href="#cálculo-da-estimativa-pontual-da-proporção" id="toc-cálculo-da-estimativa-pontual-da-proporção" class="nav-link" data-scroll-target="#cálculo-da-estimativa-pontual-da-proporção"><span class="header-section-number">10.7.2</span> Cálculo da estimativa pontual da proporção</a></li>
  <li><a href="#sec-ICproporcao" id="toc-sec-ICproporcao" class="nav-link" data-scroll-target="#sec-ICproporcao"><span class="header-section-number">10.7.3</span> Cálculo do intervalo de confiança para a proporção</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span id="sec-estimacao" class="quarto-section-identifier"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Estimação</span></span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="pacotes-necessários-neste-capítulo" class="level2" data-number="10.1">
<h2 data-number="10.1" class="anchored" data-anchor-id="pacotes-necessários-neste-capítulo"><span class="header-section-number">10.1</span> Pacotes necessários neste capítulo</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(DescTools, </span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>               dplyr,</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>               ggplot2, </span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>               kableExtra,</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>               knitr,</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>               readxl, </span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>               Rmisc, </span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>               tidyr)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="sec-dadoscap10" class="level2" data-number="10.2">
<h2 data-number="10.2" class="anchored" data-anchor-id="sec-dadoscap10"><span class="header-section-number">10.2</span> Dados</h2>
<p>Os dados deste capítulo são os mesmo usados no <a href="09-distAmostrais.html" class="quarto-xref"><span>Capítulo 9</span></a>, incluídos no arquivo <code>dadosMater.xlsx</code>, considerando apenas os recém-nascidos a termo e a variável <code>altura</code> e <code>pesoRN</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>dados <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">"dados/dadosMater.xlsx"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(ig<span class="sc">&gt;=</span><span class="dv">37</span> <span class="sc">&amp;</span> ig<span class="sc">&lt;</span><span class="dv">42</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(altura, pesoRN)</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(dados)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>tibble [1,085 × 2] (S3: tbl_df/tbl/data.frame)
 $ altura: num [1:1085] 1.5 1.55 1.6 1.58 1.76 1.63 1.54 1.55 1.56 1.51 ...
 $ pesoRN: num [1:1085] 3285 3100 3100 2800 3270 ...</code></pre>
</div>
</div>
</section>
<section id="introdução" class="level2" data-number="10.3">
<h2 data-number="10.3" class="anchored" data-anchor-id="introdução"><span class="header-section-number">10.3</span> Introdução</h2>
<p>A estatística inferencial é a parte da estatística que usa os resultados da amostra para tomar decisões e tirar conclusões sobre a população de onde a amostra foi retirada. A estimação e o teste de hipóteses, tomados em conjunto, constituem a <strong>inferência estatística</strong>.</p>
<p><em>Estimação</em> é um procedimento pelo qual um valor ou valores numéricos são atribuídos a um parâmetro populacional com base nas informações de uma amostra. Na estatística inferencial, <span class="math inline">\(\mu\)</span> é chamada de média populacional e <em>p</em> é chamada de proporção populacional. Existem muitos outros parâmetros populacionais, como mediana, moda, variância e desvio padrão, como observado na <a href="09-distAmostrais.html#sec-dam" class="quarto-xref"><span>Seção 9.2.2</span></a>.</p>
<p>Se houvesse possibilidade de realizar um <em>censo</em> (pesquisa incluindo toda a população de interesse), não haveria necessidade dos procedimentos de estimação. Seria equivalente ao que ocorre em uma eleição, basta contar os votos, para declarar os vencedores da eleição. No entanto, em saúde, realizar censo é um procedimento caro, demorado ou virtualmente impossível. Portanto, geralmente é utilizada uma amostra da população e calculada o valor das estatísticas da amostra apropriada. Baseado nessas estatísticas, é atribuído valores ao parâmetro.</p>
<p>A estatística usada para estimar um parâmetro é chamada de estimador. Assim, a média da amostra, <span class="math inline">\(\bar{x}\)</span>, é um estimador da média da população, <span class="math inline">\(\mu\)</span>; e a proporção da amostra, <span class="math inline">\(\hat{p}\)</span>, é um estimador da proporção da população, <em>p</em>. Estimativa é um valor que a função estimador assume.</p>
</section>
<section id="estimativa-pontual-e-intervalo-de-confiança" class="level2" data-number="10.4">
<h2 data-number="10.4" class="anchored" data-anchor-id="estimativa-pontual-e-intervalo-de-confiança"><span class="header-section-number">10.4</span> Estimativa Pontual e Intervalo de Confiança</h2>
<p>A partir do <em>dataframe</em> <code>dados</code>, serão calculados a média e o desvio padrão da variável <code>pesoRN</code> (peso dos recém-nascidos em g) que, para fins didáticos, serão considerados os parâmetros dessa “população”:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a> mu <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">mean</span>(dados<span class="sc">$</span>pesoRN, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a> sigma <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">sd</span>(dados<span class="sc">$</span>pesoRN, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a> <span class="fu">print</span>(<span class="at">x =</span> <span class="fu">c</span>(mu, sigma))</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 3216  462</code></pre>
</div>
</div>
<p>A seguir, será extraída, dessa população, uma amostra de <em>n</em> = 30 <a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a> e calculado os mesmas medidas resumidoras, que se constituirão nas estimativas da <code>amostra</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span> (<span class="dv">1234</span>)</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>amostra <span class="ot">&lt;-</span> dados <span class="sc">%&gt;%</span> <span class="fu">slice_sample</span>(<span class="at">n =</span> <span class="dv">30</span>)</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Média amostral</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>x_barra <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">mean</span>(amostra<span class="sc">$</span>pesoRN, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Desvio padrão amostral  </span></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>s <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">sd</span>(amostra<span class="sc">$</span>pesoRN, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">c</span>(x_barra, s))</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 3222  407</code></pre>
</div>
</div>
<p>O valor de 3222g é a média amostral, <span class="math inline">\(\bar{x}\)</span>, usado como um estimativa da <span class="math inline">\(\mu\)</span>, é denominado de <strong>estimativa pontual</strong>. Como já mencionado anteriormente, espera-se que cada amostra selecionada produza um valor diferente da estatística amostral. Assim, o valor atribuído a uma média populacional, <span class="math inline">\(\mu\)</span>, com base em uma estimativa pontual depende de qual das amostras está sendo usada. Consequentemente, a estimativa pontual atribui um valor a <span class="math inline">\(\mu\)</span> que quase sempre difere da mesma.</p>
<p>Para melhorar a precisão, usa-se uma estimativa de intervalo. Em vez de atribuir um único valor para o parâmetro populacional, é construído um intervalo, acrescentando ou subtraindo um valor, chamado de <strong>margem de erro</strong>, à estimativa pontual.</p>
<p>Este procedimento é conhecido como <em>estimação por intervalo</em> e o intervalo construído, estabelecendo um limite inferior e um limite superior em torno da estimativa amostral, é denominado de <strong>intervalo de confiança</strong>. Desta forma, é possível afirmar que o intervalo de confiança, provavelmente, contém o parâmetro populacional correspondente (<a href="#fig-intconf" class="quarto-xref">Figura&nbsp;<span>10.1</span></a>).</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-intconf" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" data-fig-pos="H">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-intconf-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="https://i.imgur.com/oAGF5Xs.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:70.0%" data-fig-pos="H">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-intconf-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figura&nbsp;10.1: Intervalo de Confiança.
</figcaption>
</figure>
</div>
</div>
</div>
<p>A construção do intervalo de confiança depende da obtenção da margem de erro. Este processo necessita de dois fatores:</p>
<ul>
<li>do <em>desvio padrão da distribuição amostral</em>, <span class="math inline">\(\sigma_{\bar{x}}=\frac{\sigma }{\sqrt{n}}\)</span>, que em decorrência do Teorema do Limite Central, pode ser escrito <span class="math inline">\(EP_{\bar{x}}=\frac{s}{\sqrt{n}}\)</span>;</li>
<li>do <em>nível de confiança</em> (NC) atribuído ao intervalo.</li>
</ul>
<p>Primeiro, quanto maior for o desvio padrão de <span class="math inline">\(\bar{x}\)</span>, maior será a margem de erro subtraída e adicionada à estimativa pontual. Consequentemente, o intervalo de confiança se modifica de acordo com a margem de erro. Quanto maior a margem de erro mais amplo o intervalo de confiança.</p>
<p>Em segundo lugar, a quantidade subtraída e adicionada à estimativa se modifica de acordo o <em>nível de confiança</em>. Para ter uma maior confiança, deve-se aumentar a margem de erro, de acordo com a probabilidade declarada. Quanto maior o nível de confiança, maior a probabilidade. O nível de confiança é mostrado como <span class="math inline">\((1 - \alpha) \times 100\)</span>%, onde <span class="math inline">\(\alpha\)</span> é o <strong>nível de significância</strong>. Tradicionalmente, o valor de <span class="math inline">\(\alpha\)</span> é igual a 0,05, mas qualquer outro valor pode ser usado.</p>
</section>
<section id="estimação-da-média-populacional-sigma-conhecido" class="level2" data-number="10.5">
<h2 data-number="10.5" class="anchored" data-anchor-id="estimação-da-média-populacional-sigma-conhecido"><span class="header-section-number">10.5</span> Estimação da média populacional: <span class="math inline">\(\sigma\)</span> conhecido</h2>
<p>A <em>margem de erro</em> para a estimativa da média populacional, <span class="math inline">\(\mu\)</span>, quando se conhece o desvio padrão populacional,<span class="math inline">\(\sigma\)</span>, e <span class="math inline">\(n \ge 30\)</span> ou, mesmo que <span class="math inline">\(n &lt; 30\)</span>, mas a população de onde amostra foi selecionada tem distribuição normal, é a quantidade que é subtraída ou adicionada ao valor da média da amostra, <span class="math inline">\(\bar{x}\)</span>, para obter o intervalo de confiança para <span class="math inline">\(\mu\)</span>. Desta forma, a margem de erro é igual a:</p>
<p><span class="math display">\[
margem \quad de\quad erro\quad(me)= z_{(1-\frac{\alpha}{2})} \times \sigma_{\bar{x}}
\]</span></p>
<p>Ou,</p>
<p><span class="math display">\[
me = z_{(1-\frac{\alpha}{2})} \times \frac{\sigma }{\sqrt{n}}
\]</span></p>
<p>Logo, o intervalo de confiança para a média populacional, <span class="math inline">\(\mu\)</span>, para um nível de confiança (1 - <span class="math inline">\(\alpha \times 100\)</span>)%, é igual a:</p>
<p><span class="math display">\[
IC_{(1-\alpha)}(\mu) \rightarrow  \bar{x} \pm  me
\]</span></p>
<p>Se objetivo é construir um intervalo de confiança de 95%, a última equação passa a ser:</p>
<p><span class="math display">\[
IC_{(1-\alpha)}(\mu) \rightarrow  \bar{x} \pm  z_{(0,975)} \times me
\]</span></p>
<p>Onde <em>Z</em> é o valor crítico para o nível de confiança escolhido, obtido da tabela de distribuição normal padrão, e <em>me</em> é a margem de erro (<span class="math inline">\(z_{0,975} \times erro \quad padrao\)</span>). Um intervalo de confiança de 95% significa que a área total sob a curva normal entre dois pontos em torno da média populacional, <span class="math inline">\(\mu\)</span>, é igual a 95%, ou 0,95. A área das caudas é <span class="math inline">\(\alpha\)</span>, ou seja, cada cauda á igual a <span class="math inline">\(\frac{\alpha}{2}\)</span> (<a href="#fig-twotailed" class="quarto-xref">Figura&nbsp;<span>10.2</span></a>)).</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-twotailed" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" data-fig-pos="H">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-twotailed-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="https://i.imgur.com/q6Duexo.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:70.0%" data-fig-pos="H">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-twotailed-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figura&nbsp;10.2: Intervalo de Confiança de 95%.
</figcaption>
</figure>
</div>
</div>
</div>
<p>Para encontrar o valor de <em>Z</em> para um nível de confiança de 95%, primeiro encontram-se as áreas à esquerda desses dois pontos, <span class="math inline">\(z_1\)</span> e <span class="math inline">\(z_2\)</span>. Esses dois valores de <em>Z</em> serão iguais, mas com sinais opostos. A área total sob a curva é igual a 1. A área entre <span class="math inline">\(z_1\)</span> e <span class="math inline">\(z_2\)</span> é igual a <span class="math inline">\(1 - \alpha = 0,95\)</span>.</p>
<p>A área a esquerda de <span class="math inline">\(z_1\)</span> é igual a 0,025 e a área a esquerda de <span class="math inline">\(z_2\)</span> é igual a 1 – 0,025 = 0,975. No <em>R</em>, os valores <span class="math inline">\(z_1\)</span> e <span class="math inline">\(z_2\)</span> podem facilmente ser obtidos com a função <code>qnorm()</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">c</span>(<span class="fu">qnorm</span>(<span class="fl">0.025</span>),<span class="fu">qnorm</span>(<span class="fl">0.975</span>)), <span class="dv">3</span>)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -1.96  1.96</code></pre>
</div>
</div>
<p>Dessa maneira, para uma confiança de 95%, é usado um <span class="math inline">\(Z = 1.96\)</span>, onde:</p>
<p><span class="math display">\[
p(-1,96 \le z \le 1,96) = 0,95
\]</span> Logo,</p>
<p><span class="math display">\[
IC_{95\%}(\mu) \rightarrow  \bar{x} \pm  (1.96 \times \sigma_{\bar{x}})
\]</span> ou</p>
<p><span class="math display">\[
IC_{95\%}(\mu) \rightarrow  \bar{x} \pm  (1.96 \times \frac{\sigma}{\sqrt{n}})
\]</span></p>
<section id="cálculo-do-intervalo-de-confiança-com-sigma-conhecido" class="level3" data-number="10.5.1">
<h3 data-number="10.5.1" class="anchored" data-anchor-id="cálculo-do-intervalo-de-confiança-com-sigma-conhecido"><span class="header-section-number">10.5.1</span> Cálculo do intervalo de confiança com <span class="math inline">\(\sigma\)</span> conhecido</h3>
<p>Usando a média dos pesos dos recém-nascidos da amostra (<em>n</em> = 30), <span class="math inline">\(\bar{x}\)</span>= 3222 g, e o desvio padrão populacional conhecido, <span class="math inline">\(\sigma\)</span>= 462 g, tem-se que o intervalo de confiança de 95% (IC95%), para o peso dos recém-nascidos a termo na ‘população’ de onde esta amostra é proveniente:</p>
<p><u>Dados do exemplo para o cálculo</u></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a> n <span class="ot">&lt;-</span> <span class="dv">30</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a> x_barra <span class="ot">&lt;-</span> <span class="dv">3222</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a> sigma <span class="ot">&lt;-</span> <span class="dv">462</span></span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Com 95% de confiança a margem de erro é igual a 1,96 vezes o erro padrão da média:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a> n <span class="ot">&lt;-</span> <span class="dv">30</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a> me <span class="ot">&lt;-</span> <span class="fl">1.96</span> <span class="sc">*</span> sigma<span class="sc">/</span><span class="fu">sqrt</span>(n)</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a> <span class="fu">round</span>(me,<span class="dv">2</span>)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 165.32</code></pre>
</div>
</div>
<p>Basta, agora, adicionar e subtrair a margem de erro da média:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a> lim_inf <span class="ot">&lt;-</span> x_barra <span class="sc">-</span> me</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a> lim_sup <span class="ot">&lt;-</span> x_barra <span class="sc">+</span> me</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a> ic95 <span class="ot">&lt;-</span> <span class="fu">c</span>(lim_inf, lim_sup)</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a> <span class="fu">round</span>(ic95, <span class="dv">1</span>)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 3056.7 3387.3</code></pre>
</div>
</div>
<p>Assim, tem-se uma confiança de 95% de que a verdadeira média, esteja incluída no intervalo. O nome para isso é <em>intervalo de confiança de 95% para a média populacional</em>.</p>
</section>
<section id="função-para-calcular-ic-com-sigma-conhecido" class="level3" data-number="10.5.2">
<h3 data-number="10.5.2" class="anchored" data-anchor-id="função-para-calcular-ic-com-sigma-conhecido"><span class="header-section-number">10.5.2</span> Função para calcular IC com <span class="math inline">\(\sigma\)</span> conhecido</h3>
<p>O cálculo manual é simples, mas enfadonho, nos tempos dos computadores. Em decorrência, como o <em>R</em> não tem uma função para encontrar os intervalos de confiança para a média de dados com distribuição normal quando o desvio padrão da população é conhecido, foi criada uma função para cumprir essa ação. Ela necessita dos seguintes argumentos:</p>
<ul>
<li><strong>x</strong> <span class="math inline">\(\to\)</span> conjunto de números da amostra</li>
<li><strong>s</strong> <span class="math inline">\(\to\)</span> desvio padrão populacional</li>
<li><strong>nc</strong> <span class="math inline">\(\to\)</span> nível de confiança. Padrão: nc = 0.95</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>IC_z <span class="ot">&lt;-</span> <span class="cf">function</span> (x, s, <span class="at">nc =</span> <span class="fl">0.975</span>)</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>  <span class="st">`</span><span class="at">%&gt;%</span><span class="st">`</span> <span class="ot">&lt;-</span> dplyr<span class="sc">::</span><span class="st">`</span><span class="at">%&gt;%</span><span class="st">`</span></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>   n <span class="ot">&lt;-</span> <span class="fu">length</span>(x)</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>   me <span class="ot">&lt;-</span> <span class="fu">abs</span>(<span class="fu">qnorm</span>((<span class="dv">1</span><span class="sc">-</span>nc)<span class="sc">/</span><span class="dv">2</span>))<span class="sc">*</span> sigma<span class="sc">/</span><span class="fu">sqrt</span>(n)</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>   df_out <span class="ot">&lt;-</span> <span class="fu">data.frame</span>( <span class="at">tamanho_amostral =</span> n, </span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>                         <span class="at">media_amostral =</span> <span class="fu">mean</span>(x), </span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>                         <span class="at">margem_erro =</span> me,</span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>                         <span class="st">'IC limite inferior'</span><span class="ot">=</span>(<span class="fu">mean</span>(x) <span class="sc">-</span> me),</span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a>                         <span class="st">'IC limite superior'</span><span class="ot">=</span>(<span class="fu">mean</span>(x) <span class="sc">+</span> me)) <span class="sc">%&gt;%</span></span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a>    tidyr<span class="sc">::</span><span class="fu">pivot_longer</span>(<span class="at">names_to =</span> <span class="st">"Medidas"</span>, <span class="at">values_to =</span><span class="st">"valores"</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span> )</span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(df_out)</span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">IC_z</span>(<span class="at">x =</span> amostra<span class="sc">$</span>pesoRN, <span class="at">s =</span> sigma, <span class="at">nc =</span> <span class="fl">0.95</span>)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 5 × 2
  Medidas            valores
  &lt;chr&gt;                &lt;dbl&gt;
1 tamanho_amostral       30 
2 media_amostral       3222.
3 margem_erro           165.
4 IC.limite.inferior   3056.
5 IC.limite.superior   3387.</code></pre>
</div>
</div>
<p>Essa função pode ser salva no seu diretório e, quando necessária, pode ser ativada com a função <code>source()</code>, como visto na <a href="04-ambienteR.html#sec-funcpropria" class="quarto-xref"><span>Seção 4.8.1</span></a>. Com essa função fica fácil alterar o nível de confiança, por exemplo, para 99%. Isso mudará o <em>Z</em> crítico para:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a> alpha <span class="ot">&lt;-</span> <span class="fl">0.01</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a> p <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">-</span>(alpha<span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a> p</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.995</code></pre>
</div>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a> z_critico <span class="ot">&lt;-</span> <span class="fu">qnorm</span>(p)</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a> <span class="fu">round</span>(z_critico, <span class="dv">2</span>)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 2.58</code></pre>
</div>
</div>
<p>Com a função <code>IC_z()</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="fu">IC_z</span>(<span class="at">x =</span> amostra<span class="sc">$</span>pesoRN, <span class="at">s =</span> sigma, <span class="at">nc =</span> <span class="fl">0.995</span>)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 5 × 2
  Medidas            valores
  &lt;chr&gt;                &lt;dbl&gt;
1 tamanho_amostral       30 
2 media_amostral       3222.
3 margem_erro           237.
4 IC.limite.inferior   2985.
5 IC.limite.superior   3458.</code></pre>
</div>
</div>
<p>Observando o IC95% e o IC99%, verifica-se que a amplitude do intervalo aumentou com o crescimento da confiança de 95% para 99%, porque houve um aumento na margem de erro (<a href="#fig-IC9599" class="quarto-xref">Figura&nbsp;<span>10.3</span></a>).</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-IC9599" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" data-fig-pos="H">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-IC9599-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="https://i.imgur.com/vaPrkze.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:70.0%" data-fig-pos="H">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-IC9599-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figura&nbsp;10.3: Comparação do IC95% e IC99%.
</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="interpretação-do-intervalo-de-confiança" class="level3" data-number="10.5.3">
<h3 data-number="10.5.3" class="anchored" data-anchor-id="interpretação-do-intervalo-de-confiança"><span class="header-section-number">10.5.3</span> Interpretação do intervalo de confiança</h3>
<p>Se fossem extraídas todas as possíveis amostras de <em>n</em> = 30 da população de recém-nascidos a termo e construído para cada uma delas um intervalo de confiança de 95% em torno de cada média amostral, espera-se que 95% desses intervalos incluirão a média populacional e 5% não incluirão.<br>
O IC95% informa sobre a <em>precisão</em> com que a média amostral estima a média populacional desconhecida <a href="#fn2" class="footnote-ref" id="fnref2" role="doc-noteref"><sup>2</sup></a>.</p>
<p>Na <a href="#fig-vinte" class="quarto-xref">Figura&nbsp;<span>10.4</span></a>, são mostradas 20 amostras diferentes de tamanho <em>n</em> = 30, dessa população. Junto aparecem os intervalos de confiança de 95% construídos em torno dessas amostras. Observa-se que apenas uma amostra (em vermelho) não inclui a média populacional (linha tracejada vertical em azul). Pode-se afirmar com 95% de confiança que se forem extraídas muitas amostras do mesmo tamanho de uma população e construído intervalos de confiança de 95% em torno das médias dessas amostras, 95% desses intervalos de confiança incluirão a média populacional.</p>
<div class="cell" data-fig.out="75%">
<div class="cell-output-display">
<div id="fig-vinte" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-vinte-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="10-estimacao_files/figure-html/fig-vinte-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-vinte-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figura&nbsp;10.4: Intervalos de confiança de 95% que mostra 20 replicações simuladas de amostras de n = 30 do peso do recém-nascido. Apenas um intervalo (em vermelho) não inclui a média populacional (linha vertical azul).
</figcaption>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="estimação-da-média-populacional-sigma-desconhecido" class="level2" data-number="10.6">
<h2 data-number="10.6" class="anchored" data-anchor-id="estimação-da-média-populacional-sigma-desconhecido"><span class="header-section-number">10.6</span> Estimação da média populacional: <span class="math inline">\(\sigma\)</span> desconhecido</h2>
<p>Com amostras pequenas, usar o modelo normal para construir intervalos de confiança, pode gerar um erro, pois os pressupostos do teorema do limite central não são respeitados. Quando o desvio padrão populacional, <span class="math inline">\(\sigma\)</span>, é desconhecido e o tamanho amostral é pequeno (&lt; 30), a estimação da média populacional é feita usando a <strong>distribuição t</strong>.</p>
<section id="distribuição-t" class="level3" data-number="10.6.1">
<h3 data-number="10.6.1" class="anchored" data-anchor-id="distribuição-t"><span class="header-section-number">10.6.1</span> Distribuição <em>t</em></h3>
<p>A distribuição <em>t</em>, desenvolvida por <em>William Sealy Gosset</em>, em 1908, é semelhante à distribuição normal. Como a curva de distribuição normal, a curva de distribuição <em>t</em> é unimodal, simétrica (em forma de sino) em torno da média e nunca encontra o eixo horizontal. A área total sob uma curva de distribuição <em>t</em> é 1 ou 100%. A curva da distribuição <em>t</em> é mais plana do que a curva de distribuição normal padrão. Em outras palavras, ela é mais achatada e mais espalhada. No entanto, conforme o tamanho da amostra aumenta, a distribuição <em>t</em> aproxima-se da distribuição normal padrão.</p>
<p>O formato de uma curva de distribuição <em>t</em> particular depende do número de graus de liberdade. O número de graus de liberdade (<em>gl</em>) para uma distribuição <em>t</em> é igual ao tamanho da amostra menos um, ou seja, <span class="math inline">\(gl=n-1\)</span>, veja <a href="06-descrevendoDados.html#sec-variancia" class="quarto-xref"><span>Seção 6.3.4.3</span></a>.</p>
<p>O número de graus de liberdade é o único parâmetro da distribuição <em>t</em>. Há uma diferente distribuição <em>t</em> para cada número de graus de liberdade, portanto, a distribuição <em>t</em> se constitui em uma família de distribuições (<a href="#fig-familia" class="quarto-xref">Figura&nbsp;<span>10.5</span></a>).</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-familia" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" data-fig-pos="H">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-familia-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="10-estimacao_files/figure-html/fig-familia-1.png" class="quarto-figure quarto-figure-center figure-img" style="width:80.0%;height:80.0%" data-fig-pos="H">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-familia-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figura&nbsp;10.5: Curvas de distribuição t conforme o grau de liberdade comparadas à distribuição normal.
</figcaption>
</figure>
</div>
</div>
</div>
<p>Da mesma maneira que a distribuição normal padrão, a média da distribuição padrão <em>t</em> é 0. Entretanto, ao contrário da distribuição normal padrão, cujo desvio padrão é 1, o desvio padrão de uma distribuição <em>t</em> é <span class="math inline">\(\sqrt{\frac{gl}{gl-2}}\)</span> , para <em>gl</em> &gt; 2, sempre é maior do que 1. Assim, o desvio padrão de uma distribuição <em>t</em> é maior do que o desvio padrão da distribuição normal padrão.<br>
Os valores de <span class="math inline">\({t}_{crítico}\)</span> podem ser obtidos usando a função <code>qt()</code> que usa os seguintes argumentos:</p>
<ul>
<li><strong>p</strong> <span class="math inline">\(\to\)</span> probabilidade, igual a <span class="math inline">\(1 - \frac{\alpha}{2}\)</span>, considerando-se bicaudal e <span class="math inline">\(1 - \alpha\)</span> quando unicaudal;</li>
<li><strong>df</strong> <span class="math inline">\(\to\)</span> graus de liberdade;</li>
<li><strong>lower.tail</strong> <span class="math inline">\(\to\)</span> lógico; se TRUE, informa a probabilidade da cauda inferior. O padrão é TRUE.</li>
</ul>
<p>Assim, o valor do <span class="math inline">\({t}_{crítico}\)</span> para <span class="math inline">\(gl=10\)</span> é:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>alpha  <span class="ot">&lt;-</span>  <span class="fl">0.05</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> (alpha<span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>gl <span class="ot">=</span> <span class="dv">10</span></span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>t <span class="ot">&lt;-</span> <span class="fu">qt</span>(<span class="at">p =</span> p, <span class="at">df =</span> <span class="dv">10</span>, <span class="at">lower.tail =</span> <span class="cn">TRUE</span>)</span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(t, <span class="at">digits =</span> <span class="dv">2</span>)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 2.23</code></pre>
</div>
</div>
<p>A área compreendida entre <span class="math inline">\(\pm\)</span> 2.23$ é igual a 95% (<a href="#fig-bilateral" class="quarto-xref">Figura&nbsp;<span>10.6</span></a>):</p>
<p><span class="math display">\[
p(-2,23\le t\le 2,23)=0,95
\]</span></p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-bilateral" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" data-fig-pos="H">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-bilateral-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="10-estimacao_files/figure-html/fig-bilateral-1.png" class="quarto-figure quarto-figure-center figure-img" style="width:70.0%;height:70.0%" data-fig-pos="H">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-bilateral-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figura&nbsp;10.6: Distribuição t com gl = 10, bilateral.
</figcaption>
</figure>
</div>
</div>
</div>
<p>Quando se considera apenas uma das caudas (unicaudal ou unilateral), o valor do <span class="math inline">\({t}_{crítico}\)</span> para <span class="math inline">\(gl=10\)</span> é</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>t1 <span class="ot">&lt;-</span> <span class="fu">qt</span>(<span class="at">p =</span> <span class="fl">0.95</span>, <span class="at">df =</span> <span class="dv">10</span>, <span class="at">lower.tail =</span> <span class="cn">TRUE</span>)</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(t1, <span class="at">digits =</span> <span class="dv">2</span>)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1.81</code></pre>
</div>
</div>
<p>Assim, a área abaixo de 1.81 é igual a 95% (<a href="#fig-unilateral" class="quarto-xref">Figura&nbsp;<span>10.7</span></a>).</p>
<p><span class="math display">\[
p(t\le 1,81)=0,95
\]</span></p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-unilateral" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" data-fig-pos="H">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-unilateral-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="10-estimacao_files/figure-html/fig-unilateral-1.png" class="quarto-figure quarto-figure-center figure-img" style="width:70.0%;height:70.0%" data-fig-pos="H">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-unilateral-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figura&nbsp;10.7: Distribuição t com gl = 10, unilateral.
</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="cálculo-do-intervalo-de-confiança-com-sigma-desconhecido" class="level3" data-number="10.6.2">
<h3 data-number="10.6.2" class="anchored" data-anchor-id="cálculo-do-intervalo-de-confiança-com-sigma-desconhecido"><span class="header-section-number">10.6.2</span> Cálculo do intervalo de confiança com <span class="math inline">\(\sigma\)</span> desconhecido</h3>
<p>Serão utilizados nesta seção, os dados da altura de mulheres, obtidos na <a href="#sec-dadoscap10" class="quarto-xref"><span>Seção 10.2</span></a>. Suponha-se que os parâmetros sejam desconhecidos. Para estimar esses parâmetros, selecionou-se uma amostra de n = 30 desse conjunto dados. Tomando essa amostra, calcula-se a sua média e o seu desvio padrão:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2345</span>)</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>amostra1 <span class="ot">&lt;-</span> dados <span class="sc">%&gt;%</span></span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_sample</span>(<span class="at">n =</span> <span class="dv">30</span>)</span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>x_barra1 <span class="ot">&lt;-</span> <span class="fu">mean</span>(amostra1<span class="sc">$</span>altura, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a>s1 <span class="ot">&lt;-</span> <span class="fu">sd</span>(amostra1<span class="sc">$</span>altura, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">round</span>(<span class="fu">c</span>(x_barra1, s1),<span class="dv">3</span>))</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1.577 0.062</code></pre>
</div>
</div>
<p>A maneira mais intuitiva de estimar a média da população com base na amostra, é, simplesmente, calcular a média e o desvio padrão. Entretanto, para uma maior precisão, é sempre importante calcular o intervalo de confiança.</p>
<section id="cálculo-manual-do-ic" class="level4" data-number="10.6.2.1">
<h4 data-number="10.6.2.1" class="anchored" data-anchor-id="cálculo-manual-do-ic"><span class="header-section-number">10.6.2.1</span> Cálculo manual do IC</h4>
<p>Quando o desvio padrão da população (<span class="math inline">\(\sigma\)</span>) não é conhecido, pode-se usar o seu estimador que é o desvio padrão da amostra (<em>s</em>), respeitando os pressupostos <span class="citation" data-cites="motulsky2010ci">(<a href="references.html#ref-motulsky2010ci" role="doc-biblioref">1</a>)</span>. Então, o erro padrão da média (<span class="math inline">\(\sigma_{\bar{x}}\)</span>) pode ser estimado pelo <span class="math inline">\(EP_{\bar{x}}\)</span>.</p>
<p><span class="math display">\[
EP_{\bar{x}}=\frac{s}{\sqrt{n}}
\]</span></p>
<p>O intervalo de confiança para a <span class="math inline">\(\mu\)</span> para um nível de confiança (<em>NC</em>) de <span class="math inline">\((1 – \alpha) \times100\)</span>% é igual a:</p>
<p><span class="math display">\[
IC_{NC}(\mu)\rightarrow x\pm (t_{({1-\frac{alpha}{2})} } \times \frac {s}{\sqrt{n}})
\]</span></p>
<p>Quando o tamanho amostral é grande, o valor de <em>t</em> se aproxima do valor de <em>z</em>, portanto, em situações em que não se conhece o desvio padrão populacional, não há muita diferença se houver uma aproximação de <em>t</em> para <em>z</em> (<a href="#tbl-tabtz" class="quarto-xref">Tabela&nbsp;<span>10.1</span></a>).</p>
<div class="cell">
<div id="tbl-tabtz" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-tabtz-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Tabela&nbsp;10.1: Comparação dos valores z e t(gl).
</figcaption>
<div aria-describedby="tbl-tabtz-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<div style="border: 1px solid #ddd; padding: 5px; overflow-x: scroll; width:600px; ">
<table class="table table-striped table-hover table-condensed do-not-create-environment cell caption-top table-sm small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th" style="text-align: left; font-weight: bold;">z</th>
<th data-quarto-table-cell-role="th" style="text-align: right; font-weight: bold;">n</th>
<th data-quarto-table-cell-role="th" style="text-align: right; font-weight: bold;">gl</th>
<th data-quarto-table-cell-role="th" style="text-align: right; font-weight: bold;">t</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left; width: 2.5cm;">1,96</td>
<td style="text-align: right; width: 2cm;">5</td>
<td style="text-align: right; width: 2cm;">4</td>
<td style="text-align: right; width: 2cm;">2,57</td>
</tr>
<tr class="even">
<td style="text-align: left; width: 2.5cm;">1,96</td>
<td style="text-align: right; width: 2cm;">10</td>
<td style="text-align: right; width: 2cm;">9</td>
<td style="text-align: right; width: 2cm;">2,23</td>
</tr>
<tr class="odd">
<td style="text-align: left; width: 2.5cm;">1,96</td>
<td style="text-align: right; width: 2cm;">30</td>
<td style="text-align: right; width: 2cm;">29</td>
<td style="text-align: right; width: 2cm;">2,04</td>
</tr>
<tr class="even">
<td style="text-align: left; width: 2.5cm;">1,96</td>
<td style="text-align: right; width: 2cm;">50</td>
<td style="text-align: right; width: 2cm;">49</td>
<td style="text-align: right; width: 2cm;">2,01</td>
</tr>
<tr class="odd">
<td style="text-align: left; width: 2.5cm;">1,96</td>
<td style="text-align: right; width: 2cm;">100</td>
<td style="text-align: right; width: 2cm;">99</td>
<td style="text-align: right; width: 2cm;">1,98</td>
</tr>
<tr class="even">
<td style="text-align: left; width: 2.5cm;">1,96</td>
<td style="text-align: right; width: 2cm;">200</td>
<td style="text-align: right; width: 2cm;">199</td>
<td style="text-align: right; width: 2cm;">1,97</td>
</tr>
<tr class="odd">
<td style="text-align: left; width: 2.5cm;">1,96</td>
<td style="text-align: right; width: 2cm;">500</td>
<td style="text-align: right; width: 2cm;">499</td>
<td style="text-align: right; width: 2cm;">1,96</td>
</tr>
<tr class="even">
<td style="text-align: left; width: 2.5cm;">1,96</td>
<td style="text-align: right; width: 2cm;">1000</td>
<td style="text-align: right; width: 2cm;">999</td>
<td style="text-align: right; width: 2cm;">1,96</td>
</tr>
</tbody>
</table>
</div>

</div>
</div>
</figure>
</div>
</div>
<p>A <code>amostra1</code> de <em>n</em> = 30, <span class="math inline">\(\overline x\)</span> = 1.577m e <span class="math inline">\(s\)</span> = 0.062m. Essas estimativas servirão para o cálculo do intervalo de confiança, usando uma distribuição t bicaudal e um nível de significância <span class="math inline">\(\alpha = 0,05\)</span>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>n1 <span class="ot">&lt;-</span>  <span class="fu">length</span>(amostra1<span class="sc">$</span>altura)</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> <span class="fl">0.05</span></span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> alpha<span class="sc">/</span><span class="dv">2</span></span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Graus de liberdade  </span></span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>gl <span class="ot">&lt;-</span> n1 <span class="sc">-</span> <span class="dv">1</span></span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Valor t crítico  </span></span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a>tc <span class="ot">&lt;-</span>  <span class="fu">qt</span>(p, gl, <span class="at">lower.tail =</span> <span class="cn">TRUE</span>)</span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Erro padrão</span></span>
<span id="cb30-9"><a href="#cb30-9" aria-hidden="true" tabindex="-1"></a>EP1 <span class="ot">&lt;-</span> <span class="fu">round</span>(s1<span class="sc">/</span><span class="fu">sqrt</span>(n1),<span class="dv">3</span>)</span>
<span id="cb30-10"><a href="#cb30-10" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">round</span>(<span class="fu">c</span>(tc, EP1),<span class="dv">3</span>))</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 2.045 0.011</code></pre>
</div>
</div>
<p>Com esses dados, calcula-se o intervalo de confiança de 95%:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>me1 <span class="ot">&lt;-</span> tc<span class="sc">*</span>EP1</span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>lim_inf <span class="ot">&lt;-</span> x_barra1 <span class="sc">-</span> me1</span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>lim_sup <span class="ot">&lt;-</span> x_barra1 <span class="sc">+</span> me1</span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>ic95 <span class="ot">&lt;-</span> <span class="fu">c</span>(lim_inf, lim_sup)</span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(ic95, <span class="dv">2</span>)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1.55 1.60</code></pre>
</div>
</div>
</section>
<section id="cálculo-usando-uma-função-do-r" class="level4" data-number="10.6.2.2">
<h4 data-number="10.6.2.2" class="anchored" data-anchor-id="cálculo-usando-uma-função-do-r"><span class="header-section-number">10.6.2.2</span> Cálculo usando uma função do R</h4>
<p>O R possui algumas funções que calculam o intervalo de confiança para variáveis numéricas, baseadas na distribuição <em>t</em>. Entre elas, a função <code>CI()</code>, incluída no pacote <code>Rmisc</code>. Esta função tem dois argumentos:</p>
<ul>
<li><strong>x</strong> ⟶ vetor de dados;</li>
<li><strong>ci</strong> ⟶ intervalo de confiança a ser calculado</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>IC95 <span class="ot">&lt;-</span> <span class="fu">CI</span>(amostra1<span class="sc">$</span>altura, <span class="at">ci =</span> <span class="fl">0.95</span>)</span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(IC95, <span class="dv">2</span>)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>upper  mean lower 
 1.60  1.58  1.55 </code></pre>
</div>
</div>
</section>
</section>
</section>
<section id="intervalo-de-confiança-para-uma-proporção-populacional" class="level2" data-number="10.7">
<h2 data-number="10.7" class="anchored" data-anchor-id="intervalo-de-confiança-para-uma-proporção-populacional"><span class="header-section-number">10.7</span> Intervalo de Confiança para uma proporção populacional</h2>
<section id="dados-para-estimar-a-proporção-populacional" class="level3" data-number="10.7.1">
<h3 data-number="10.7.1" class="anchored" data-anchor-id="dados-para-estimar-a-proporção-populacional"><span class="header-section-number">10.7.1</span> Dados para estimar a proporção populacional</h3>
<p>Aqui, será utilizada uma amostra aleatória de <em>n</em> = 60 do conjunto de dados <code>dadosMater.xlsx</code> (sem filtro para os recém-nascidos a termo) para estimar a proporção de mulheres fumantes.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2346</span>)</span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>dados <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">"dados/dadosMater.xlsx"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span> (fumo) <span class="sc">%&gt;%</span> </span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_sample</span>(<span class="at">n =</span> <span class="dv">60</span>)</span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(dados)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>tibble [60 × 1] (S3: tbl_df/tbl/data.frame)
 $ fumo: num [1:60] 2 2 1 2 2 2 2 2 2 1 ...</code></pre>
</div>
</div>
<p>A seleção mostra que temos 60 observações da variável <code>fumo</code> e que a mesma está classificada como numérica (<em>num</em>), 1 e 2. Onde 1 representa as mulheres fumantes. A variável é categórica e deve ser transformada para fator.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>dados<span class="sc">$</span>fumo <span class="ot">&lt;-</span> <span class="fu">factor</span> (dados<span class="sc">$</span>fumo, </span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>                      <span class="at">levels =</span> <span class="fu">c</span> (<span class="dv">1</span>,<span class="dv">2</span>), </span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>                      <span class="at">label =</span> <span class="fu">c</span> (<span class="st">"fumante"</span>, <span class="st">"não fumante"</span>))</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="cálculo-da-estimativa-pontual-da-proporção" class="level3" data-number="10.7.2">
<h3 data-number="10.7.2" class="anchored" data-anchor-id="cálculo-da-estimativa-pontual-da-proporção"><span class="header-section-number">10.7.2</span> Cálculo da estimativa pontual da proporção</h3>
<p>Nessa amostra, a proporção de fumantes é:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>tab <span class="ot">&lt;-</span> <span class="fu">table</span>(dados<span class="sc">$</span>fumo)</span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>tab</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    fumante não fumante 
         14          46 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>tabFumo <span class="ot">&lt;-</span> <span class="fu">round</span> (<span class="fu">prop.table</span> (tab), <span class="dv">3</span>)</span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>tabFumo</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    fumante não fumante 
      0.233       0.767 </code></pre>
</div>
</div>
</section>
<section id="sec-ICproporcao" class="level3" data-number="10.7.3">
<h3 data-number="10.7.3" class="anchored" data-anchor-id="sec-ICproporcao"><span class="header-section-number">10.7.3</span> Cálculo do intervalo de confiança para a proporção</h3>
<p><strong>Cálculo manual com aproximação normal</strong></p>
<p><em>1ª etapa</em>: verificar a premissa de que quando a proporção populacional é desconhecida a proporção pontual (<span class="math inline">\(\hat p\)</span>) e o seu complemento (<span class="math inline">\(\hat q = 1 - \hat p\)</span>) multiplicados, cada um, por <span class="math inline">\(n\)</span>, devem ser maior do que 5.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">length</span>(dados<span class="sc">$</span>fumo)</span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>(tabFumo) <span class="sc">*</span> n</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    fumante não fumante 
      13.98       46.02 </code></pre>
</div>
</div>
<p>Como se observa, ambos os valores são maiores do que 5.</p>
<p><em>2ª Etapa</em>: O intervalo pode ser estimado pela distribuição normal e é necessário calcular o <em>z_crítico</em>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> <span class="fl">0.05</span></span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span>  <span class="dv">1</span> <span class="sc">-</span> alpha<span class="sc">/</span><span class="dv">2</span></span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a>zc <span class="ot">&lt;-</span> <span class="fu">qnorm</span> (p, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">1</span>)</span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(zc, <span class="dv">2</span>)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1.96</code></pre>
</div>
</div>
<p><em>3ª Etapa</em>: Cálculo do erro padrão da proporção (<span class="math inline">\(\sqrt \frac {\hat p \times \hat q}{n}\)</span>) e da margem de erro (veja também a <a href="09-distAmostrais.html#sec-popamostra" class="quarto-xref"><span>Seção 9.6</span></a>):</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Extração da proporção amostral do tabFumo</span></span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>prop <span class="ot">&lt;-</span> tabFumo [<span class="dv">1</span>]</span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Cálculo do EP amostral</span></span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a>EP <span class="ot">&lt;-</span> <span class="fu">sqrt</span>((prop <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> prop))<span class="sc">/</span>n)</span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Cálculo da margem de erro(me)</span></span>
<span id="cb47-6"><a href="#cb47-6" aria-hidden="true" tabindex="-1"></a>me <span class="ot">&lt;-</span> zc <span class="sc">*</span> EP</span>
<span id="cb47-7"><a href="#cb47-7" aria-hidden="true" tabindex="-1"></a><span class="co"># dados necessários para o cálculo do IC95%</span></span>
<span id="cb47-8"><a href="#cb47-8" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">c</span>(prop, me), <span class="at">digits =</span> <span class="dv">3</span>)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>fumante fumante 
  0.233   0.107 </code></pre>
</div>
</div>
<p><em>4ª Etapa</em>: Intervalo de confiança</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a>ic_prop <span class="ot">&lt;-</span> <span class="fu">c</span>((prop <span class="sc">-</span> me), (prop <span class="sc">+</span> me))</span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(ic_prop, <span class="dv">3</span>)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>fumante fumante 
  0.126   0.340 </code></pre>
</div>
</div>
<p><strong>Cálculo usando uma função</strong></p>
<p>O chamado <em>Intervalo de Confiança Exato</em> corrigem as deficiências da aproximação normal. O R tem uma função para este cálculo: <code>BinomCI()</code> do pacote <code>DescTools</code><span class="citation" data-cites="signorell2022desctools">(<a href="references.html#ref-signorell2022desctools" role="doc-biblioref">2</a>)</span>. É preferível usar o método de Clopper e Pearson que fornece o IC exato.</p>
<p>Os argumentos da função <code>BinomCI()</code> são:</p>
<ul>
<li><strong>x</strong> <span class="math inline">\(\to\)</span> é o número de desfechos, sucessos;</li>
<li><strong>n</strong> <span class="math inline">\(\to\)</span> é o tamanho da amostra, número de ensaios;</li>
<li><strong>p</strong> <span class="math inline">\(\to\)</span> probabilidade, hipótese nula; se ignorada o padrão é 0,50;</li>
<li><strong>conf.level</strong> <span class="math inline">\(\to\)</span> nível de confiança, o padrão é 0.95;</li>
<li><strong>method</strong> <span class="math inline">\(\to\)</span> possui vários métodos para calcular intervalos de confiança para uma proporção binomial como: “clopper-pearson” (exact interval), “wilson”, “wald”, “agresti-coull”, “jeffreys”, “modified wilson”, “modified jeffreys”, “arcsine”, “logit”, “witting”, “pratt”. O método padrão é o de “wilson”. Qualquer outro método, há necessidade de solicitar;</li>
<li><strong>sides</strong> <span class="math inline">\(\to\)</span> hipótese alternativa padrão “two.sided” (bilateral), mas pode ser “right” ou “left” (unilateral a direita ou a esquerda, respectivamente).</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span>  tab[<span class="dv">1</span>]</span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>IC <span class="ot">&lt;-</span> <span class="fu">BinomCI</span> (x, </span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a>               n, </span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a>               <span class="at">conf.level =</span> <span class="fl">0.95</span>, </span>
<span id="cb51-5"><a href="#cb51-5" aria-hidden="true" tabindex="-1"></a>               <span class="at">method =</span> <span class="st">"clopper-pearson"</span>)</span>
<span id="cb51-6"><a href="#cb51-6" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(IC, <span class="dv">3</span>)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       est lwr.ci upr.ci
[1,] 0.233  0.134   0.36</code></pre>
</div>
</div>
<p>Observe que existe uma pequena diferença entre os valores da aproximação normal e o exato, com o método de “clopper-pearson”</p>


<div id="refs" class="references csl-bib-body" role="list" style="display: none">
<div id="ref-motulsky2010ci" class="csl-entry" role="listitem">
<div class="csl-left-margin">1. </div><div class="csl-right-inline">Motulsky H. The Theory of Confidence Intervals. Em: Intuitive Biostatistics: A Nonmathematical Guide to Statistical Thinking. Second Edition. New York, NY: Oxford University Press; 2010. p. 96–102. </div>
</div>
<div id="ref-signorell2022desctools" class="csl-entry" role="listitem">
<div class="csl-left-margin">2. </div><div class="csl-right-inline">Signorell A et al. DescTools: Tools for Descriptive Statistics [Internet]. 2022. Disponível em: <a href="https://cran.r-project.org/package=DescTools">https://cran.r-project.org/package=DescTools</a></div>
</div>
</div>
</section>
</section>
<section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes">
<hr>
<ol>
<li id="fn1"><p>Repetindo, é importante lembrar que toda vez que for extraída uma nova amostra, o resultado será um conjunto de números diferentes e, em consequência, a média será diferente. Por isso, se for importante repetir o mesmo resultado, deve-se usar a função <code>set.seed()</code>. Consulte a <a href="07-probabilidades.html#sec-rnorm" class="quarto-xref"><span>Seção 7.7.2.4</span></a>.<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn2"><p>Anteriormente, mostrou-se a media populacional por uma questão didática. A regra é não se conhecer a média populacional, razão da importância do intervalo de confiança<a href="#fnref2" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copiada");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copiada");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./09-distAmostrais.html" class="pagination-link" aria-label="Distribuições Amostrais">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Distribuições Amostrais</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./11-testeHipoteses.html" class="pagination-link" aria-label="Teste de Hipóteses">
        <span class="nav-page-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Teste de Hipóteses</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




</body></html>